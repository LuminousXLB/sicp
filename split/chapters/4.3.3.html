<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <!-- Global site tag (gtag.js) - Google Analytics - START -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-156801664-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-156801664-1');
    </script>
    <!-- Global site tag (gtag.js) - Google Analytics - END -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="description" content="4.3.3&nbsp;&nbsp;
    Implementing the
    
      <span style="color:green">Amb</span>
      <span style="color:blue">amb</span>
    
    Evaluator
  " />
    <title>
      4.3.3&nbsp;&nbsp;
    Implementing the
    
      <span style="color:green">Amb</span>
      <span style="color:blue">amb</span>
    
    Evaluator
  
    </title>
    
  <meta name="csrf-param" content="authenticity_token" />
  <meta name="csrf-token" content="EMTEijVc2kiiKUH4nYH0lQG3pLPfMowQ/Stg//t6DCo0e5pWMQwamnTvIdmVZqY/MqSx2IYYE+2bpNV6UNSMwQ==" />

    <!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
    -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata&display?swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Droid+Sans|Droid+Serif" rel="stylesheet">
    <link rel="stylesheet" media="all" href="../assets/stylesheet.css" />

   <link rel="shortcut icon" type="image/x-icon" href="../assets/favicon.ico" />

<!--    <link rel="shortcut icon" type="image/png" href="../images/lambda.png" /> -->

    <!-- for support of progressive web app, see github README, DISABLED!
    <link rel="manifest" href="../static/manifest.json">
    -->

    <script src="https://code.jquery.com/jquery-3.2.1.min.js" 
		     	  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
	          crossorigin="anonymous">
    </script> 

    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>

    <!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script> -->
    <script type="text/javascript" 
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-AMS-MML_HTMLorMML-full">
    </script>
   <!--  <script type="text/javascript" 
      src="../MathJax/MathJax.js?config=TeX-AMS-MML_HTMLorMML-full">
    </script> -->
  
    <script src="../assets/application.js"></script>
  
    <!-- Rendering inline LaTeX -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          processEscapes: true,
          jax: ["input/TeX","output/HTML-CSS"]
        }
      });
    </script>
    <!--<script src="/mathjax/MathJax.js?config=TeX-AMS_HTML-full.js" type="text/javascript"></script>-->
    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js" type="text/javascript"></script>
    <![endif]-->
  </head>
  <body>

    
    <!-- support for progressive web app, see README, DISABLED
    <script>
      if ('serviceWorker' in navigator && !navigator.serviceWorker.controller) {
          navigator.serviceWorker.register("../sw.js").then(function(reg) {
              console.log("Service worker has been registered for scope: " + reg.scope);
          });
      }
    </script>
    -->

     <nav class="navbar navbar-expand-sm navbar-dark bg-dark fixed-top justify-content-between">
       <button id="btn" class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#nav-sidebar" aria-controls="nav-sidebar" aria-expanded="false" aria-label="Toggle navigation" title="navigation">
         <span class="navbar-toggler-icon"></span>
       </button>
       <span class="navbar-brand-short"><a title="Go back to front page" href="../index.html" class="gray">SICP &mdash; Scheme/JS</a></span>
       <span class="navbar-brand-long" ><a title="Go back to front page" href="../index.html" class="gray">Structure and Interpretation of Computer Programs &mdash; Comparison Edition</a></span>

       <!-- edit the search engine by visiting: 
	    https://cse.google.com/cse/setup/basic?cx=015760785273492757659:nc_tznrzlsg 
	       -->
       <form class="form-inline ml-auto" id="xxx">
         <div id="search-box">
	         <script>
	           (function() {
	               var cx = "015760785273492757659:nc_tznrzlsg";
	               var gcse = document.createElement("script");
	               gcse.type = "text/javascript";
	               gcse.async = true;
	               gcse.src = "https://cse.google.com/cse.js?cx=" + cx;
	               var s = document.getElementsByTagName("script")[0];
	               s.parentNode.insertBefore(gcse, s);
	           })();
	           window.onload = function()
	           { 
	               var searchBox =  document.getElementById("gsc-i-id1");
	               searchBox.placeholder= "search web edition";
	               searchBox.title= "search web edition";
	           }
	         </script>
	         <gcse:search></gcse:search>
         </div>
       </form>
       <span class="navbar-brand-short">
         &nbsp;
         &nbsp;
         <a href="https://source-academy.github.io/source/" title="Go to the Source language(s) definition(s)" class="gray">S</a>
       </span>
       <span class="navbar-brand-long">
         &nbsp;
         &nbsp;
         <a href="https://source-academy.github.io/source/" title="Go to the Source language(s) definition(s)" class="gray">Source</a>
       </span>
     </nav>
     
     <div class="container scroll">

            
        <div class="collapse" id="nav-sidebar" role="tablist" aria-multiselectable="true">
        <!-- insert a dummy entry, to give one extra line of space -->
        <a class="navbar-brand" href="index.html">&nbsp;</a>
    
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-1">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-1" aria-expanded="false" aria-controls="sidebar-collapse-1">
                <a href="./foreword.html"> 
        Foreword
    </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-2">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-2" aria-expanded="false" aria-controls="sidebar-collapse-2">
                <a href="./prefaces.html"> 
        Prefaces
    </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-3">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-3" aria-expanded="false" aria-controls="sidebar-collapse-3">
                <a href="./acknowledgements.html"> 
Acknowledgments
    </a>
              </span>
            </h5>
          </div>
        </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-4">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-4" aria-expanded="true" aria-controls="sidebar-collapse-4">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-4" aria-expanded="true" aria-controls="sidebar-collapse-4">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./1.html">1 
    Building Abstractions with 
    
      <span style="color:green">Procedures</span>
      <span style="color:blue">Functions</span>
    
  </a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-4" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-5">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-5" aria-expanded="true" aria-controls="sidebar-collapse-5">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-5" aria-expanded="true" aria-controls="sidebar-collapse-5">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./1.1.html">1.1 The Elements of Programming</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-5" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-6">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-6" aria-expanded="false" aria-controls="sidebar-collapse-6">
                <a href="./1.1.1.html"> 1.1.1 Expressions</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-7">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-7" aria-expanded="false" aria-controls="sidebar-collapse-7">
                <a href="./1.1.2.html"> 1.1.2 Naming and the Environment</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-8">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-8" aria-expanded="false" aria-controls="sidebar-collapse-8">
                <a href="./1.1.3.html"> 1.1.3 
    Evaluating
    
      <span style="color:green">Combinations</span>
      <span style="color:blue">Operator Combinations</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-9">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-9" aria-expanded="false" aria-controls="sidebar-collapse-9">
                <a href="./1.1.4.html"> 1.1.4 
    Compound <span style="color:green">Procedures</span>
    <span style="color:blue">Functions</span>
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-10">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-10" aria-expanded="false" aria-controls="sidebar-collapse-10">
                <a href="./1.1.5.html"> 1.1.5 
    The Substitution Model for 
    
      <span style="color:green">
        Procedure
      </span>
      <span style="color:blue">
        Function
      </span>
    
    Application
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-11">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-11" aria-expanded="false" aria-controls="sidebar-collapse-11">
                <a href="./1.1.6.html"> 1.1.6 
    Conditional Expressions and Predicates
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-12">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-12" aria-expanded="false" aria-controls="sidebar-collapse-12">
                <a href="./1.1.7.html"> 1.1.7 Example: Square Roots by Newton's Method</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-13">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-13" aria-expanded="false" aria-controls="sidebar-collapse-13">
                <a href="./1.1.8.html"> 1.1.8 
    
      <span style="color:green">
        Procedures
      </span>
      <span style="color:blue">
        Functions
      </span>
    
    as Black-Box Abstractions
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-14">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-14" aria-expanded="true" aria-controls="sidebar-collapse-14">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-14" aria-expanded="true" aria-controls="sidebar-collapse-14">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./1.2.html">1.2 
    
      <span style="color:green">Procedures</span>
      <span style="color:blue">Functions</span>
    
    and the Processes They Generate
  </a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-14" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-15">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-15" aria-expanded="false" aria-controls="sidebar-collapse-15">
                <a href="./1.2.1.html"> 1.2.1 Linear Recursion and Iteration</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-16">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-16" aria-expanded="false" aria-controls="sidebar-collapse-16">
                <a href="./1.2.2.html"> 1.2.2 Tree Recursion</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-17">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-17" aria-expanded="false" aria-controls="sidebar-collapse-17">
                <a href="./1.2.3.html"> 1.2.3 Orders of Growth</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-18">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-18" aria-expanded="false" aria-controls="sidebar-collapse-18">
                <a href="./1.2.4.html"> 1.2.4 Exponentiation</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-19">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-19" aria-expanded="false" aria-controls="sidebar-collapse-19">
                <a href="./1.2.5.html"> 1.2.5 Greatest Common Divisors</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-20">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-20" aria-expanded="false" aria-controls="sidebar-collapse-20">
                <a href="./1.2.6.html"> 1.2.6 Example: Testing for Primality</a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-21">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-21" aria-expanded="true" aria-controls="sidebar-collapse-21">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-21" aria-expanded="true" aria-controls="sidebar-collapse-21">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./1.3.html">1.3 
        Formulating Abstractions with Higher-Order 
        
	  <span style="color:green">Procedures</span>
	  <span style="color:blue">Functions</span>
	
      </a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-21" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-22">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-22" aria-expanded="false" aria-controls="sidebar-collapse-22">
                <a href="./1.3.1.html"> 1.3.1 
    
      <span style="color:green">Procedures</span>
      <span style="color:blue">Functions</span>
    
    as Arguments
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-23">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-23" aria-expanded="false" aria-controls="sidebar-collapse-23">
                <a href="./1.3.2.html"> 1.3.2 
    
      <span style="color:green">Constructing Procedures using Lambda</span>
      <span style="color:blue">Constructing Functions using Lambda Expressions
      </span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-24">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-24" aria-expanded="false" aria-controls="sidebar-collapse-24">
                <a href="./1.3.3.html"> 1.3.3 
    
      <span style="color:green">Procedures</span>
    <span style="color:blue">Functions</span>
    as General Methods
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-25">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-25" aria-expanded="false" aria-controls="sidebar-collapse-25">
                <a href="./1.3.4.html"> 1.3.4 
    
      <span style="color:green">Procedures</span>
      <span style="color:blue">Functions</span>
    
    as Returned Values
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-26">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-26" aria-expanded="true" aria-controls="sidebar-collapse-26">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-26" aria-expanded="true" aria-controls="sidebar-collapse-26">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./2.html">2 Building Abstractions with Data</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-26" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-27">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-27" aria-expanded="true" aria-controls="sidebar-collapse-27">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-27" aria-expanded="true" aria-controls="sidebar-collapse-27">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./2.1.html">2.1 Introduction to Data Abstraction</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-27" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-28">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-28" aria-expanded="false" aria-controls="sidebar-collapse-28">
                <a href="./2.1.1.html"> 2.1.1 
    Example: Arithmetic Operations for Rational Numbers
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-29">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-29" aria-expanded="false" aria-controls="sidebar-collapse-29">
                <a href="./2.1.2.html"> 2.1.2 
    Abstraction Barriers
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-30">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-30" aria-expanded="false" aria-controls="sidebar-collapse-30">
                <a href="./2.1.3.html"> 2.1.3 
    What Is Meant by Data?
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-31">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-31" aria-expanded="false" aria-controls="sidebar-collapse-31">
                <a href="./2.1.4.html"> 2.1.4 
    Extended Exercise: Interval Arithmetic
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-32">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-32" aria-expanded="true" aria-controls="sidebar-collapse-32">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-32" aria-expanded="true" aria-controls="sidebar-collapse-32">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./2.2.html">2.2 Hierarchical Data and the Closure Property</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-32" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-33">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-33" aria-expanded="false" aria-controls="sidebar-collapse-33">
                <a href="./2.2.1.html"> 2.2.1 
    Representing Sequences
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-34">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-34" aria-expanded="false" aria-controls="sidebar-collapse-34">
                <a href="./2.2.2.html"> 2.2.2 
    Hierarchical Structures
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-35">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-35" aria-expanded="false" aria-controls="sidebar-collapse-35">
                <a href="./2.2.3.html"> 2.2.3 
    Sequences as Conventional Interfaces
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-36">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-36" aria-expanded="false" aria-controls="sidebar-collapse-36">
                <a href="./2.2.4.html"> 2.2.4 
    Example: A Picture Language
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-37">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-37" aria-expanded="true" aria-controls="sidebar-collapse-37">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-37" aria-expanded="true" aria-controls="sidebar-collapse-37">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./2.3.html">2.3 Symbolic Data</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-37" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-38">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-38" aria-expanded="false" aria-controls="sidebar-collapse-38">
                <a href="./2.3.1.html"> 2.3.1 
    
      <span style="color:green">Quotation</span>
      <span style="color:blue">Strings</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-39">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-39" aria-expanded="false" aria-controls="sidebar-collapse-39">
                <a href="./2.3.2.html"> 2.3.2 
    Example: Symbolic Differentiation
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-40">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-40" aria-expanded="false" aria-controls="sidebar-collapse-40">
                <a href="./2.3.3.html"> 2.3.3 
    Example: Representing Sets
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-41">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-41" aria-expanded="false" aria-controls="sidebar-collapse-41">
                <a href="./2.3.4.html"> 2.3.4 
    Example: Huffman Encoding Trees
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-42">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-42" aria-expanded="true" aria-controls="sidebar-collapse-42">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-42" aria-expanded="true" aria-controls="sidebar-collapse-42">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./2.4.html">2.4 Multiple Representations for Abstract Data</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-42" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-43">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-43" aria-expanded="false" aria-controls="sidebar-collapse-43">
                <a href="./2.4.1.html"> 2.4.1 
    Representations for Complex Numbers
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-44">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-44" aria-expanded="false" aria-controls="sidebar-collapse-44">
                <a href="./2.4.2.html"> 2.4.2 
    Tagged data
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-45">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-45" aria-expanded="false" aria-controls="sidebar-collapse-45">
                <a href="./2.4.3.html"> 2.4.3 
    Data-Directed Programming and Additivity
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-46">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-46" aria-expanded="true" aria-controls="sidebar-collapse-46">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-46" aria-expanded="true" aria-controls="sidebar-collapse-46">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./2.5.html">2.5 Systems with Generic Operations</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-46" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-47">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-47" aria-expanded="false" aria-controls="sidebar-collapse-47">
                <a href="./2.5.1.html"> 2.5.1 
    Generic Arithmetic Operations
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-48">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-48" aria-expanded="false" aria-controls="sidebar-collapse-48">
                <a href="./2.5.2.html"> 2.5.2 
    Combining Data of Different Types
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-49">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-49" aria-expanded="false" aria-controls="sidebar-collapse-49">
                <a href="./2.5.3.html"> 2.5.3 
    Example: Symbolic Algebra
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-50">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-50" aria-expanded="true" aria-controls="sidebar-collapse-50">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-50" aria-expanded="true" aria-controls="sidebar-collapse-50">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./3.html">3 Modularity, Objects, and State</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-50" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-51">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-51" aria-expanded="true" aria-controls="sidebar-collapse-51">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-51" aria-expanded="true" aria-controls="sidebar-collapse-51">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./3.1.html">3.1 Assignment and Local State</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-51" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-52">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-52" aria-expanded="false" aria-controls="sidebar-collapse-52">
                <a href="./3.1.1.html"> 3.1.1 
    Local State Variables
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-53">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-53" aria-expanded="false" aria-controls="sidebar-collapse-53">
                <a href="./3.1.2.html"> 3.1.2 
    The Benefits of Introducing Assignment
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-54">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-54" aria-expanded="false" aria-controls="sidebar-collapse-54">
                <a href="./3.1.3.html"> 3.1.3 
    The Costs of Introducing Assignment
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-55">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-55" aria-expanded="true" aria-controls="sidebar-collapse-55">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-55" aria-expanded="true" aria-controls="sidebar-collapse-55">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./3.2.html">3.2 The Environment Model of Evaluation</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-55" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-56">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-56" aria-expanded="false" aria-controls="sidebar-collapse-56">
                <a href="./3.2.1.html"> 3.2.1 
    The Rules for Evaluation
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-57">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-57" aria-expanded="false" aria-controls="sidebar-collapse-57">
                <a href="./3.2.2.html"> 3.2.2 
    Applying Simple
    
      <span style="color:green">Procedures</span>
      <span style="color:blue">Functions</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-58">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-58" aria-expanded="false" aria-controls="sidebar-collapse-58">
                <a href="./3.2.3.html"> 3.2.3 
    Frames as the Repository of Local State
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-59">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-59" aria-expanded="false" aria-controls="sidebar-collapse-59">
                <a href="./3.2.4.html"> 3.2.4 
    Internal
    
      <span style="color:green">Definitions</span>
      <span style="color:blue">Declarations</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-60">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-60" aria-expanded="true" aria-controls="sidebar-collapse-60">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-60" aria-expanded="true" aria-controls="sidebar-collapse-60">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./3.3.html">3.3 Modeling with Mutable Data</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-60" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-61">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-61" aria-expanded="false" aria-controls="sidebar-collapse-61">
                <a href="./3.3.1.html"> 3.3.1 
    Mutable List Structure
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-62">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-62" aria-expanded="false" aria-controls="sidebar-collapse-62">
                <a href="./3.3.2.html"> 3.3.2 
    Representing Queues
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-63">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-63" aria-expanded="false" aria-controls="sidebar-collapse-63">
                <a href="./3.3.3.html"> 3.3.3 
    Representing Tables
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-64">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-64" aria-expanded="false" aria-controls="sidebar-collapse-64">
                <a href="./3.3.4.html"> 3.3.4 
    A Simulator for Digital Circuits
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-65">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-65" aria-expanded="false" aria-controls="sidebar-collapse-65">
                <a href="./3.3.5.html"> 3.3.5 
    Propagation of Constraints
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-66">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-66" aria-expanded="true" aria-controls="sidebar-collapse-66">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-66" aria-expanded="true" aria-controls="sidebar-collapse-66">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./3.4.html">3.4 Concurrency: Time Is of the Essence</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-66" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-67">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-67" aria-expanded="false" aria-controls="sidebar-collapse-67">
                <a href="./3.4.1.html"> 3.4.1 
    The Nature of Time in Concurrent Systems
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-68">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-68" aria-expanded="false" aria-controls="sidebar-collapse-68">
                <a href="./3.4.2.html"> 3.4.2 
    Mechanisms for Controlling Concurrency
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-69">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-69" aria-expanded="true" aria-controls="sidebar-collapse-69">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-69" aria-expanded="true" aria-controls="sidebar-collapse-69">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./3.5.html">3.5 Streams</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-69" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-70">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-70" aria-expanded="false" aria-controls="sidebar-collapse-70">
                <a href="./3.5.1.html"> 3.5.1 
    Streams Are Delayed Lists
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-71">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-71" aria-expanded="false" aria-controls="sidebar-collapse-71">
                <a href="./3.5.2.html"> 3.5.2 
    Infinite Streams
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-72">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-72" aria-expanded="false" aria-controls="sidebar-collapse-72">
                <a href="./3.5.3.html"> 3.5.3 
    Exploiting the Stream Paradigm
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-73">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-73" aria-expanded="false" aria-controls="sidebar-collapse-73">
                <a href="./3.5.4.html"> 3.5.4 
    Streams and Delayed Evaluation
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-74">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-74" aria-expanded="false" aria-controls="sidebar-collapse-74">
                <a href="./3.5.5.html"> 3.5.5 
    Modularity of Functional Programs and Modularity of Objects
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-75">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-75" aria-expanded="true" aria-controls="sidebar-collapse-75">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-75" aria-expanded="true" aria-controls="sidebar-collapse-75">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./4.html">4 Metalinguistic Abstraction</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-75" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-76">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-76" aria-expanded="true" aria-controls="sidebar-collapse-76">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-76" aria-expanded="true" aria-controls="sidebar-collapse-76">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./4.1.html">4.1 The Metacircular Evaluator</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-76" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-77">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-77" aria-expanded="false" aria-controls="sidebar-collapse-77">
                <a href="./4.1.1.html"> 4.1.1 
    The Core of the Evaluator
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-78">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-78" aria-expanded="false" aria-controls="sidebar-collapse-78">
                <a href="./4.1.2.html"> 4.1.2 
    Representing
    
      <span style="color:green">Expressions</span>
      <span style="color:blue">Components</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-79">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-79" aria-expanded="false" aria-controls="sidebar-collapse-79">
                <a href="./4.1.3.html"> 4.1.3 
    Evaluator Data Structures
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-80">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-80" aria-expanded="false" aria-controls="sidebar-collapse-80">
                <a href="./4.1.4.html"> 4.1.4 
    Running the Evaluator as a Program
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-81">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-81" aria-expanded="false" aria-controls="sidebar-collapse-81">
                <a href="./4.1.5.html"> 4.1.5 
    Data as Programs
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-82">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-82" aria-expanded="false" aria-controls="sidebar-collapse-82">
                <a href="./4.1.6.html"> 4.1.6 
    Internal
    
      <span style="color:green">Definitions</span>
      <span style="color:blue">Declarations</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-83">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-83" aria-expanded="false" aria-controls="sidebar-collapse-83">
                <a href="./4.1.7.html"> 4.1.7 
    Separating Syntactic Analysis from Execution
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-84">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-84" aria-expanded="true" aria-controls="sidebar-collapse-84">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-84" aria-expanded="true" aria-controls="sidebar-collapse-84">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./4.2.html">4.2 
    
      <span style="color:green">Variations on a Scheme:</span>
    
    Lazy Evaluation
</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-84" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-85">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-85" aria-expanded="false" aria-controls="sidebar-collapse-85">
                <a href="./4.2.1.html"> 4.2.1 
    Normal Order and Applicative Order
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-86">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-86" aria-expanded="false" aria-controls="sidebar-collapse-86">
                <a href="./4.2.2.html"> 4.2.2 
    An Interpreter with Lazy Evaluation
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-87">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-87" aria-expanded="false" aria-controls="sidebar-collapse-87">
                <a href="./4.2.3.html"> 4.2.3 
    Streams as Lazy Lists
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-88">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-88" aria-expanded="true" aria-controls="sidebar-collapse-88">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-88" aria-expanded="true" aria-controls="sidebar-collapse-88">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./4.3.html">4.3 
    
      <span style="color:green">Variations on a Scheme:</span>
    
    Nondeterministic Computing
  </a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-88" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-89">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-89" aria-expanded="false" aria-controls="sidebar-collapse-89">
                <a href="./4.3.1.html"> 4.3.1 
    
      <span style="color:green">Amb and Search</span>
      <span style="color:blue">Search and amb</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-90">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-90" aria-expanded="false" aria-controls="sidebar-collapse-90">
                <a href="./4.3.2.html"> 4.3.2 
    Examples of Nondeterministic Programs
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-91">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-91" aria-expanded="false" aria-controls="sidebar-collapse-91">
                <a href="./4.3.3.html"> 4.3.3 
    Implementing the
    
      <span style="color:green">Amb</span>
      <span style="color:blue">amb</span>
    
    Evaluator
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-92">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-92" aria-expanded="true" aria-controls="sidebar-collapse-92">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-92" aria-expanded="true" aria-controls="sidebar-collapse-92">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./4.4.html">4.4 Logic Programming</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-92" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-93">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-93" aria-expanded="false" aria-controls="sidebar-collapse-93">
                <a href="./4.4.1.html"> 4.4.1 
    Deductive Information Retrieval
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-94">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-94" aria-expanded="false" aria-controls="sidebar-collapse-94">
                <a href="./4.4.2.html"> 4.4.2 
    How the Query System Works
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-95">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-95" aria-expanded="false" aria-controls="sidebar-collapse-95">
                <a href="./4.4.3.html"> 4.4.3 
    Is Logic Programming Mathematical Logic?
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-96">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-96" aria-expanded="false" aria-controls="sidebar-collapse-96">
                <a href="./4.4.4.html"> 4.4.4 
    Implementing the Query System
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-97">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-97" aria-expanded="true" aria-controls="sidebar-collapse-97">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-97" aria-expanded="true" aria-controls="sidebar-collapse-97">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./5.html">5 Computing with Register Machines</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-97" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-98">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-98" aria-expanded="true" aria-controls="sidebar-collapse-98">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-98" aria-expanded="true" aria-controls="sidebar-collapse-98">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./5.1.html">5.1 Designing Register Machines</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-98" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-99">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-99" aria-expanded="false" aria-controls="sidebar-collapse-99">
                <a href="./5.1.1.html"> 5.1.1 
    A Language for Describing Register Machines
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-100">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-100" aria-expanded="false" aria-controls="sidebar-collapse-100">
                <a href="./5.1.2.html"> 5.1.2 
    Abstraction in Machine Design
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-101">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-101" aria-expanded="false" aria-controls="sidebar-collapse-101">
                <a href="./5.1.3.html"> 5.1.3 
    Subroutines
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-102">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-102" aria-expanded="false" aria-controls="sidebar-collapse-102">
                <a href="./5.1.4.html"> 5.1.4 
    Using a Stack to Implement Recursion
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-103">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-103" aria-expanded="false" aria-controls="sidebar-collapse-103">
                <a href="./5.1.5.html"> 5.1.5 
    Instruction Summary
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-104">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-104" aria-expanded="true" aria-controls="sidebar-collapse-104">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-104" aria-expanded="true" aria-controls="sidebar-collapse-104">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./5.2.html">5.2 A Register-Machine Simulator</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-104" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-105">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-105" aria-expanded="false" aria-controls="sidebar-collapse-105">
                <a href="./5.2.1.html"> 5.2.1 
    The Machine Model
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-106">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-106" aria-expanded="false" aria-controls="sidebar-collapse-106">
                <a href="./5.2.2.html"> 5.2.2 
    The Assembler
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-107">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-107" aria-expanded="false" aria-controls="sidebar-collapse-107">
                <a href="./5.2.3.html"> 5.2.3 
    Generating Execution
    
      <span style="color:green">Procedures</span>
      <span style="color:blue">Functions</span>
    
    for Instructions
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-108">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-108" aria-expanded="false" aria-controls="sidebar-collapse-108">
                <a href="./5.2.4.html"> 5.2.4 
    Monitoring Machine Performance
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-109">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-109" aria-expanded="true" aria-controls="sidebar-collapse-109">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-109" aria-expanded="true" aria-controls="sidebar-collapse-109">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./5.3.html">5.3 Storage Allocation and Garbage Collection</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-109" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-110">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-110" aria-expanded="false" aria-controls="sidebar-collapse-110">
                <a href="./5.3.1.html"> 5.3.1 
    Memory as Vectors
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-111">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-111" aria-expanded="false" aria-controls="sidebar-collapse-111">
                <a href="./5.3.2.html"> 5.3.2 
    Maintaining the Illusion of Infinite Memory
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-112">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-112" aria-expanded="true" aria-controls="sidebar-collapse-112">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-112" aria-expanded="true" aria-controls="sidebar-collapse-112">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./5.4.html">5.4 The Explicit-Control Evaluator</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-112" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-113">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-113" aria-expanded="false" aria-controls="sidebar-collapse-113">
                <a href="./5.4.1.html"> 5.4.1 
    The Core of the Explicit-Control Evaluator
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-114">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-114" aria-expanded="false" aria-controls="sidebar-collapse-114">
                <a href="./5.4.2.html"> 5.4.2 
    Sequence Evaluation and Tail Recursion
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-115">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-115" aria-expanded="false" aria-controls="sidebar-collapse-115">
                <a href="./5.4.3.html"> 5.4.3 
    Conditionals, Assignments, and <span style="color:green">Definitions</span><span style="color:blue">Declarations and Blocks</span>
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-116">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-116" aria-expanded="false" aria-controls="sidebar-collapse-116">
                <a href="./5.4.4.html"> 5.4.4 
    Running the Evaluator
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-117">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-117" aria-expanded="true" aria-controls="sidebar-collapse-117">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-117" aria-expanded="true" aria-controls="sidebar-collapse-117">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./5.5.html">5.5 Compilation</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-117" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-118">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-118" aria-expanded="false" aria-controls="sidebar-collapse-118">
                <a href="./5.5.1.html"> 5.5.1 
    Structure of the Compiler
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-119">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-119" aria-expanded="false" aria-controls="sidebar-collapse-119">
                <a href="./5.5.2.html"> 5.5.2 
    Compiling
    
      <span style="color:blue">Statements and</span>
    
    Expressions
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-120">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-120" aria-expanded="false" aria-controls="sidebar-collapse-120">
                <a href="./5.5.3.html"> 5.5.3 
    Compiling
    
      <span style="color:green">
	Combinations
      </span>
      <span style="color:blue">
	Applications
      </span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-121">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-121" aria-expanded="false" aria-controls="sidebar-collapse-121">
                <a href="./5.5.4.html"> 5.5.4 
    Combining Instruction Sequences
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-122">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-122" aria-expanded="false" aria-controls="sidebar-collapse-122">
                <a href="./5.5.5.html"> 5.5.5 
    An Example of Compiled Code
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-123">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-123" aria-expanded="false" aria-controls="sidebar-collapse-123">
                <a href="./5.5.6.html"> 5.5.6 
    Lexical Addressing
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-124">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-124" aria-expanded="false" aria-controls="sidebar-collapse-124">
                <a href="./5.5.7.html"> 5.5.7 
    Interfacing Compiled Code to the Evaluator
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
                </div>
              </div>
            </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-125">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-125" aria-expanded="false" aria-controls="sidebar-collapse-125">
                <a href="./references.html"> References</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-126">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-126" aria-expanded="false" aria-controls="sidebar-collapse-126">
                <a href="./making-of.html"> About the SICP JS Project</a>
              </span>
            </h5>
          </div>
        </div>
        </div>
<div id='permalink-msg'>
<div class='screen'>
  <div class='alert alert-success'>
    <strong>Permalink copied!</strong>
  </div>
</div>
</div>
<div class='chapter-content'>

      <div class='chapter-title'>
        <div class='permalink'>
        <a name='top' class='permalink'> 
    4.3.3&nbsp;&nbsp;
    Implementing the
    
      <span style="color:green">Amb</span>
      <span style="color:blue">amb</span>
    
    Evaluator
  
        </a>
        </div>
      </div>
      <div class='chapter-text'>
        <div class='SECTION'>
    

  
  

  <div class='permalink'>
<a name='p1' class='permalink'></a><p>
    The evaluation of an ordinary
    
      <span style="color:green">Scheme</span>
      <span style="color:blue">JavaScript</span>
    
    expression may return a value, may never terminate, or may signal an error.
    In nondeterministic
    
      <span style="color:green">Scheme</span>
      <span style="color:blue">JavaScript</span>
    
    the evaluation of an expression may in addition result in the discovery of
    a dead end, in which case evaluation must backtrack to a previous choice
    point.  The interpretation of nondeterministic
    
      <span style="color:green">Scheme</span>
      <span style="color:blue">JavaScript</span>
    
    is complicated by this extra case.
  </p></div>

  <div class='permalink'>
<a name='p2' class='permalink'></a><p>
    
    We will construct the <kbd>amb</kbd> evaluator for
    nondeterministic
    
      <span style="color:green">Scheme</span>
      <span style="color:blue">JavaScript</span>
    
    by modifying the analyzing evaluator of
    section&nbsp;<REF NAME="sec:separating-analysis"><a class="superscript" id="4.3.3-sec-link-4.1.7" href="./4.1.7.html">4.1.7</a></REF>.<a class='superscript' id='footnote-link-1' href='#footnote-1'>[1]</a> As in the analyzing evaluator, evaluation of an
    expression is accomplished by calling an 
    
    execution
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    produced by analysis of
    that expression.  The difference between the interpretation of ordinary
    
      <span style="color:green">Scheme</span>
      <span style="color:blue">JavaScript</span>
    
    and the interpretation of nondeterministic
    
      <span style="color:green">Scheme</span>
      <span style="color:blue">JavaScript</span>
    
    will be entirely
    in the execution
    
      <span style="color:green">procedures.</span>
      <span style="color:blue">functions.</span>
    
  </p></div>

  
      <div class='permalink'>
        <a name='h1' class='permalink'></a><h2>
    
    
      Execution
      
	<span style="color:green">procedures</span>
	<span style="color:blue">functions</span>
      
      and continuations
    
  </h2></div>

  
  <div class='permalink'>
<a name='p3' class='permalink'></a><p>
    
    Recall that the execution
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    for the ordinary evaluator take one argument: the environment of execution.
    In contrast, the execution
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    in the <kbd>amb</kbd> evaluator take three arguments:
    the environment, and two
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    called
    
      <span style="color:green"><EM>continuation procedures</EM>.</span>
      <span style="color:blue"><EM>continuation functions</EM>.</span>
    
    The evaluation of an expression will finish by calling one of these two
    continuations: If the evaluation results in a value, the 
    
    <EM>success continuation</EM> is called with that value; if the evaluation
    results in the discovery of a dead end, the 
    
    <EM>failure continuation</EM> is called.  Constructing and calling
    appropriate continuations is the mechanism by which the nondeterministic
    evaluator implements backtracking.
  </p></div>

  <div class='permalink'>
<a name='p4' class='permalink'></a><p>
    It is the job of the success continuation to receive a value and proceed
    with the computation.  Along with that value, the success continuation is
    passed another failure continuation, which is to be called subsequently if
    the use of that value leads to a dead end.
  </p></div>

  <div class='permalink'>
<a name='p5' class='permalink'></a><p>
    It is the job of the failure continuation to try another branch of the
    nondeterministic process.  The essence of the nondeterministic
    language is in the fact that expressions may represent choices among
    alternatives.  The evaluation of such an expression must proceed with
    one of the indicated alternative choices, even though it is not known
    in advance which choices will lead to acceptable results.  To deal
    with this, the evaluator picks one of the alternatives and passes this
    value to the success continuation.  Together with this value, the
    evaluator constructs and passes along a failure continuation that can
    be called later to choose a different alternative.
  </p></div>

  <div class='permalink'>
<a name='p6' class='permalink'></a><p>
    A failure is triggered during evaluation (that is, a failure
    continuation is called) when a user program explicitly rejects the
    current line of attack (for example, a call to
    <kbd>require</kbd> may result in execution of
    
      <span style="color:green"><kbd>(amb)</kbd>,</span>
      <span style="color:blue"><kbd>amb()</kbd>,</span>
    
    an expression that always
    fails—see section&nbsp;<REF NAME="sec:amb"><a class="superscript" id="4.3.3-sec-link-4.3.1" href="./4.3.1.html">4.3.1</a></REF>).  The failure
    continuation in hand at that point will cause the most recent choice point
    to choose another alternative.  If there are no more alternatives to be
    considered at that choice point, a failure at an earlier choice point
    is triggered, and so on.  Failure continuations are also invoked by
    the driver loop in response to a
    
      <span style="color:green"><kbd>try-again</kbd></span>
      <span style="color:blue">
	<kbd>try_again</kbd>
      </span>
    
    request, to find another value of the expression.
  </p></div>

  <div class='permalink'>
<a name='p7' class='permalink'></a><p>
    In addition, if a side-effect operation (such as assignment to a
    variable) occurs on a branch of the process resulting from a choice,
    it may be necessary, when the process finds a dead end, to undo the
    side effect before making a new choice.  This is accomplished by
    having the side-effect operation produce a failure continuation that
    undoes the side effect and propagates the failure.
  </p></div>

  <div class='permalink'>
<a name='p8' class='permalink'></a><p>
    In summary, failure continuations are constructed by
    <UL>
      <LI>
	<kbd>amb</kbd> expressions—to provide a
	mechanism to make alternative choices if the current choice made by the
	<kbd>amb</kbd> expression leads to a dead end;
      </LI>
      <LI>
	the top-level driver—to provide a mechanism to report failure
	when the choices are exhausted;
      </LI>
      <LI>
	assignments—to intercept failures and undo assignments
	during backtracking.
      </LI>
    </UL>
  </p></div>

  <div class='permalink'>
<a name='p9' class='permalink'></a><p>
    Failures are initiated only when a dead end is encountered. This occurs
    <UL>
      <LI>
	if the user program executes
	
	  <span style="color:green"><kbd>(amb)</kbd>;</span>
	  <span style="color:blue"><kbd>amb()</kbd>;</span>
	  
      </LI>
      <LI>
	if the user types
	
	  <span style="color:green">
	    <kbd>try-again</kbd>
	  </span>
	  <span style="color:blue">
	    <kbd>try_again</kbd>
	  </span>
	
	at the top-level driver.
      </LI>

    </UL>
  </p></div>

  <div class='permalink'>
<a name='p10' class='permalink'></a><p>
    Failure continuations are also called during processing of a failure:
    <UL>
      <LI>When the failure continuation created by an assignment finishes
      undoing a side effect, it calls the failure continuation it intercepted,
      in order to propagate the failure back to the choice point that
      led to this assignment or to the top level.

      </LI>
      <LI>When the failure continuation for an <kbd>amb</kbd>
      runs out of choices, it calls the failure continuation that was originally
      given to the <kbd>amb</kbd>, in order to propagate the
      failure back to the previous choice point or to the top level.
      </LI>
    </UL>
    
  </p></div>

  
      <div class='permalink'>
        <a name='h2' class='permalink'></a><h2>
    
    Structure of the evaluator
  </h2></div>

  <div class='permalink'>
<a name='p11' class='permalink'></a><p>
    
    The syntax- and data-representation
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    for the <kbd>amb</kbd> evaluator, and also the basic
    <kbd>analyze</kbd>
    
      <span style="color:green">procedure,</span>
      <span style="color:blue">function,</span>
    
    are identical to those in the evaluator of
    section&nbsp;<REF NAME="sec:separating-analysis"><a class="superscript" id="4.3.3-sec-link-4.1.7" href="./4.1.7.html">4.1.7</a></REF>, except for the fact
    that we need additional syntax
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    to recognize
    
      <span style="color:green">
	the <kbd>amb</kbd> special
	form:<a class='superscript' id='footnote-link-2' href='#footnote-2'style="color:green">[2]</a>
      </span>
      <span style="color:blue">
	the <kbd>amb</kbd> syntactic form:
      </span>
    
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_90_1_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (amb? exp) (tagged-list? exp 'amb))

(define (amb-choices exp) (cdr exp))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_90_1_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=4&prgrm=PTAEGUEkGEAVQFLlAFgHQGZMChslAGYCuAdgMYAuAlgPYkDOhATjQLYQzxKpoCMaAJlzFy1OqCr0A+gBsqFAKZMAhjIAUZNgAc6CkhQCUoAN7ZQ50EwUUiTEhOkkirAEZKN23fqOgAPr7MLIItJKXoKJioSAHMPVh0SPUNzf0DgoNCXGhoZBWUSOISko1T04NCnGXVNeK9ki1KykOlSABMFAiiFVsK6gwBubABfbBFKWns5RRUZKQA3VSIFXsTvEyC0y2tbexqi-UGR0dJx8VCKZWjo7tlJCjVw1goAGlAKAAsFKQvoo1Mgqw2OwOKRaZRUJgPChPIwAMlhoE+yh6j2SAF4MW9Pt9LodhCcxPYKspWMs9n0TJtATsQT9rq1buEVklXgAiEgkhSsgbDY6iCagegAT1cOSkNAIUg5pOZa3+FmpwKRPQuVGqnlWhh5RzGhNArGUAGsvsp6PQqNESKT9FDIjFXgoAB5aKxmiZ-KnbYFyJms03my3Wiis17hO3RB3O13mujavmnInSf0Wq1JWXJeXmRWJnFXG4++7kzVs5OBpLcvG6gWl1P6MIirLq2qaj0Ar32ZVqVXqTvd9MGAdxqviGtB+aLL5Ol0KN10fuUttAjt5FXg9R9ovFAd4+N60LtMgyZQqQlQmELhXt2mXemM+6otmaBgXOsHo8nibcvwBJrNXO3gszxeUBWQWSJlBcXIpDfY9lEJL9UhGYd7Bgj86HrUV1FRVssyvXs1zUfC1SAwchwJAVULgiZxxkJYpCnaMJhIi8tiXREVy7Ai+2w7deV3AVQiPVxWmUeioxnGMCmwljs2vPMGUAh8QKElwRLE6dZxICteWQ0AVLUsEVFJaZ6GYzNZINLQHgbMUJSlTlXiIrDoS1Mj+XEfTRKyVohTMtJZKczjiJ4uN+LOaRszCC5FCDPzLzY84b3zO4gLZSLwjghQg20pDyPESKGIkpjpPMvCOO4lzeJ1PKcyfVp5AmVQ4vimlEvku9UpAuqGroVR1MYugEJ-X85IAlKlNZbrCT6jKYvLNyE1AKbGtmad6rITLmtYmkCykKwCE63gFr1ZbetmJ96AUABHJYbRK-yr12-bOoEY6BVOjlZlUaYOWoOZlnulrvTuPaOk6jBQt00JLpuvQyAByqZKvNqxqZCaYdu+GcrC+wDWNMJrsxhGnnoHDtuB30MbhrlQxc0nKxqwVCepqLMqDUySosB62MCniGfc+xOiYcJWbmu66bJgKONRemdMZ10KFFrKkg5iWkbYiqSbe8L6PiCghQJ2HyGJihSfV1rHCIKogNl3KBZBI8Rdm5Xxa183gQqK31wImWqvxe3MhkGgyENLbyZzOlkrRly2Ug4PDWx3S45DqRvN8wGgeXZEgucmFIcZ0JlC0LQ5A208M-D0ao-vGOQKLkuqDLz9tcFmr+qKucK6l7PNa1fnFuPaJ2801Xz1Knnyq4n3Kr9nGQRJFx52MdJPQS6RI4UlLN30Eti9LqjBrhBFNjKYkZWQ4fJP7I-QBP9JhUw8VJWlZYL8KzTr9ADE0Tr1xWX7vUC8pBkHeDQRuM4l6rxpIPUy29DCHCAA')">function is_amb(component) {      
    return is_tagged_list(component, "application") && 
           is_name(function_expression(component)) && 
           symbol_of_name(function_expression(component)) === "amb";
}
function amb_choices(component) {
    return args(component);
}
</pre></div></div></td></tr></table>
    <table width="100%">
        <colgroup><col width="48%"><col width="1%"><col width="51%"></colgroup>
        <tr>
          <td class="meta" style = "color:grey; text-align: center">Original</td>
          <td></td>
          <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
        </tr>
        <tr><td><span style="color:green">
      </span>    </td>
          <td></td>
          <td><span style="color:blue">
	The symbol <kbd>amb</kbd> here is no longer
	a name with proper scoping. Whenever the symbol
	<kbd>amb</kbd> appears as the function
	expression of an application, the evaluator treats the application as
	a nondeterministic choice point.<a class='superscript' id='footnote-link-3' href='#footnote-3'style="color:blue">[3]</a>
      </span></td></tr></table>
  </p></div>

  <div class='permalink'>
<a name='p12' class='permalink'></a><p>
    We must also add to the dispatch in <kbd>analyze</kbd> a
    clause that will recognize
    
      <span style="color:green">this special form and generate an appropriate execution procedure:
      </span>
      <span style="color:blue">such expressions and generate an appropriate execution
      function:</span>
    
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_90_2_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
((amb? exp) (analyze-amb exp))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_90_2_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=4&prgrm=PTAEGUEkGEAVQFLlAFgHQGZMChslAGYCuAdgMYAuAlgPYkDOhATjQLYQzxKpoCMaAJlzFy1OqCr0A+gBsqFAKZMAhjIAUZNgAc6CkhQCUoAN7ZQ50EwUUiTEhOkkirAEZKN23fqOgAPr7MLIItJKXoKJioSAHMPVh0SPUNzf0DgoNCXGhoZBWUSOISko1T04NCnGXVNeK9ki1KykOlSABMFAiiFVsK6gwBubABfbBFKWns5RRUZKQA3VSIFXsTvEyC0y2tbexqi-UGR0dJx8VCKZWjo7tlJCjVw1goAGlAKAAsFKQvoo1Mgqw2OwOKRaZRUJgPChPIwAMlhoE+yh6j2SAF4MW9Pt9LodhCcxPYKspWMs9n0TJtATsQT9rq1buEVklXgAiEgkhSsgbDY6iCagegAT1cOSkNAIUg5pOZa3+FmpwKRPQuVGqnlWhh5RzGhNArGUAGsvsp6PQqNESKT9FDIjFXgoAB5aKxmiZ-KnbYFyJms03my3Wiis17hO3RB3O13mujavmnInSf0Wq1JWXJeXmRWJnFXG4++7kzVs5OBpLcvG6gWl1P6MIirLq2qaj0Ar32ZVqVXqTvd9MGAdxqviGtB+aLL5Ol0KN10fuUttAjt5FXg9R9ovFAd4+N60LtMgyZQqQlQmELhXt2mXemM+6otmaBgXOsHo8nibcvwBJrNXO3gszxeUBWQWSJlBcXIpDfY9lEJL9UhGYd7Bgj86HrUV1FRVssyvXs1zUfC1SAwchwJAVULgiZxxkJYpCnaMJhIi8tiXREVy7Ai+2w7deV3AVQiPVxWmUeioxnGMCmwljs2vPMGUAh8QKElwRLE6dZxICteWQ0AVLUsEVFJaZ6GYzNZINLQHgbMUJSlTlXiIrDoS1Mj+XEfTRKyVohTMtJZKczjiJ4uN+LOaRszCC5FCDPzLzY84b3zO4gLZSLwjghQg20pDyPESKGIkpjpPMvCOO4lzeJ1PKcyfVp5AmVQ4vimlEvku9UpAuqGroVR1MYugEJ-X85IAlKlNZbrCT6jKYvLNyE1AKbGtmad6rITLmtYmkCykKwCE63gFr1ZbetmJ96AUABHJYbRK-yr12-bOoEY6BVOjlZlUaYOWoOZlnulrvTuPaOk6jBQt00JLpuvQyAByqZKvNqxqZCaYdu+GcrC+wDWNMJrsxhGnnoHDtuB30MbhrlQxc0nKxqwVCepqLMqDUySosB62MCniGfc+xOiYcJWbmu66bJgKONRemdMZ10KFFrKkg5iWkbYiqSbe8L6PiCghQJ2HyGJihSfV1rHCIKogNl3KBZBI8Rdm5Xxa183gQqK31wImWqvxe3MhkGgyENLbyZzOlkrRly2Ug4PDWx3S45DqRvN8wGgeXZEgucmFIcZ0JlC0LQ5A208M-D0ao-vGOQKLkuqDLz9tcFmr+qKucK6l7PNa1fnFuPaJ2801Xz1Knnyq4n3Kr9vAwGQxgCBYdgoDgRBkHQfgMH9xbziYJY1EdMnK8ybJcnyQ+jE2MoAH5QEdUAMTRN594UUBr-SAAuUAlBYSFHVjmfPI9gpwKEoN0V4Vh4ZUH+q0T+2Mcb6iNF8ZCahDKchMq8NODoSBzGPrJQCk1PBtCkMhEMH8RroOMkoegWCaA+RwXg-ue5pDkhIaggg+DkbSEjgpFKBBHzEJIAyMhLdCBtyodYGhahOEsUrk9MGAjQBHWYQKZCqd6G+VkZmeRINnpKNeqo8Q6i9BzAhHQWK2jPRsQUQdJREMdy6Txl8SKCxaJkjoIoOU1idopVZK4icIYlqeOKEYnMAT3FqDcUsLhCUeFJT4UyaJCg0rthoksRO8s0nJKkE+Lx9xkmxJpIFQp+d7ZwyDuaGI9FcHmNrPcUxRTgR9kaWEwgEIRZL05GoRpcju49FaXLcp5BKlfBcFooyKSf64L+BsRcNIwQQhkZMxhcYLoUCxJOPWBtTF1KDI-UAlQZCDEQc40hkzrKYVoaAZJZsdGyUWZCYUVzXi3LEV00kGFGymQ+QoWZXN5lKg4r895kz0kzmWZyf55gfHNIIiCxxjMnReIZLslg9TLnfNeaoa5LhTSThmX0x6ehogfExTkM2T89IkrJW40mFCgh30eWoM5vzyUyGuXSgwWD8U1LwQyiw39cgxDJc875RgAA81KRXvCiTigwArGU-yYH-NQrIAAq2QkEkCFKAQezgVaCiIMXOQ3Rv6slAAAanfiNW1YYojRCoAQdONkOVGGtUEi11rFV2oiA6p1vkuUKtteYb+v8aCQg1VqggCgADueqmDRANfoRg9BjUNzNSBK1NqQ1NHtTEAN7KzYerZNmn1I182OudXKt1ZTFpBxoIaY1XyxTJPZasuRulTGyGyFZXpOigi6XoBtKSrrOXyrkU0WSntrZiopcG3NwQ77dobVZcttqKk0CqUPNFFi0yNIXYuwVgpXWP0xJ2Odbr11NDvp2Ll16yjf2HRfbiY7uVvAIkGwYTQRhNCdaAHpuCz3Pw+FsrQ+s+V7OKJOso4anmurZAAVRIFkNohzOTaR-T-Dlb8B1lHWcwTkByhadIuYMkNsln0FF+S2jlkLSTcofb+Gjtz6N-J5D+zYv7M7TLmD2mgfaZmIvtjWWj4L203NUB2nRXbcH8cE3gmD5gh0jqLdit1SngjTstrOt9THl1ydXWoJjQRN3bsg+i2KB6mNPtPVSi9emj0WDvpdRWd6cXqcPUep9qnX1XPfX2L9DKhg5vSP+wDcxgObN1uBnZtTLPQbw+kODEnWTIdQ8I9DpJQAAFoct6rdGWfQmGyghYUDhzTQQCO-OIx0xWbLyO2so6pmjl6fmTMY05poLGJztahRx0rXHYUgMM72iLoV8AL2YGwDga9uCbzQCgHeLDQSRFYA1f6pCaoyNIJLbh-5q47ZIGyF0VB1t-S5GI0752YFfDOyXF20UmIiD2xPHu8LduhQI9djbKCaqMGfoBChhDlRBIsMqXNnX0iEO7GD8w3ZIfPGB34x5cPQCPMR8j30BY0cFkx2UQhM6ZBBKJyNKHwRCH1XoCXZQQoglU5p7q385OgiELg3DuDIaWcWEIQaD4UgIL0BDHz94AuXCMCaNz8whDLVo4sIfV4QojBogAHz32zUzqXek-E5bl+YBXoAlePzVw-fLmukcE78QAKj1wBgBhvlcm9AFbw35gteEOALbg3RvVfq7AObrH9xWQAFIvf259074PrvQDu78U-OX3vHfq6pUri30O-EAEIMQJ-D0nh+Wfn6p8D2qiVYfFd59AFK8wRfLe+glWiPXifjfq-r9X2PvoVdl4d83h+au29p4p34lXDfXjBCb773vz8HcD9Z5n236ugi+-MBniwR8KE8m+2t37W2Ba0YBwyyyhEVyvB+xdnfCZZab7O9v9RNAXAACswGm0fgfouR3m+ENP7doJgUXsDhn00F-ptgvDyNgFfjdptusvkM-oDilIQm0B0F0K0EEggZ0IkK0Frl1r+IQpACQGgfIHTqPrgfgfrJgVgbXkHiLlILAJAHDlQTQWQeQYPr6FQQAKJo5sGMFME85+IAByygvBtu-BvBXm3BZQG+dA4Q6OW+Z+UBdYbWL+TQh+BAzenYnCJ+Mht2uSkhL4psEhz40h1+shOh0B4K++Shb+Khvuv+-+hhEBXwchehJyuk9cMgBsQBf2AsR2rwg8BYTS9grhBsUQUgCBTAbhDqUg9+ygCww6kQ4GxmTmHhUg92uQQYVEc4L2ABtqvhdwAwwQfEQ62wWgFme6No-hP8joKKJRGKD69cegPQSR6ibWrwJmwQSRjhe+XBQQdRwiaCmhwBbcd+j+lA1yrRQQ7RJhdYbyWRv4oGMWEGu69SoUuQGycx0QQceKswix+yz8rmza2xaYoBk2-202K8nA68PAWA28iChcrg84xg6Qw2VciShYGoLIdcJqjc6RWkcICIPqxIMoJi4kmk-YvxoWearq4oko0oywQJGkkkoJUWforgrIbSJILguS7wNAjcEKm43igKARiapkeJhgwmA8n0QoAAXl8FMEoE1CSeURFqGEQGQPDBAoQGuEnmmqyQoN0GoLSTMOJgya8AQJyWSXqPkKoFSV8DCfcU8UyUajyeyaKWqI7j6tyWyT0A2k2sUZeuJnqXZLKcKbxl0WUCqTIHWhKRSdSbIOiWpIVCCQyXIt9rBNQsLAcp5KCK6VIsLP2N+hYARmnB6XaV5Jon6ZsIGSIAcpKW4dSWoGnANrhGxAqRqbya0CKZycbuqSyZqSysgufqeJIpgqAC4CIKsjMSGuaZadWNaV8FTMbDbMfIUUbNQKoG4WoMoFgsfASQBqYsyUqemRyaqc3mMcoAqWMfrqJMkhmWqK9FmWIeYKEBEgfFOROKIeQS5jmWmR2eCjOTIK9BOUEN-C4CmVucqWuK9BWbmlWf6eYNxspozEZiRvVqQJAjOC+QwN2TxkTmoArDvvSkenfM+Tvg+kKmNvWa2VUFonVjvleV1p2H+SIKTKabMQRIhaQMhbeaAPecEgYUhQcofjGdKbTFrFhdplKF7EdmbD6gZpFr7qgUgT6mBQJkftnEhQFh9p+dWSOLWdBGAu+N8XKVVjoSephAcpRISLRuGcJQYXMFGc-ERXGRJdRDkg6QiQyYmZXKeQOXuUntenJaQEyWMTWnuXOb7klk5qJnqW2peupqslheQZRmeT0AxegaZZpUekMHBcxmKQUYzIpSaIVhik6TogRpetGUFWOJetJQGSJQZfYApbWR2ZFUkOCsPOpW8d4JpbJNpZqbpfOWUPFUZbmiZUOfuUng8bmvgFbrwFbiZgRjkAyMkh6dkDqWJjZQhiaQ5SGlZZCR1ZhHZV1SZk5QOSZYebamoBVcENVQIHVQubmr1ZhPqQhuNfNSNI1bueCWtdtUNTtb+LJOaQIJNd1dtUMB5T+t5cpr5dVCJrxR9PSZlRmI8TJVIVoPJXqklfdatFYOtJtBpVhQRmQO9QFR4MIj1J9NoQwMzDaP9RGSJcoMDZ9XQPVNNF9DID9FRP9KCWRVeLlWmflarj6m9YZX2UxvgKmWaLhdQE4N8YQBGj-NElRDEFtbavgKBtId0F8YoG8DQKAHfqqPYGtOCkxn0TcNOWVWZSrhOXvAfELYUizYunfEDSTbgv2XlRLeuYut-AjSrXMGrfjRrZdUEJNmuLYG-HklEEQLTQQPTQoIzdTdEArb+GzZ8Bzb9YoAAJAe1zJHo3l+X2xUbihECKzKWSFCUhAqFqDQzQ3wyIkWVhV0wHL1nwxKzswxXpDkVZSxaGxEyNkPp3xHKgV6rFz1EPAjpB0h38WwSEg-IwXOyxS+woUVrl00DB18WHjV0TCmSrXBBnLJ3LB-n10qyNmDhYVlYVYWXkWh0FAMnlp3yATT1SUaXlrfxHJj3+31ogx2SkA1h8kwl3JPGH5SDN6shW471BXdA26vD73cUBG8XJyhwhVw0GFBnPwP0aI+Tp24VSFBwbQcpJ0t1t3T2mQJkA0iXn0BjoEA7a4izb0cgX1anBzypgMv2I1SlxmgPyl9mKnq1VkFW-ilkk2VH1HVGxS-0eagAQMpjdDXKNJG0WCpnnmqn9C5ob1WnoMuJpJD0w2PXHwEZMBoOxkD1pJqVMSw09l41MMWn4NToiDFVHqlWHVcnOV5n4zLnLBuLvpKP0NXXMNsMCjXCKyDymQ60MCML61SPQoArfk6bqCmMAW3w4PblHK6UMrfydj2MGDyNMHk1bmU0W0016g21MBYiSB6oiDjUdmJruUyNiGGMC5Ek5wdnsU6NMGk17VlC+M8n+OeKW3W0Ro92s1gBQK2Dmj-RLRtk82gDxPGOFMjRRPRDXLmkQyxMZPBCMMNHgiQiDw+FElN1tO6MyAQypPkHaPjV+03WLROhgLB0mifFNwZGvkJqNMWODl4P3L7aNHbYvYMqbmjWBGrZGFaEcJLPGP9ODOa2gDfyhBsLCIFnPa7ZO1AVtxpxHZePXrIokMHE2itHqJFnSKZGtHGMjPiK77fP3B-70PxmaKgxpro0xO+4mYdNR0RTZITjQs+SwtWzJCFN3zqOQ35IYsGyujYuXNdbfyuUQKFNjOLpVluPKqqplkgSkCGgkA0Cxqtz2z6xaBvx5ZZqWqHmsjTNkCzMC7zPfEIIuG8WuFc1iO8POkiUECCPSlHYJjpVyvNhbgoNSH2MEVv4BW9ONPY1YOq1OOWOtPMZyPpPkHeEa0WtdY1OJP2MtEDPmDWsDMNNNNrgtOE2uvBDCuisysLPUavl1NHrAtmtrPevnNOY0ujNinvyTPsNCMC53FTh8MiXK0MB6tWQGt6quCYnYnwymTpvZW43YMdME1q4WW6QRAGyJCVEaBYk4kH0Ub7ZHJNtFszhkuOPmmTU2bsTZxkDNvFtePusZOVthtj5J51tSjIpJPDtdvIXnV3kMqySzsNuFjsVj3ik1kcPh1JkWy3DTAPWaveA0UfUcPHt0lNj7CGACrXOODdKz22p3wBX2QygvtNCPvt0CWnhfu-hvu8XT39gPsgijhpgAc3qXspsQc8Nnv3u-g-tfWgevswfSmQ0o0rSoffsOwhnqtzhQeOPvuemiOEe8NgfR1Gyx1EfpBAdXv90PAx11nRSPbEm8Nks-sP04eAfoc2nce0fHpLlcOsexSCdKrvvpSieQcUdIfgd3HifOZ8cmgKeye4eFziv-tqe8fvtBuCWKdhoqoRrphIYkCsvsv2DCj6DKCm75YBWSv+WuB21NRTjmORv5WVU+2HvAgg3puSNRt6NJtqJ105DB1MRRBaDB3lHonOfqCGSXRqoPFeoSAkCRcbIerYXcggvRbrF359TgvZelWbsC7o1KC-S3ZJ5uKFdJ6UsYG7sjhVBhChc11R2pdRdyIrGCjNdd0HJr0e2bBQz6Bld9RGYRfB2vCzuXDggkBfmLmR1jcbJUqsiTfRDTdfgWVBArfTfHXBbYaXSVYWAxduJoLHgJeshJfZoLfZoWpDBZdMZrEbH5fxalEvBk1gBHeqBONmgi1VeHLIolcY0XYVUTn0DdeSEHLMq-eg+0Q10ru5rTpDd2AjdjbLdMAGxTdRBBLFffTDdA8nW-heVvf5tuBuJlVm0i01fCKIHoFMZw84U4VRAY2zBGYPoLc6OTXN4bcjQM5Hi+Ssj4CM-DcyAMsRola5pnU41sRWD-TCwAxg+fk7jVZexemy8hPPwWp+uLoAA6iCVgN0EIywWgVjmvI0OvPZK+WgoAb7dxRg38AA5OAFRPQJ0N0FsPr1YHbywwuTryFib66zr04llG4JCPIFlK8EfOsH7+kGbzYxRdbBH1H6b7s4cl7In11jH1-BIDFFFp2An2n+YBn44w-Pn0eoX5n6SE5yHzFBNwREfHkZrz7yXztTr516QPF678-GvU32UAH4zO31ILGhGj0IP0wC8cb-756O78sCvj+W36d90NuH74X3r0QAbyykH+4J2HP7LxgTX8RCP2P0YAXin1UPX8EIX9Vq3Xcwfwclv6l-P3VwM4X9v5dK0Acn2C-wv171H8v49ClJ2AfzvBaMr+DIA-mf24KN9u+81HXpvgUA6BzQNdD0ilDt7TgtAdvV4Hb2CboDQAdvCgDQGwE4Cog2Au3uMmIGxp5A7wO3nkV772x++qArdODT6haB3gKgBLuP2gFPFAIKAqwFoByzMDWBCgAgT-yYz98D+oteAeDVJij5tqZfW1P3zZakBQQLA-FJNXAF7VIBUAsQjAJEoKDs2sBJkHb10HEDwgRAdoPoGIEugJQEkCNMQLLi2DHY9AKgV720GyUlA4uJAQYJl4uBjBNgeqDOGIG5BKAZtRwRgLyCmxjBuQOAY4OoFTsS+LgnVkwGoCHgZwHg+4Hb2PBJDcgxA0DMQOUBOCOBukfvuaHiBQRdBSggQRz084ZNf+NiZAcUIew5ZdBfA5QZdCEHVCRB8-AfkPyiaZDu20g9oYkU6FiDdBmFBvsME0He9EE8gq-uUJUHsCJ+g6RmAaCFBuAxIKKNQGUP4H4p5hEAtdleHRIbCZhWwy6P0LGHkFlhqwz5r0S4FNDjhgg04bmlkE7VNhLQqZJML9Z0CeBDA1GrMLYGj0gghfX3hMKcw1CaQFwycMQ16JFCUiMpI4a8NUHf9te4w4EUwRoGLQihSQamJUKb6giKYaQy6EN2NhtDE+Tw38NMMUF3DJqDw5vh0Nl7zA3Bvw5YIvyf7IiURWBNEXqH75eDGR2IkkQNyWG05LhkInoNyLuE7DURewtiAcNFGvDqRLI84YKIhHrCuBXg5oQIOJGPDYhQQGUQILlEgitRFgT4XAO+ErQeRpEREYCK9psiARh9RUWsNLqiDuhXg0YWtQ0HWjS+UwzoQt1a5pdxRbTZ-vfx34HIFuiIqARfxEoEjFu6OToZGKxFqD-Rk-VflYBRZx91An-DAvGIWE8ZIxoYlEW6PdG5pUSuAXAG2Sa4w8u6O2Rru3xCbeoNeBYzUf329FcCchGAywTGjNA2CMBgQoEP4L1G2pSRv4XAfgIwEticBJgswRQDIEUDshnwWwXBCoHgCKwQAA')">: is_amb(component)
? analyze_amb(component)
</pre></div></div></td></tr></table>
  </p></div>

  <div class='permalink'>
<a name='p13' class='permalink'></a><p>
    The top-level
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    <kbd>ambeval</kbd> (similar to the version of
    
      <span style="color:green"><kbd>eval</kbd></span>
      <span style="color:blue"><kbd>evaluate</kbd></span>
    
    given in section&nbsp;<REF NAME="sec:separating-analysis"><a class="superscript" id="4.3.3-sec-link-4.1.7" href="./4.1.7.html">4.1.7</a></REF>) analyzes the
    given expression and applies the resulting execution
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    to the given environment, together with two given continuations:
    
    
      
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_90_3_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (ambeval exp env succeed fail)
  ((analyze exp) env succeed fail))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_90_3_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=4&prgrm=PTAEGUEkGEAVQFLlAFgHQGZMChslAGYCuAdgMYAuAlgPYkDOhATjQLYQzxKpoCMaAJlzFy1OqCr0A+gBsqFAKZMAhjIAUZNgAc6CkhQCUoAN7ZQ50EwUUiTEhOkkirAEZKN23fqOgAPr7MLIItJKXoKJioSAHMPVh0SPUNzf0DgoNCXGhoZBWUSOISko1T04NCnGXVNeK9ki1KykOlSABMFAiiFVsK6gwBubABfbBFKWns5RRUZKQA3VSIFXsTvEyC0y2tbexqi-UGR0dJx8VCKZWjo7tlJCjVw1goAGlAKAAsFKQvoo1Mgqw2OwOKRaZRUJgPChPIwAMlhoE+yh6j2SAF4MW9Pt9LodhCcxPYKspWMs9n0TJtATsQT9rq1buEVklXgAiEgkhSsgbDY6iCagegAT1cOSkNAIUg5pOZa3+FmpwKRPQuVGqnlWhh5RzGhNArGUAGsvsp6PQqNESKT9FDIjFXgoAB5aKxmiZ-KnbYFyJms03my3Wiis17hO3RB3O13mujavmnInSf0Wq1JWXJeXmRWJnFXG4++7kzVs5OBpLcvG6gWl1P6MIirLq2qaj0Ar32ZVqVXqTvd9MGAdxqviGtB+aLL5Ol0KN10fuUttAjt5FXg9R9ovFAd4+N60LtMgyZQqQlQmELhXt2mXemM+6otmaBgXOsHo8nibcvwBJrNXO3gszxeUBWQWSJlBcXIpDfY9lEJL9UhGYd7Bgj86HrUV1FRVssyvXs1zUfC1SAwchwJAVULgiZxxkJYpCnaMJhIi8tiXREVy7Ai+2w7deV3AVQiPVxWmUeioxnGMCmwljs2vPMGUAh8QKElwRLE6dZxICteWQ0AVLUsEVFJaZ6GYzNZINLQHgbMUJSlTlXiIrDoS1Mj+XEfTRKyVohTMtJZKczjiJ4uN+LOaRszCC5FCDPzLzY84b3zO4gLZSLwjghQg20pDyPESKGIkpjpPMvCOO4lzeJ1PKcyfVp5AmVQ4vimlEvku9UpAuqGroVR1MYugEJ-X85IAlKlNZbrCT6jKYvLNyE1AKbGtmad6rITLmtYmkCykKwCE63gFr1ZbetmJ96AUABHJYbRK-yr12-bOoEY6BVOjlZlUaYOWoOZlnulrvTuPaOk6jBQt00JLpuvQyAByqZKvNqxqZCaYdu+GcrC+wDWNMJrsxhGnnoHDtuB30MbhrlQxc0nKxqwVCepqLMqDUySosB62MCniGfc+xOiYcJWbmu66bJgKONRemdMZ10KFFrKkg5iWkbYiqSbe8L6PiCghQJ2HyGJihSfV1rHCIKogNl3KBZBI8Rdm5Xxa183gQqK31wImWqvxe3MhkGgyENLbyZzOlkrRly2Ug4PDWx3S45DqRvN8wGgeXZEgucmFIcZ0JlC0LQ5A208M-D0ao-vGOQKLkuqDLz9tcFmr+qKucK6l7PNa1fnFuPaJ2801Xz1Knnyq4n3Kr9vAwGQxgCBYdgoDgRBkHQfgMH9xbziYJY1EdMnK8ybJcnyQ+jE2MoAH5QEdUAMTRN594UUBr-SAAuUAlBYSFHVjmfPI9gpwKEoN0V4Vh4ZUH+q0T+2Mcb6iNF8ZCahDKchMq8NODoSBzGPrJQCk1PBtCkMhEMH8RroOMkoegWCaA+RwXg-ue5pDkhIaggg+DkbSEjgpFKBBHzEJIAyMhLdCBtyodYGhahOEsUrk9MGAjQBHWYQKZCqd6G+VkZmeRINnpKNeqo8Q6i9BzAhHQWK2jPRsQUQdJREMdy6Txl8SKCxaJkjoIoOU1idopVZK4icIYlqeOKEYnMAT3FqDcUsLhCUeFJT4UyaJCg0rthoksRO8s0nJKkE+Lx9xkmxJpIFQp+d7ZwyDuaGI9FcHmNrPcUxRTgR9kaWEwgEIRZL05GoRpcju49FaXLcp5BKlfBcFooyKSf64L+BsRcNIwQQhkZMxhcYLoUCxJOPWBtTF1KDI-UAlQZCDEQc40hkzrKYVoaAZJZsdGyUWZCYUVzXi3LEV00kGFGymQ+QoWZXN5lKg4r895kz0kzmWZyf55gfHNIIiCxxjMnReIZLslg9TLnfNeaoa5LhTSThmX0x6ehogfExTkM2T89IkrJW40mFCgh30eWoM5vzyUyGuXSgwWD8U1LwQyiw39cgxDJc875RgAA81KRXvCiTigwArGU-yYH-NQrIAAq2QkEkCFKAQezgVaCiIMXOQ3Rv6slAAAanfiNW1YYojRCoAQdONkOVGGtUEi11rFV2oiA6p1vkuUKtteYb+v8aCQg1VqggCgADueqmDRANfoRg9BjUNzNSBK1NqQ1NHtTEAN7KzYerZNmn1I182OudXKt1ZTFpBxoIaY1XyxTJPZasuRulTGyGyFZXpOigi6XoBtKSrrOXyrkU0WSntrZiopcG3NwQ77dobVZcttqKk0CqUPNFFi0yNIXYuwVgpXWP0xJ2Odbr11NDvp2Ll16yjf2HRfbiY7uVvAIkGwYTQRhNCdaAHpuCz3Pw+FsrQ+s+V7OKJOso4anmurZAAVRIFkNohzOTaR-T-Dlb8B1lHWcwTkByhadIuYMkNsln0FF+S2jlkLSTcofb+Gjtz6N-J5D+zYv7M7TLmD2mgfaZmIvtjWWj4L203NUB2nRXbcH8cE3gmD5gh0jqLdit1SngjTstrOt9THl1ydXWoJjQRN3bsg+i2KB6mNPtPVSi9emj0WDvpdRWd6cXqcPUep9qnX1XPfX2L9DKhg5vSP+wDcxgObN1uBnZtTLPQbw+kODEnWTIdQ8I9DpJQAAFoct6rdGWfQmGyghYUDhzTQQCO-OIx0xWbLyO2so6pmjl6fmTMY05poLGJztahRx0rXHYUgMM72iLoV8AL2YGwDga9uCbzQCgHeLDQSRFYA1f6pCaoyNIJLbh-5q47ZIGyF0VB1t-S5GI0752YFfDOyXF20UmIiD2xPHu8LduhQI9djbKCaqMGfoBChhDlRBIsMqXNnX0iEO7GD8w3ZIfPGB34x5cPQCPMR8j30BY0cFkx2UQhM6ZBBKJyNKHwRCH1XoCXZQQoglU5p7q385OgiELg3DuDIaWcWEIQaD4UgIL0BDHz94AuXCMCaNz8whDLVo4sIfV4QojBogAHz32zUzqXek-E5bl+YBXoAlePzVw-fLmukcE78QAKj1wBgBhvlcm9AFbw35gteEOALbg3RvVfq7AObrH9xWQAFIvf259074PrvQDu78U-OX3vHfq6pUri30O-EAEIMQJ-D0nh+Wfn6p8D2qiVYfFd59AFK8wRfLe+glWiPXifjfq-r9X2PvoVdl4d83h+au29p4p34lXDfXjBCb773vz8HcD9Z5n236ugi+-MBniwR8KE8m+2t37W2Ba0YBwyyyhEVyvB+xdnfCZZab7O9v9RNAXAACswGm0fgfouR3m+ENP7doJgUXsDhn00F-ptgvDyNgFfjdptusvkM-oDilIQm0B0F0K0EEggZ0IkK0Frl1r+IQpACQGgfIHTqPrgfgfrJgVgbXkHiLlILAJAHDlQTQWQeQYPr6FQQAKJo5sGMFME85+IAByygvBtu-BvBXm3BZQG+dA4Q6OW+Z+UBdYbWL+TQh+BAzenYnCJ+Mht2uSkhL4psEhz40h1+shOh0B4K++Shb+Khvuv+-+hhEBXwchehJyuk9cMgBsQBf2AsR2rwg8BYTS9grhBsUQUgCBTAbhDqUg9+ygCww6kQ4GxmTmHhUg92uQQYVEc4L2ABtqvhdwAwwQfEQ62wWgFme6No-hP8joKKJRGKD69cegPQSR6ibWrwJmwQSRjhe+XBQQdRwiaCmhwBbcd+j+lA1yrRQQ7RJhdYbyWRv4oGMWEGu69SoUuQGycx0QQceKswix+yz8rmza2xaYoBk2-202K8nA68PAWA28iChcrg84xg6Qw2VciShYGoLIdcJqjc6RWkcICIPqxIMoJi4kmk-YvxoWearq4oko0oywQJGkkkoJUWforgrIbSJILguS7wNAjcEKm43igKARiapkeJhgwmA8n0QoAAXl8FMEoE1CSeURFqGEQGQPDBAoQGuEnmmqyQoN0GoLSTMOJgya8AQJyWSXqPkKoFSV8DCfcU8UyUajyeyaKWqI7j6tyWyT0A2k2sUZeuJnqXZLKcKbxl0WUCqTIHWhKRSdSbIOiWpIVCCQyXIt9rBNQsLAcp5KCK6VIsLP2N+hYARmnB6XaV5Jon6ZsIGSIAcpKW4dSWoGnANrhGxAqRqbya0CKZycbuqSyZqSysgufqeJIpgqAC4CIKsjMSGuaZadWNaV8FTMbDbMfIUUbNQKoG4WoMoFgsfASQBqYsyUqemRyaqc3mMcoAqWMfrqJMkhmWqK9FmWIeYKEBEgfFOROKIeQS5jmWmR2eCjOTIK9BOUEN-C4CmVucqWuK9BWbmlWf6eYNxspozEZiRvVqQJAjOC+QwN2TxkTmoArDvvSkenfM+Tvg+kKmNvWa2VUFonVjvleV1p2H+SIKTKabMQRIhaQMhbeaAPecEgYUhQcofjGdKbTFrFhdplKF7EdmbD6gZpFr7qgUgT6mBQJkftnEhQFh9p+dWSOLWdBGAu+N8XKVVjoSephAcpRISLRuGcJQYXMFGc-ERXGRJdRDkg6QiQyYmZXKeQOXuUntenJaQEyWMTWnuXOb7klk5qJnqW2peupqslheQZRmeT0AxegaZZpUekMHBcxmKQUYzIpSaIVhik6TogRpetGUFWOJetJQGSJQZfYApbWR2ZFUkOCsPOpW8d4JpbJNpZqbpfOWUPFUZbmiZUOfuUng8bmvgFbrwFbiZgRjkAyMkh6dkDqWJjZQhiaQ5SGlZZCR1ZhHZV1SZk5QOSZYebamoBVcENVQIHVQubmr1ZhPqQhuNfNSNI1bueCWtdtUNTtb+LJOaQIJNd1dtUMB5T+t5cpr5dVCJrxR9PSZlRmI8TJVIVoPJXqklfdatFYOtJtBpVhQRmQO9QFR4MIj1J9NoQwMzDaP9RGSJcoMDZ9XQPVNNF9DID9FRP9KCWRVeLlWmflarj6m9YZX2UxvgKmWaLhdQE4N8YQBGj-NElRDEFtbavgKBtId0F8YoG8DQKAHfqqPYGtOCkxn0TcNOWVWZSrhOXvAfELYUizYunfEDSTbgv2XlRLeuYut-AjSrXMGrfjRrZdUEJNmuLYG-HklEEQLTQQPTQoIzdTdEArb+GzZ8Bzb9YoAAJAe1zJHo3l+X2xUbihECKzKWSFCUhAqFqDQzQ3wyIkWVhV0wHL1nwxKzswxXpDkVZSxaGxEyNkPp3xHKgV6rFz1EPAjpB0h38WwSEg-IwXOyxS+woUVrl00DB18WHjV0TCmSrXBBnLJ3LB-n10qyNmDhYVlYVYWXkWh0FAMnlp3yATT1SUaXlrfxHJj3+31ogx2SkA1h8kwl3JPGH5SDN6shW471BXdA26vD73cUBG8XJyhwhVw0GFBnPwP0aI+Tp24VSFBwbQcpJ0t1t3T2mQJkA0iXn0BjoEA7a4izb0cgX1anBzypgMv2I1SlxmgPyl9mKnq1VkFW-ilkk2VH1HVGxS-0eagAQMpjdDXKNJG0WCpnnmqn9C5ob1WnoMuJpJD0w2PXHwEZMBoOxkD1pJqVMSw09l41MMWn4NToiDFVHqlWHVcnOV5n4zLnLBuLvpKP0NXXMNsMCjXCKyDymQ60MCML61SPQoArfk6bqCmMAW3w4PblHK6UMrfydj2MGDyNMHk1bmU0W0016g21MBYiSB6oiDjUdmJruUyNiGGMC5Ek5wdnsU6NMGk17VlC+M8n+OeKW3W0Ro92s1gBQK2Dmj-RLRtk82gDxPGOFMjRRPRDXLmkQyxMZPBCMMNHgiQiDw+FElN1tO6MyAQypPkHaPjV+03WLROhgLB0mifFNwZGvkJqNMWODl4P3L7aNHbYvYMqbmjWBGrZGFaEcJLPGP9ODOa2gDfyhBsLCIFnPa7ZO1AVtxpxHZePXrIokMHE2itHqJFnSKZGtHGMjPiK77fP3B-70PxmaKgxpro0xO+4mYdNR0RTZITjQs+SwtWzJCFN3zqOQ35IYsGyujYuXNdbfyuUQKFNjOLpVluPKqqplkgSkCGgkA0Cxqtz2z6xaBvx5ZZqWqHmsjTNkCzMC7zPfEIIuG8WuFc1iO8POkiUECCPSlHYJjpVyvNhbgoNSH2MEVv4BW9ONPY1YOq1OOWOtPMZyPpPkHeEa0WtdY1OJP2MtEDPmDWsDMNNNNrgtOE2uvBDCuisysLPUavl1NHrAtmtrPevnNOY0ujNinvyTPsNCMC53FTh8MiXK0MB6tWQGt6quCYnYnwymTpvZW43YMdME1q4WW6QRAGyJCVEaBYk4kH0Ub7ZHJNtFszhkuOPmmTU2bsTZxkDNvFtePusZOVthtj5J51tSjIpJPDtdvIXnV3kMqySzsNuFjsVj3ik1kcPh1JkWy3DTAPWaveA0UfUcPHt0lNj7CGACrXOODdKz22p3wBX2QygvtNCPvt0CWnhfu-hvu8XT39gPsgijhpgAc3qXspsQc8Nnv3u-g-tfWgevswfSmQ0o0rSoffsOwhnqtzhQeOPvuemiOEe8NgfR1Gyx1EfpBAdXv90PAx11nRSPbEm8Nks-sP04eAfoc2nce0fHpLlcOsexSCdKrvvpSieQcUdIfgd3HifOZ8cmgKeye4eFziv-tqe8fvtBuCWKdhoqoRrphIYkCsvsv2DCj6DKCm75YBWSuMzAX0A5DB1MRRBaDB3lHol21NSGSXRqoPFeoSAkAecbIerYXcggvRbrF359TgtRelWbsC7o1KC-S3ZJ5uIJdJ6UsYG7sjhVBhAuc11R0heedyIrGChFdd0HJr0e2bBQz6Cpd9RGbufB2vCzuXDggkBfmLmR2tcbJUqsgdfRBddfgWVBDDddfHXBbYaXSVYWDeduJoLHj+esiBfZr9fZoWpDCRdMZrEbFxfxalEvBk1gCLeqBONmgi2ZeHLIrJcY0XYVUTnOe0Q10HLMo3cveueSEru5rTqNd2DNdjZDdMAGyddRBBJJffRNePcnW-heWnf5tuBuJlVm0i3ZfCKIHoFMa-c4U4VRAY2zBGYPr9c6OTXN7jcjQM5Hi+Ssj4AE9NcyAMsRola5pnU41sRWD-TCwAxVc-c7jVZexek88hPPwWp+uLoAA6iCVgN0EIywWgVjEvI00vPZK+WgoAb7dxRg38AA5OAFRPQJ0N0FsHL1YLrywwudLyFsr669L04llG4JCPIFlK8EfOsLb+kKrzYxRdbO757yr7s4cl7AH11t71-BIDFFFp2P76H+YOH44w-HH0egnxH6SK4O4C76wO1wREfHkRL9b8nztdLxV6QH5yb8-GvUX2UPb4zOX1ILGhGj0I30wC8Ur3b56Gb8sCvj+WXyt90NuLbwn7L0QPLyyo7+4J2H3zzxgTn8RC3230YAXsH1UPn8EAn9Vq3XcwvwclPyF-37lwMwn9P5dK0Acn2CfwP5b578P49ClJ2Av3eFo1vwyAv2v9wYX9X-NdL5vgoDoOaG91gJMhde04LQLr1eC69gm4A0ALrwoA0BoBMAqINAN17jJkBsaeQO8F155Fa+9sevqAK3Tg0+oWgd4CoH87t9v+TxQCCAKsBaAcsxA0gQoAQE38mM9fBfqLX-7g1SYo+baqn1tT182WpAUECQPxSTV3+e1T-l-zEI-8RKAg7NkAPuC69ZByA8IEQHaD6BkBLoCUBJAjTICy4ugx2PQCwGW9pBslJQOLg9IpRde3PFwMoJsD1QZwyA3IJQDNqGCIBeQU2MoNyB-9DB2AqdsnxME6smA1AQ8DOAsHADjwwQ3IMgNAzIDlARgigbpHr7mh4gUEWQUIIYHk9KqbTW-jYksHJCHsOWWQXQOEGXQmBGTXgZQn74N8m+UTSId224HlCWBVQtgbIMwoF9hgkgq3ogn4Fb90hIg8gR30HSMwDQQoNwGJBRRqA0h9A-FAMI-5rsrw6JSYb0OmGXQGh7Q8giMLGGfNeiVAooSsMYFrDc0FQ7alMJKFTIuhfrPATQIIGo0+hZA0ekEAT429OhTmHITSE2GThiGvRJISkRlLLCzhog6-lLw6EvCmCOAxaEkKSDUxMhRfN4RTAUGXRGuxsMoQH2OGAEqhpwjIe+kGFHp6+1gu4csEH5H8QRoIrAuCL1B4izBBImEaiPq7DDacWwr4T0HxH7DZhYI+YWxEWEsizhhwnEV1g+HjDS6VA6wcUIYEoijhfgoINyIYG8iw+koiwFcL-43CVo1I0iECKeFe1SRjww+gyM+ETDWBNQ6wW0LWoSCtRKfboVUP64ldQubI7IZsEv5n9n4-XIEV-w34iVERA3dHFUI9HQixBdotsF3xRa+91ADookUPyeIeiXRoI00WaNzSolls1YDPktynDmNI2+VLIdY0PbAgQa6bSRlGz0ZHBbE-JPRGDCLFliSxB0NsoV1e5d0dsBXcviE29Ti9YxEo+vlaKoExCIBKgtQRQDQEYDohnwXQXBHFFe9sAuvegF4K0CuDEBJAAcQcJgEd0zQWAv0Rk126SCAADDGywKXkw2O47cWQRURAA')">function ambeval(exp, env, succeed, fail) {      
    return analyze(exp)(env, succeed, fail);
}
</pre></div></div></td></tr></table>
  </p></div>

  <div class='permalink'>
<a name='p14' class='permalink'></a><p>
    
    
    
    A success continuation is a
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    of two arguments: the value just obtained and another failure continuation to
    be used if that value leads to a subsequent failure. A failure continuation
    is a
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    of no arguments.  So 
    
    the general form of an execution
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    is
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_90_4_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(lambda (env succeed fail)
  ;; succeed is (lambda (value fail) ^$\ldots$^)
  ;; fail is (lambda () ^$\ldots$^)
  ^$\ldots$^)</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_90_4_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(env, succeed, fail) => {      
    // succeed $is$ (value, fail) => $\ldots$
    // fail $is$ () => $\ldots$
}</pre></div></div></td></tr></table>
    For example, executing
    <table width="100%">
        <colgroup><col width="48%"><col width="1%"><col width="51%"></colgroup>
        <tr>
          <td class="meta" style = "color:grey; text-align: center">Original</td>
          <td></td>
          <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
        </tr>
        <tr><td><span style="color:green">
	<div class='snippet' id='javascript_90_5_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(ambeval exp
         the-global-environment
         (lambda (value fail) value)
         (lambda () 'failed))</pre></div></div>
      </span>    </td>
          <td></td>
          <td><span style="color:blue">
	<kbd class='snippet'>ambeval($\textit{exp}$,      
    the_global_environment,
    (value, fail) => value,
    () => "failed");</kbd>
      </span></td></tr></table>
    will attempt to evaluate the given expression and will return either the
    expression's value (if the evaluation succeeds) or the
    
      <span style="color:green">
	symbol <kbd>failed</kbd>
      </span>
      <span style="color:blue">
	string <kbd>"failed"</kbd>
      </span>
    
    (if the evaluation fails).
    The call to <kbd>ambeval</kbd> in the driver loop shown below uses
    much more complicated continuation
    
      <span style="color:green">procedures,</span>
      <span style="color:blue">functions,</span>
    
    which continue the loop and support the
    
      <span style="color:green">
	<kbd>try-again</kbd>
      </span>
      <span style="color:blue">
	<kbd>try_again</kbd>	
      </span>
    
    request.
  </p></div>

  <div class='permalink'>
<a name='p15' class='permalink'></a><p>
    Most of the complexity of the <kbd>amb</kbd> evaluator
    results from the mechanics of passing the continuations around as the
    execution
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    call each other.  In going through the following code, you should compare
    each of the execution
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    with the corresponding
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    for the ordinary evaluator given in
    section&nbsp;<REF NAME="sec:separating-analysis"><a class="superscript" id="4.3.3-sec-link-4.1.7" href="./4.1.7.html">4.1.7</a></REF>.
  </p></div>

  
      <div class='permalink'>
        <a name='h3' class='permalink'></a><h2>
    
    Simple expressions
  </h2></div>

  <div class='permalink'>
<a name='p16' class='permalink'></a><p>
    The execution
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    for the simplest kinds of expressions are
    essentially the same as those for the ordinary evaluator, except for the
    need to manage the continuations.  The execution
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    simply succeed with the value of the expression, passing along the failure
    continuation that was passed to them.
    
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_90_6_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (analyze-self-evaluating exp)
  (lambda (env succeed fail)
    (succeed exp fail)))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_90_6_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=4&prgrm=PTAEGUEkGEAVQFLlAFgHQGZMChslAGYCuAdgMYAuAlgPYkDOhATjQLYQzxKpoCMaAJlzFy1OqCr0A+gBsqFAKZMAhjIAUZNgAc6CkhQCUoAN7ZQ50EwUUiTEhOkkirAEZKN23fqOgAPr7MLIItJKXoKJioSAHMPVh0SPUNzf0DgoNCXGhoZBWUSOISko1T04NCnGXVNeK9ki1KykOlSABMFAiiFVsK6gwBubABfbBFKWns5RRUZKQA3VSIFXsTvEyC0y2tbexqi-UGR0dJx8VCKZWjo7tlJCjVw1goAGlAKAAsFKQvoo1Mgqw2OwOKRaZRUJgPChPIwAMlhoE+yh6j2SAF4MW9Pt9LodhCcxPYKspWMs9n0TJtATsQT9rq1buEVklXgAiEgkhSsgbDY6iCagegAT1cOSkNAIUg5pOZa3+FmpwKRPQuVGqnlWhh5RzGhNArGUAGsvsp6PQqNESKT9FDIjFXgoAB5aKxmiZ-KnbYFyJms03my3Wiis17hO3RB3O13mujavmnInSf0Wq1JWXJeXmRWJnFXG4++7kzVs5OBpLcvG6gWl1P6MIirLq2qaj0Ar32ZVqVXqTvd9MGAdxqviGtB+aLL5Ol0KN10fuUttAjt5FXg9R9ovFAd4+N60LtMgyZQqQlQmELhXt2mXemM+6otmaBgXOsHo8nibcvwBJrNXO3gszxeUBWQWSJlBcXIpDfY9lEJL9UhGYd7Bgj86HrUV1FRVssyvXs1zUfC1SAwchwJAVULgiZxxkJYpCnaMJhIi8tiXREVy7Ai+2w7deV3AVQiPVxWmUeioxnGMCmwljs2vPMGUAh8QKElwRLE6dZxICteWQ0AVLUsEVFJaZ6GYzNZINLQHgbMUJSlTlXiIrDoS1Mj+XEfTRKyVohTMtJZKczjiJ4uN+LOaRszCC5FCDPzLzY84b3zO4gLZSLwjghQg20pDyPESKGIkpjpPMvCOO4lzeJ1PKcyfVp5AmVQ4vimlEvku9UpAuqGroVR1MYugEJ-X85IAlKlNZbrCT6jKYvLNyE1AKbGtmad6rITLmtYmkCykKwCE63gFr1ZbetmJ96AUABHJYbRK-yr12-bOoEY6BVOjlZlUaYOWoOZlnulrvTuPaOk6jBQt00JLpuvQyAByqZKvNqxqZCaYdu+GcrC+wDWNMJrsxhGnnoHDtuB30MbhrlQxc0nKxqwVCepqLMqDUySosB62MCniGfc+xOiYcJWbmu66bJgKONRemdMZ10KFFrKkg5iWkbYiqSbe8L6PiCghQJ2HyGJihSfV1rHCIKogNl3KBZBI8Rdm5Xxa183gQqK31wImWqvxe3MhkGgyENLbyZzOlkrRly2Ug4PDWx3S45DqRvN8wGgeXZEgucmFIcZ0JlC0LQ5A208M-D0ao-vGOQKLkuqDLz9tcFmr+qKucK6l7PNa1fnFuPaJ2801Xz1Knnyq4n3Kr9vAwGQxgCBYdgoDgRBkHQfgMH9xbziYJY1EdMnK8ybJcnyQ+jE2MoAH5QEdUAMTRN594UUBr-SAAuUAlBYSFHVjmfPI9gpwKEoN0V4Vh4ZUH+q0T+2Mcb6iNF8ZCahDKchMq8NODoSBzGPrJQCk1PBtCkMhEMH8RroOMkoegWCaA+RwXg-ue5pDkhIaggg+DkbSEjgpFKBBHzEJIAyMhLdCBtyodYGhahOEsUrk9MGAjQBHWYQKZCqd6G+VkZmeRINnpKNeqo8Q6i9BzAhHQWK2jPRsQUQdJREMdy6Txl8SKCxaJkjoIoOU1idopVZK4icIYlqeOKEYnMAT3FqDcUsLhCUeFJT4UyaJCg0rthoksRO8s0nJKkE+Lx9xkmxJpIFQp+d7ZwyDuaGI9FcHmNrPcUxRTgR9kaWEwgEIRZL05GoRpcju49FaXLcp5BKlfBcFooyKSf64L+BsRcNIwQQhkZMxhcYLoUCxJOPWBtTF1KDI-UAlQZCDEQc40hkzrKYVoaAZJZsdGyUWZCYUVzXi3LEV00kGFGymQ+QoWZXN5lKg4r895kz0kzmWZyf55gfHNIIiCxxjMnReIZLslg9TLnfNeaoa5LhTSThmX0x6ehogfExTkM2T89IkrJW40mFCgh30eWoM5vzyUyGuXSgwWD8U1LwQyiw39cgxDJc875RgAA81KRXvCiTigwArGU-yYH-NQrIAAq2QkEkCFKAQezgVaCiIMXOQ3Rv6slAAAanfiNW1YYojRCoAQdONkOVGGtUEi11rFV2oiA6p1vkuUKtteYb+v8aCQg1VqggCgADueqmDRANfoRg9BjUNzNSBK1NqQ1NHtTEAN7KzYerZNmn1I182OudXKt1ZTFpBxoIaY1XyxTJPZasuRulTGyGyFZXpOigi6XoBtKSrrOXyrkU0WSntrZiopcG3NwQ77dobVZcttqKk0CqUPNFFi0yNIXYuwVgpXWP0xJ2Odbr11NDvp2Ll16yjf2HRfbiY7uVvAIkGwYTQRhNCdaAHpuCz3Pw+FsrQ+s+V7OKJOso4anmurZAAVRIFkNohzOTaR-T-Dlb8B1lHWcwTkByhadIuYMkNsln0FF+S2jlkLSTcofb+Gjtz6N-J5D+zYv7M7TLmD2mgfaZmIvtjWWj4L203NUB2nRXbcH8cE3gmD5gh0jqLdit1SngjTstrOt9THl1ydXWoJjQRN3bsg+i2KB6mNPtPVSi9emj0WDvpdRWd6cXqcPUep9qnX1XPfX2L9DKhg5vSP+wDcxgObN1uBnZtTLPQbw+kODEnWTIdQ8I9DpJQAAFoct6rdGWfQmGyghYUDhzTQQCO-OIx0xWbLyO2so6pmjl6fmTMY05poLGJztahRx0rXHYUgMM72iLoV8AL2YGwDga9uCbzQCgHeLDQSRFYA1f6pCaoyNIJLbh-5q47ZIGyF0VB1t-S5GI0752YFfDOyXF20UmIiD2xPHu8LduhQI9djbKCaqMGfoBChhDlRBIsMqXNnX0iEO7GD8w3ZIfPGB34x5cPQCPMR8j30BY0cFkx2UQhM6ZBBKJyNKHwRCH1XoCXZQQoglU5p7q385OgiELg3DuDIaWcWEIQaD4UgIL0BDHz94AuXCMCaNz8whDLVo4sIfV4QojBogAHz32zUzqXek-E5bl+YBXoAlePzVw-fLmukcE78QAKj1wBgBhvlcm9AFbw35gteEOALbg3RvVfq7AObrH9xWQAFIvf259074PrvQDu78U-OX3vHfq6pUri30O-EAEIMQJ-D0nh+Wfn6p8D2qiVYfFd59AFK8wRfLe+glWiPXifjfq-r9X2PvoVdl4d83h+au29p4p34lXDfXjBCb773vz8HcD9Z5n236ugi+-MBniwR8KE8m+2t37W2Ba0YBwyyyhEVyvB+xdnfCZZab7O9v9RNAXAACswGm0fgfouR3m+ENP7doJgUXsDhn00F-ptgvDyNgFfjdptusvkM-oDilIQm0B0F0K0EEggZ0IkK0Frl1r+IQpACQGgfIHTqPrgfgfrJgVgbXkHiLlILAJAHDlQTQWQeQYPr6FQQAKJo5sGMFME85+IAByygvBtu-BvBXm3BZQG+dA4Q6OW+Z+UBdYbWL+TQh+BAzenYnCJ+Mht2uSkhL4psEhz40h1+shOh0B4K++Shb+Khvuv+-+hhEBXwchehJyuk9cMgBsQBf2AsR2rwg8BYTS9grhBsUQUgCBTAbhDqUg9+ygCww6kQ4GxmTmHhUg92uQQYVEc4L2ABtqvhdwAwwQfEQ62wWgFme6No-hP8joKKJRGKD69cegPQSR6ibWrwJmwQSRjhe+XBQQdRwiaCmhwBbcd+j+lA1yrRQQ7RJhdYbyWRv4oGMWEGu69SoUuQGycx0QQceKswix+yz8rmza2xaYoBk2-202K8nA68PAWA28iChcrg84xg6Qw2VciShYGoLIdcJqjc6RWkcICIPqxIMoJi4kmk-YvxoWearq4oko0oywQJGkkkoJUWforgrIbSJILguS7wNAjcEKm43igKARiapkeJhgwmA8n0QoAAXl8DCfcU8RFqGEQGQPDBAoQGuI7j6mmsyQoN0GoA2k2sUZeuJkKXZLSSSe+o0jMSGgQOyWSXqPkKoFSV8J5MPAieKXIt9rBNQsLAciqZIiZP2N+hYARmnLqeiWpGnIaZsCaSIAcgqW4dSWoGnANrhGxAyUatyayTKWqByXakySyT0KyttvqTQlgiIKslKbat6TIHWvKRSdSYbETDbMfIUUbNQKoG4WoMoFgsfASQBqYoyZ6a0K8NGUnmMcoO6WMfrqJMkiWWuK9MblWRkBFNkhOFmeCqIeQS5v6TyT0DWROHWWqK9E2cei4O6VyQGYOTIK9JGdKbKUNoOozEZiRvVqQJAjOKuQwLmTxkTmoArDvvSkenfCuTvg+kKmNlTPoFQBmVonVjvrOU5p2PuSIKTF0SNH2M+aQK+UaeYNxuYNVl+QcofvaUqbTFrD+SfDpuoC+VfLagZpFr7qgUgT6ueQJkftnDBa8H2DBbGdWPGV8JRKeOqTogRpegcoRdRJelaVVjoTcrac-CBY6RRehDkoVCCeKS6ZXOOT2V6eyc3tenMCIAyWMTWlOQ2b7klk5qJkKW2peupqshBeQZRjxT0EhegWJZxUekMA+d1vOdVCJvhQLoVhisRdabRWRQxcZWOFReKRBQRoJaQHafhVmVZUkOCqqUxBxRBbJNxUWVOb6WUA5QUAWeuqJWyUOUng8bmvgFbrwFbiZgRjkAyMkrqdkAKWJrJQhrxppSGtJZCZlZhPJdlYpRRleBOb2aJSOSNGoJFcEDFQIPFWIYunlZhMKQhlVU1SNEleCi0Z1X1bBkJh1aVWxNGQIDVSVf1UMDlaVjpeFTGXKXhYqQmR9E1MRY8TRQYVoPRXqs5StatFYOtJtF5WZQYWQNtYxR4sIj1J9NoQwMzDaMdRtVIcoOdbtXQPVNNF9DID9FRP9KCd5VeL5ZOXNQFb+FtaQMJU5vgOVWaMEleU4N8YQBGj-NElRDEOCSGvgKBtId0F8YoG8DQKAHfqqPYGtOCkxn0TcLWXNeJSrlWXvAfGTYUhjUeUtEJQWR6cDaNZ2Yut-C9RDRzeVbxRFbNRYJNmuLYG-HklEEQIjQQMjQoKjdQOjUxljZ8DjYdYoAAJBa1zJHqlkLXiBUbihECKzMUMB0kZAqFqDQz3XwyImSWkV0wHKXnwxKzszUVlDabzEGyu0myHmLp3xHJnl6rFz1EPAjom1m1gLvjfE-J3nOyxS+xvl2qR00Cm3QQx2wSEimRDUWBnJ+17kbnu0qzJmDgQVlYVaSXe3m39jlp3yATm20agnlrfxHIV0FFLkgx2SkA1i8kwl3JPGH5SDN6shW693GXdA26vAD24UjiGXJyhymVPUbKmnPyL0aI+Se3-m0VBwbQcou1p0Z3m2mTOl2W0UT0BjoEA7a4iw90ciT09B73yrn0GEuCvVLXLBn30mC0qX+WNm2rv0C2VH1HVGxTP0cqvCX0pjdDXKSlMZC3Fkg39C5qd0GWf2gxLgl0PVvH4nGm0VMAf0OnLAFTAlqm4N9w-24KFlc18Wq4+qEMC3UMU1uIaXN6IMsrIKYM7DiZuLvrc2i3KZ6XLYCjXCKyDymT80MCMI0O9n-1RV62ukWxShexZkwUMrdlFlqBHL+UMrfydhSOkyQ3cHQ09mw3S0I16jy1MBYiSB6oiAjlZmJpsP0P9ViMC5Ek5xqNfkp3cEhX9W-imPcnmOeIy1y0Rp52BNgBQK2Dmj-RLQZkE2gDuMSORNNBOPRDXLRkQwAMBN+laPMqDw+FEm+N5ODprgQyCNMECMjkG1oOLROhgKm0mifFNwZFrkJqZOyPC0xlEpxKrZGFaEcK7YaOc0VWBEDP2Hn6njhmdOkxVNCM+l6MghsLCLTPPa7Ys3mDHltyWkvYJG5rIqgMHE2itHqIhnCxHalPmASMLPiK74nP3B-6i1OmaKgxprfUuNq4mYcOhARIHxpzvNWzJBDV3z-MOEhI2iAuujAs81YHfxqUQJDU1OLqlnLMpazOsikCGgkA0Cxqtz2z6xaBvx5ZZqWpNmsiNNkDNMC6tPfEIIuGGWuF42eUUPHzVZENKlHYJgeVziPX4MGGGNAVv4XXFOZP-VUNzDdNIOlm5O5oEDs3MNMHeE02g3cEpOeOGO9VlMWD+M6vVlElTk5OuP6vBBUs0vMttPUZrlpO5q3NjM9OVO2vlMi1VkG3vz6XkkYPok9LOjsu0VnWAXPzAX4U+GuCYnYnwymRTi8R5lA1yMg3N6SW6QRAGyJCVEaBYk4mD3DXKNHKZuRszhws3pzU1U2bsTZxkBZtRsGDGM6uIN3OLo1XN6ptSjIpeNVuFuvnTWgB-laZXitvpuFgwUV2G0BFvXNiJZPGCTyBKCrVss+p3wXW3DTDzuTveACrfwAkeLruGCLs7UYNikLu-hbvSC13in7vLvnvHtNCntGVX2xQXtwUHvEP3spiPs3uPorPvXXVrv7B7vPvLt7V10nsOzmmiRsXkO7vFvbMvtKmyDge8sFBPu3sgiF0oe-hLuGWF1+3YOmwt2geBzxwgcjRYcYOL0kdft-NpKJ1pgYclvLvpTRSPaUdfwgg+v0e3xwcJkceftseFx0tEV8dcfLuWvfGsfBBhoqoRrphIYkA4t4v2DCj6DKCm75YXUMuMzomK1NRTgyMOsyt8UKMAo8YXW+taC1u-1+XIP1NWMJ05Cm1MRRBaCm3lHaduJoLHiXRqoPFeoSAkAucbIeq9vciNtrEbF9SPONthVDsC7fVKC-S3ZJ6sMiVJ6IsYFjt6pVBhAOc5020BeudyIrGCi5cTA33t1a2bBQz6AJd9RGbOem1YVMAGyXDggkDbnmDhYNcbJUqsitutdRBfiSVBD9fRBtfjXBbYaXSVYWDudNSGTeesi+fZrdfZoWpDChdMbhd36RfxalEvCq1gBzcyBjNmgsNSaHLIpxc-UXaRVVn0CleSEHLMqsMle0Q509u5sew1d2B1djZ9fNcC5jeDcz1XffS1e3cTW-jaWHd6quA6cnfRmS0U1pfCKIHoFMY9t9t9tRA-WzBGYPrdeCPNsSVjEM5Hi+Ssj4C4+1cnfs6ffpBTUA1sRWD-TCwAyPdbk7gAXZcLdKAHIWqmtHoAA6iCVgN0EIywFn6wQvi6oveZK+WgoAS7dxRg38AA5OAFRPQJ0N0FsBL1YOryg01aLyFrL0L6L04llG4JCLO6wK8EfDL+b+kPLzuVBZfM7yGq7+kEHV7J71gd75JxIDFFFp2I7-70EIHz7wvhHyL4qt-KSPD7bzFFhQREfHkbL6b7H3k6L8V6QHz60Acu3dn00Jb4zHz1ILGhGj0FX0wC8dCpn56Ab8sCvrufn1590NuM74H+L0QJLyytb+4J2O3+zxgan8RLX-X0YAXocl7Bn8EIH9VunWs5PwcsPwFx3xl-q4HyP5dIXyBgRLv538b57z349ClJ2JP3ePw8vwyJP-P9wVnyX31aL5vgoDoOaDnbqSlOr9OFoOr68HV7WMABoAdXhQBoAgDQBUQEAer3GQwDY08gd4OrzyJl97YFfP-lul-arR3gKgbzg336pn8bEP-P-jli0A4D8UkA0-kxgr6T9KaH-a6vMxz7UCO+UoZfqCHIF4CH+TAs3s-xN5gFaKuLINrfXuDq9BBJAGAeECIDtB9AMAl0BKAkgRoYBZcJQY7HoDIDjer-Wimz3Fzf8mQ6vbQRIJsD1QZwMA3IJQElpqDABeQU2BINyDv81BKA51hH00GCsmA1AQ8DOF0EiDjw7g3IDANAwwDlA6gzqqgMWgV9zQ8QKCGIPYG4Dlg+AgJoQN8R6CIhD2HLGINIEcCFAlAsplH1tQ0Dq+TjXwUW1Hw6tchlCFgbQLEHflG+PA3gY-0QQV9ohZA2Ic22M7m9A+TiWnG4DEgoptGbA5ofiniF8Cp0V4H1k0MyElD2hYxA0EKG6FHNeigEUQcvwyGxDshcvJweYHGGxDJhTBMof1XQFWB6Bn1GIfihqrl1I+XGOoeQUSHAgZhcwkBr0XCEpEaS-QzIWcJP7rDahVwgPg0JYGXQauxsVoSXxuGTAf+-wrxPDDWFUDEiLArYacPfSms9hgBFgdoJOGcCPh3A74fUN0gV9URAwvAU7275VdGYdwycA8J6B4jMhQwsQnsNkg+tKR2w-3kiJGikieh4dRYdoJWEUCdhuaZkU1QZH4oeRPwoXgcPf6YDjh+IuIecIsCB8hgOtLEQvyHpdCyRvQ-IXXyiRKBxcXfF-sMAVHXDfh7PZIgV3uDddqRiIzYEf337+dAuGI5-ov3MpJBnufwpINTHGpTC2wzfG2u70tHaiiReZcEbaO+FP89RTmVEiI3noYMpgc7JsP+3KLxsemSeDhlGJmDiZxS-lHcLYj5J6IwYmY3MdmIOgZkcu73Mrjtl54d8bG3qQXiGPWEV9uuWYvQQEMAGSDpBFAeAYgP8GfAlBcEKES72wDq96AdgrQJYKgHiDABjY0AYeH9DICuBOrTbnUIAAM1zcgjOUiYrisCa4poCoiAA')">function analyze_literal(component) {
    return (env, succeed, fail) => succeed(literal_value(component), fail);
}
</pre></div></div></td></tr></table>
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_90_7_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (analyze-variable exp)
  (lambda (env succeed fail)
    (succeed (lookup-variable-value exp env)
             fail)))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_90_7_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=4&prgrm=PTAEGUEkGEAVQFLlAFgHQGZMChslAGYCuAdgMYAuAlgPYkDOhATjQLYQzxKpoCMaAJlzFy1OqCr0A+gBsqFAKZMAhjIAUZNgAc6CkhQCUoAN7ZQ50EwUUiTEhOkkirAEZKN23fqOgAPr7MLIItJKXoKJioSAHMPVh0SPUNzf0DgoNCXGhoZBWUSOISko1T04NCnGXVNeK9ki1KykOlSABMFAiiFVsK6gwBubABfbBFKWns5RRUZKQA3VSIFXsTvEyC0y2tbexqi-UGR0dJx8VCKZWjo7tlJCjVw1goAGlAKAAsFKQvoo1Mgqw2OwOKRaZRUJgPChPIwAMlhoE+yh6j2SAF4MW9Pt9LodhCcxPYKspWMs9n0TJtATsQT9rq1buEVklXgAiEgkhSsgbDY6iCagegAT1cOSkNAIUg5pOZa3+FmpwKRPQuVGqnlWhh5RzGhNArGUAGsvsp6PQqNESKT9FDIjFXgoAB5aKxmiZ-KnbYFyJms03my3Wiis17hO3RB3O13mujavmnInSf0Wq1JWXJeXmRWJnFXG4++7kzVs5OBpLcvG6gWl1P6MIirLq2qaj0Ar32ZVqVXqTvd9MGAdxqviGtB+aLL5Ol0KN10fuUttAjt5FXg9R9ovFAd4+N60LtMgyZQqQlQmELhXt2mXemM+6otmaBgXOsHo8nibcvwBJrNXO3gszxeUBWQWSJlBcXIpDfY9lEJL9UhGYd7Bgj86HrUV1FRVssyvXs1zUfC1SAwchwJAVULgiZxxkJYpCnaMJhIi8tiXREVy7Ai+2w7deV3AVQiPVxWmUeioxnGMCmwljs2vPMGUAh8QKElwRLE6dZxICteWQ0AVLUsEVFJaZ6GYzNZINLQHgbMUJSlTlXiIrDoS1Mj+XEfTRKyVohTMtJZKczjiJ4uN+LOaRszCC5FCDPzLzY84b3zO4gLZSLwjghQg20pDyPESKGIkpjpPMvCOO4lzeJ1PKcyfVp5AmVQ4vimlEvku9UpAuqGroVR1MYugEJ-X85IAlKlNZbrCT6jKYvLNyE1AKbGtmad6rITLmtYmkCykKwCE63gFr1ZbetmJ96AUABHJYbRK-yr12-bOoEY6BVOjlZlUaYOWoOZlnulrvTuPaOk6jBQt00JLpuvQyAByqZKvNqxqZCaYdu+GcrC+wDWNMJrsxhGnnoHDtuB30MbhrlQxc0nKxqwVCepqLMqDUySosB62MCniGfc+xOiYcJWbmu66bJgKONRemdMZ10KFFrKkg5iWkbYiqSbe8L6PiCghQJ2HyGJihSfV1rHCIKogNl3KBZBI8Rdm5Xxa183gQqK31wImWqvxe3MhkGgyENLbyZzOlkrRly2Ug4PDWx3S45DqRvN8wGgeXZEgucmFIcZ0JlC0LQ5A208M-D0ao-vGOQKLkuqDLz9tcFmr+qKucK6l7PNa1fnFuPaJ2801Xz1Knnyq4n3Kr9vAwGQxgCBYdgoDgRBkHQfgMH9xbziYJY1EdMnK8ybJcnyQ+jE2MoAH5QEdUAMTRN594UUBr-SAAuUAlBYSFHVjmfPI9gpwKEoN0V4Vh4ZUH+q0T+2Mcb6iNF8ZCahDKchMq8NODoSBzGPrJQCk1PBtCkMhEMH8RroOMkoegWCaA+RwXg-ue5pDkhIaggg+DkbSEjgpFKBBHzEJIAyMhLdCBtyodYGhahOEsUrk9MGAjQBHWYQKZCqd6G+VkZmeRINnpKNeqo8Q6i9BzAhHQWK2jPRsQUQdJREMdy6Txl8SKCxaJkjoIoOU1idopVZK4icIYlqeOKEYnMAT3FqDcUsLhCUeFJT4UyaJCg0rthoksRO8s0nJKkE+Lx9xkmxJpIFQp+d7ZwyDuaGI9FcHmNrPcUxRTgR9kaWEwgEIRZL05GoRpcju49FaXLcp5BKlfBcFooyKSf64L+BsRcNIwQQhkZMxhcYLoUCxJOPWBtTF1KDI-UAlQZCDEQc40hkzrKYVoaAZJZsdGyUWZCYUVzXi3LEV00kGFGymQ+QoWZXN5lKg4r895kz0kzmWZyf55gfHNIIiCxxjMnReIZLslg9TLnfNeaoa5LhTSThmX0x6ehogfExTkM2T89IkrJW40mFCgh30eWoM5vzyUyGuXSgwWD8U1LwQyiw39cgxDJc875RgAA81KRXvCiTigwArGU-yYH-NQrIAAq2QkEkCFKAQezgVaCiIMXOQ3Rv6slAAAanfiNW1YYojRCoAQdONkOVGGtUEi11rFV2oiA6p1vkuUKtteYb+v8aCQg1VqggCgADueqmDRANfoRg9BjUNzNSBK1NqQ1NHtTEAN7KzYerZNmn1I182OudXKt1ZTFpBxoIaY1XyxTJPZasuRulTGyGyFZXpOigi6XoBtKSrrOXyrkU0WSntrZiopcG3NwQ77dobVZcttqKk0CqUPNFFi0yNIXYuwVgpXWP0xJ2Odbr11NDvp2Ll16yjf2HRfbiY7uVvAIkGwYTQRhNCdaAHpuCz3Pw+FsrQ+s+V7OKJOso4anmurZAAVRIFkNohzOTaR-T-Dlb8B1lHWcwTkByhadIuYMkNsln0FF+S2jlkLSTcofb+Gjtz6N-J5D+zYv7M7TLmD2mgfaZmIvtjWWj4L203NUB2nRXbcH8cE3gmD5gh0jqLdit1SngjTstrOt9THl1ydXWoJjQRN3bsg+i2KB6mNPtPVSi9emj0WDvpdRWd6cXqcPUep9qnX1XPfX2L9DKhg5vSP+wDcxgObN1uBnZtTLPQbw+kODEnWTIdQ8I9DpJQAAFoct6rdGWfQmGyghYUDhzTQQCO-OIx0xWbLyO2so6pmjl6fmTMY05poLGJztahRx0rXHYUgMM72iLoV8AL2YGwDga9uCbzQCgHeLDQSRFYA1f6pCaoyNIJLbh-5q47ZIGyF0VB1t-S5GI0752YFfDOyXF20UmIiD2xPHu8LduhQI9djbKCaqMGfoBChhDlRBIsMqXNnX0iEO7GD8w3ZIfPGB34x5cPQCPMR8j30BY0cFkx2UQhM6ZBBKJyNKHwRCH1XoCXZQQoglU5p7q385OgiELg3DuDIaWcWEIQaD4UgIL0BDHz94AuXCMCaNz8whDLVo4sIfV4QojBogAHz32zUzqXek-E5bl+YBXoAlePzVw-fLmukcE78QAKj1wBgBhvlcm9AFbw35gteEOALbg3RvVfq7AObrH9xWQAFIvf259074PrvQDu78U-OX3vHfq6pUri30O-EAEIMQJ-D0nh+Wfn6p8D2qiVYfFd59AFK8wRfLe+glWiPXifjfq-r9X2PvoVdl4d83h+au29p4p34lXDfXjBCb773vz8HcD9Z5n236ugi+-MBniwR8KE8m+2t37W2Ba0YBwyyyhEVyvB+xdnfCZZab7O9v9RNAXAACswGm0fgfouR3m+ENP7doJgUXsDhn00F-ptgvDyNgFfjdptusvkM-oDilIQm0B0F0K0EEggZ0IkK0Frl1r+IQpACQGgfIHTqPrgfgfrJgVgbXkHiLlILAJAHDlQTQWQeQYPr6FQQAKJo5sGMFME85+IAByygvBtu-BvBXm3BZQG+dA4Q6OW+Z+UBdYbWL+TQh+BAzenYnCJ+Mht2uSkhL4psEhz40h1+shOh0B4K++Shb+Khvuv+-+hhEBXwchehJyuk9cMgBsQBf2AsR2rwg8BYTS9grhBsUQUgCBTAbhDqUg9+ygCww6kQ4GxmTmHhUg92uQQYVEc4L2ABtqvhdwAwwQfEQ62wWgFme6No-hP8joKKJRGKD69cegPQSR6ibWrwJmwQSRjhe+XBQQdRwiaCmhwBbcd+j+lA1yrRQQ7RJhdYbyWRv4oGMWEGu69SoUuQGycx0QQceKswix+yz8rmza2xaYoBk2-202K8nA68PAWA28iChcrg84xg6Qw2VciShYGoLIdcJqjc6RWkcICIPqxIMoJi4kmk-YvxoWearq4oko0oywQJGkkkoJUWforgrIbSJILguS7wNAjcEKm43igKARiapkeJhgwmA8n0QoAAXl8FMEoE1CSeURFqGEQGQPDBAoQGuEnmmqyQoN0GoLSTMOJgya8AQJyWSXqPkKoFSTSeiWpIVCCQyXIt9rBNQsLAcp5KCCqVIsLP2N+hYARmnOqbKV5JorqZsAaSIAcpKW4dSWoGnANrhGxEyUajyeyaKWqI7j6tyWyT0KyttpIpgqAC4CIKsjMSGu6TIHWhKRSdSYbETDbMfIUUbNQKoG4WoMoFgsfASQBqYsya6a0CKZyc3mMcoM6WMfrqJMkoWWqK9MbuWRkBFNkhOOmeCqIeQS5iyT6S2VWRyTWW2Vgd-C4M6d6byQWb2TIK9GGbmhGQ6aANxspozEZiRvVqQJAjOCuQwFmTxkTmoArDvvSkenfMuTvg+kKmNlTPoFQKmVonVjvlOV1p2HuSIKTF0SNH2E+aQC+XqeYPOcEgYc+QcoftadKbTFrN+SfDpuoM+VfLagZpFr7qgUgT6meQJkftnNBa8H2NBVGdWDGV8JRKeIqTogRpegcgRdRJemaVVjoTcpac-MBbaeRehDkvKQiQybObJMOZ2aOdWZGcWYunMCIEyWMTWrxbWb7klk5qJpeuJpeupqsuBeQZRtxXyYhegWJbOUekMPecxmKQUYzAxSaIVhikReaTRaRfRcZWOJRQyeBQRoJaQFaXhemVZUkOCsPGxW8d4BxVeFxfmbxZ6U0A5QULmeuqJeOeJWrg8bmvgFbrwFbiZgRjkAyMkuqdkE2sUTJW2nJbxppSGtJZCdlQhpJjIApSZspfmaJfWbamoEntFRYLFQIAlWIYugVZhLJQhtVS1basleCi0d1QNbBkJl1bmrJBGQILVYpYNXOXlaVjpcpnpdVCJnhdocIj1J9PcY8dRQYVoHRXqs5R9H1GtF8YoKCXZTRWQHtYZR4GtdNOdJIczDaOxedQYcoFdQdXQPVHdQLjID9FRP9GdU8X5T6QFXWbartaQMJU5vgCOWaH+dQE4N8YQBGj-NElRDEOCSGvgKBtId0CdW-BQDQKAHfqqPYGtOCkxn0TcD2eNYFeQXvAfOTYUpjYeUtEJbmS6SDRFf2bmt-G9ZDRzSOW6WuJOUxpNmuLYG-HklEEQEjQQCjQoGjQjdECzSNNjZ8LjetJlAAJDa1zJHoznikChUbihECKxMUMD3GbDhbQyPXwyImSUkV0wHIXnwxKzsxUVlDabzEGyu0mwHmLp3xHKnl6rFz1EPAjqm3m1gLvjfE-K3nOyxS+yvl2qR00Bm3QQx2wSEimQjVBBnJ+27nrnu0qwJmDjgVlYVaSXe0W39jlp3yAQW20agnlrfxHIV36X2y7R2SkA1h8kwl3JPGH5SDN6shW693GXdA26vAD04UjgrXJyhymXbVSGGnPyL0aI+Se3mAEZBwbQcou1p0Z0W2mT2kvVSET0BjoEA7a4iw90ciT09B73yrn0bLBmOX0XOVn1A2C0qVjkzlg0jTv0hWVH1HVGxTP0cqvCX0pjdDXKNLzVBBC3-1im5qd3klSmxnpTRSPZW0r0bJMDvWYPLAFTAmeXNhbjgWcW-3+Xjl02-iEMC24KIPy5uIaXN7IMsrIKgxLjiZuLvq00sMLUelG3iDXCKyDymT80MCMJ5lc0AP1UArbmQXpnQUModmVVHIBUMrfydjSOkxQ3cEw3cVw3S2I16jy1MBYiSB6oiDVXpmJrsOq552gDiMC5Ek5yqOfkp3cGhXTVNDGM8mmOeIy1y0RouO-j4BQK2Dmj-RLSplvBE1uOSMRNNAOPRDXIRkQyAP+O-icPMqDw+FEk+O5MWBZMlPkGCPVWG3oN6hOhgJm0mifFNwZGrkJoZNyM8V0NEpxKrZGFaEcK7bqOc2jnpkmruH9GeEJjeHtOkxCNlOck6MghsLCLn6ngvaq2gBHltxpxHYGAJG5rIpgMHE2itHqIBnSKZGtGSPzMLm74nP3B-4sN2maKgxpq-VONq4macOhARIHxpxvNWzJB513x-MOEhI2gAuuhAs81dbfxqUQJ51VOLozlLMpYhkgSkCGgkA0Cxqtz2z6xaBvx5ZZqWr1msj1NkCNMC7NPfEIIuErWuEnVMTL36k0UEBEM2mwltysUsteV9xmWvUAXPxAV4VFMZOA3ZnA1dMAPOMG3s3MPlkzO005PcHJMeP6P9WlPmB+PasAY3PjnZNyt6umaOgNOKA0sNwtPUarmpO5oGvIO8UQy3NObIuVOoO1O4XEMC53FTjHwEaXWfmAVv6GU+GuCYnYnwymR+s+VOk0PyNFkSUMq6QRAGyJCVEaBYk4mD0Ub7ZHKZuRsziwu3zjm1U2bsTZxkBZtRv7O6ulOOt2vy5J6ptSjIqeNVuFsvmzVzkMqyQtvpuFjQUV2iMBEfUUP4nKO3DTD0n8vFtbP7XesCkzvjuGACrfwAkeIrtzt3yGX2QygMlrsgi10HuwULtcuZ2HjZ18tbuHuFyuVPWzs+o7uMv3uvE3u-jrusKfXrXLv7Crunu7uHVNh-uwufuyDGkeXXsgdPtnvSngfCSiS8tzgntNBgeF0oe-jPveuF1+0l0pot0fsgiL110AcL171L2PuEe-NpKJ1pgYc3qwdYM0c4OxT0fBBgfokkcjRYfnucdsdBAce0uEWUfceMdNNWvfFcePrKqqoklIYkDYu4v2DCj6DKCm75aGX0sGWuCK1NRTiyMjPC0enrD5HZnXV+vStGeRkjvtLCyKz0A5Bm1MRRBaBm3lHom6fqCGSXRqoPFeoSAkCucbIepzncguvRbrF359QPPhfhUDs-V-UXZJ5sMiVJ4IsYE2eplhCOc51qAududyIrGCg5cTA33t3a2bBQz6BKCfTyZ5eBdm2YVMAGyXDggkBbnmA20NcbJUqsgtutdRBfiSVBD9fRBteTXBbYaXSVYWAeduJoLHg+esh+fZr5fBdZpDBhdMZrEbHRfxalEvBi1gBzeqAjNmiU1sOHLIoJc1f-V-LN7Dd2oleSEHLMqXcOe0Q53du5sJTVd2B9RGZ9fNcC5jeDcz3XffS3dJdTUjTaVHd6o6duLjmS2U1pfCKIHoFMbdu-m-lRB-WzBGYPprdCO1UPdjEM5Hi+Ssj4B4+3cyAycRola5pDCxs0hWD-TCwAzPebk7jVZeyamc9WPPwWomuLoAA6iCVgN0EIywWg0KovtqEv2ZK+Wg87nHRg38AA5OAFRPQJ0N0FsNL1YJr-0N1RLyFgr3qxL04llG4JCPIFlK8EfCZ5b8EEr5O-m8767yNO7+kEHV7N711r7+xxIDFFFp2F74H+YMH37wvlH+L4qt-KSDp-bzFJhQREfHkaL+b-H9NRL0V6QN5wb8-O3bn2UNb4zEX1ILGhGj0DX0wC8fLya8H1L0QDL2oCvjuYX4t90NuJby34TO38n3b2hT0N35zxgen8RPX430YAXocl7Fn274K1IfLSQjPwcp2OP5dBl9q8H9v8Xx+sRAf7v97wPzYilJ2DP3eAI+naszP0v9wTn2X2b2ATRdODoOaDneqSlJrx-5r68E16WMABoATXoTRAGgCogIAzXuMmgGxp5A7wTXnkQr72wq+H-LdD+1WjvAVAPnJvgNXP6+ImQf-KwFoByxaBsB+KCAa7xj7g0e+1fWvlTU-7rU5m-jGgZQjoE4tSAoICgbgMf6sDhgL-V-gRk4EMAf+RAkQdAPCBEB2g+gaAS6AlASQI00AsuMoMdj0AkBpvUABL3spKBxcYg+4Jrw54uBJBNgeqDOGgG5BKAktdQYALyCmxJBuQBQFoHUHIDG2gfbQTRWPDUBDwM4fQWoE15eDG4uQaAaBmgHKANBr-XSFX3NDxAoIIg7gTgOWB4DBqBAimAYJiEPYcsIgsgTwIUBUDcmbA38FXxn4ONvBuQFgXvyYzFCGBIgr8tnwEGCCxCKAxaFX3iHkDEhpPRRgr2D5OJacbgMSCijUBtDchyQpob2yvCcdhhiQ0fP3zGIGghQ-Qo5r0UAia9sh7QygTMKPSFCBqUw-FJsKYLbDuqaAkgRgO+rrDeBffCwMHwt6NCnMqQ3GH0MnCgNei0QlIl8F2G8DNBWwhobcPILNC9Q0QpINTE6G597ht9dIUCONj5Cz+VQjgXfwSH4paq+w-gYkToFGCERnwq3j8N+FB9EEVfdEecKSEu9Zhg6RmPMMWHPCegBIkYcSPwHjC2InHakdMJhHkFyRTwwYSsKME5DEh0I3NIcJapMi9hr-E1scKcGnCVoGIpIeXSCDXDdaOImUUPUeEDDw61QhvlEl0F1C6RNw+Ud8KiF0C1u9XILqMKxFBAT+ByNbl8MEHB8SKSQV7nQMujVdjYk1boZ6CN7LAu+gXHvhgT4HN8niDoigJaJxHP8dRR6VEsti9bnsYSeDHjJZxQbGdjWeTP+vyXSrNosqzZGSnZCjHClcq4XGpkcFsT8k9EYMAsSWKLEHQsuH3JzpIR2xVABel0Kxt6hF4hi+R2AKvgaJWGhDABUgmQRQDgEICQhnwZQXBF5HpAJemvegI4OcHQCoBgAzsaAMvZmgkBPo3Jlt0EEAAGCpuQVFrTVtxXWXcWUBURAA')">function analyze_name(component) {
    return (env, succeed, fail) =>
           succeed(lookup_symbol_value(symbol_of_name(component), env),
                   fail);
}
</pre></div></div></td></tr></table>
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_90_8_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (analyze-lambda exp)
  (let ((vars (lambda-parameters exp))
        (bproc (analyze-sequence (lambda-body exp))))
    (lambda (env succeed fail)
      (succeed (make-procedure vars bproc env)
               fail))))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_90_8_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=4&prgrm=PTAEGUEkGEAVQFLlAFgHQGZMChslAGYCuAdgMYAuAlgPYkDOhATjQLYQzxKpoCMaAJlzFy1OqCr0A+gBsqFAKZMAhjIAUZNgAc6CkhQCUoAN7ZQ50EwUUiTEhOkkirAEZKN23fqOgAPr7MLIItJKXoKJioSAHMPVh0SPUNzf0DgoNCXGhoZBWUSOISko1T04NCnGXVNeK9ki1KykOlSABMFAiiFVsK6gwBubABfbBFKWns5RRUZKQA3VSIFXsTvEyC0y2tbexqi-UGR0dJx8VCKZWjo7tlJCjVw1goAGlAKAAsFKQvoo1Mgqw2OwOKRaZRUJgPChPIwAMlhoE+yh6j2SAF4MW9Pt9LodhCcxPYKspWMs9n0TJtATsQT9rq1buEVklXgAiEgkhSsgbDY6iCagegAT1cOSkNAIUg5pOZa3+FmpwKRPQuVGqnlWhh5RzGhNArGUAGsvsp6PQqNESKT9FDIjFXgoAB5aKxmiZ-KnbYFyJms03my3Wiis17hO3RB3O13mujavmnInSf0Wq1JWXJeXmRWJnFXG4++7kzVs5OBpLcvG6gWl1P6MIirLq2qaj0Ar32ZVqVXqTvd9MGAdxqviGtB+aLL5Ol0KN10fuUttAjt5FXg9R9ovFAd4+N60LtMgyZQqQlQmELhXt2mXemM+6otmaBgXOsHo8nibcvwBJrNXO3gszxeUBWQWSJlBcXIpDfY9lEJL9UhGYd7Bgj86HrUV1FRVssyvXs1zUfC1SAwchwJAVULgiZxxkJYpCnaMJhIi8tiXREVy7Ai+2w7deV3AVQiPVxWmUeioxnGMCmwljs2vPMGUAh8QKElwRLE6dZxICteWQ0AVLUsEVFJaZ6GYzNZINLQHgbMUJSlTlXiIrDoS1Mj+XEfTRKyVohTMtJZKczjiJ4uN+LOaRszCC5FCDPzLzY84b3zO4gLZSLwjghQg20pDyPESKGIkpjpPMvCOO4lzeJ1PKcyfVp5AmVQ4vimlEvku9UpAuqGroVR1MYugEJ-X85IAlKlNZbrCT6jKYvLNyE1AKbGtmad6rITLmtYmkCykKwCE63gFr1ZbetmJ96AUABHJYbRK-yr12-bOoEY6BVOjlZlUaYOWoOZlnulrvTuPaOk6jBQt00JLpuvQyAByqZKvNqxqZCaYdu+GcrC+wDWNMJrsxhGnnoHDtuB30MbhrlQxc0nKxqwVCepqLMqDUySosB62MCniGfc+xOiYcJWbmu66bJgKONRemdMZ10KFFrKkg5iWkbYiqSbe8L6PiCghQJ2HyGJihSfV1rHCIKogNl3KBZBI8Rdm5Xxa183gQqK31wImWqvxe3MhkGgyENLbyZzOlkrRly2Ug4PDWx3S45DqRvN8wGgeXZEgucmFIcZ0JlC0LQ5A208M-D0ao-vGOQKLkuqDLz9tcFmr+qKucK6l7PNa1fnFuPaJ2801Xz1Knnyq4n3Kr9vAwGQxgCBYdgoDgRBkHQfgMH9xbziYJY1EdMnK8ybJcnyQ+jE2MoAH5QEdUAMTRN594UUBr-SAAuUAlBYSFHVjmfPI9gpwKEoN0V4Vh4ZUH+q0T+2Mcb6iNF8ZCahDKchMq8NODoSBzGPrJQCk1PBtCkMhEMH8RroOMkoegWCaA+RwXg-ue5pDkhIaggg+DkbSEjgpFKBBHzEJIAyMhLdCBtyodYGhahOEsUrk9MGAjQBHWYQKZCqd6G+VkZmeRINnpKNeqo8Q6i9BzAhHQWK2jPRsQUQdJREMdy6Txl8SKCxaJkjoIoOU1idopVZK4icIYlqeOKEYnMAT3FqDcUsLhCUeFJT4UyaJCg0rthoksRO8s0nJKkE+Lx9xkmxJpIFQp+d7ZwyDuaGI9FcHmNrPcUxRTgR9kaWEwgEIRZL05GoRpcju49FaXLcp5BKlfBcFooyKSf64L+BsRcNIwQQhkZMxhcYLoUCxJOPWBtTF1KDI-UAlQZCDEQc40hkzrKYVoaAZJZsdGyUWZCYUVzXi3LEV00kGFGymQ+QoWZXN5lKg4r895kz0kzmWZyf55gfHNIIiCxxjMnReIZLslg9TLnfNeaoa5LhTSThmX0x6ehogfExTkM2T89IkrJW40mFCgh30eWoM5vzyUyGuXSgwWD8U1LwQyiw39cgxDJc875RgAA81KRXvCiTigwArGU-yYH-NQrIAAq2QkEkCFKAQezgVaCiIMXOQ3Rv6slAAAanfiNW1YYojRCoAQdONkOVGGtUEi11rFV2oiA6p1vkuUKtteYb+v8aCQg1VqggCgADueqmDRANfoRg9BjUNzNSBK1NqQ1NHtTEAN7KzYerZNmn1I182OudXKt1ZTFpBxoIaY1XyxTJPZasuRulTGyGyFZXpOigi6XoBtKSrrOXyrkU0WSntrZiopcG3NwQ77dobVZcttqKk0CqUPNFFi0yNIXYuwVgpXWP0xJ2Odbr11NDvp2Ll16yjf2HRfbiY7uVvAIkGwYTQRhNCdaAHpuCz3Pw+FsrQ+s+V7OKJOso4anmurZAAVRIFkNohzOTaR-T-Dlb8B1lHWcwTkByhadIuYMkNsln0FF+S2jlkLSTcofb+Gjtz6N-J5D+zYv7M7TLmD2mgfaZmIvtjWWj4L203NUB2nRXbcH8cE3gmD5gh0jqLdit1SngjTstrOt9THl1ydXWoJjQRN3bsg+i2KB6mNPtPVSi9emj0WDvpdRWd6cXqcPUep9qnX1XPfX2L9DKhg5vSP+wDcxgObN1uBnZtTLPQbw+kODEnWTIdQ8I9DpJQAAFoct6rdGWfQmGyghYUDhzTQQCO-OIx0xWbLyO2so6pmjl6fmTMY05poLGJztahRx0rXHYUgMM72iLoV8AL2YGwDga9uCbzQCgHeLDQSRFYA1f6pCaoyNIJLbh-5q47ZIGyF0VB1t-S5GI0752YFfDOyXF20UmIiD2xPHu8LduhQI9djbKCaqMGfoBChhDlRBIsMqXNnX0iEO7GD8w3ZIfPGB34x5cPQCPMR8j30BY0cFkx2UQhM6ZBBKJyNKHwRCH1XoCXZQQoglU5p7q385OgiELg3DuDIaWcWEIQaD4UgIL0BDHz94AuXCMCaNz8whDLVo4sIfV4QojBogAHz32zUzqXek-E5bl+YBXoAlePzVw-fLmukcE78QAKj1wBgBhvlcm9AFbw35gteEOALbg3RvVfq7AObrH9xWQAFIvf259074PrvQDu78U-OX3vHfq6pUri30O-EAEIMQJ-D0nh+Wfn6p8D2qiVYfFd59AFK8wRfLe+glWiPXifjfq-r9X2PvoVdl4d83h+au29p4p34lXDfXjBCb773vz8HcD9Z5n236ugi+-MBniwR8KE8m+2t37W2Ba0YBwyyyhEVyvB+xdnfCZZab7O9v9RNAXAACswGm0fgfouR3m+ENP7doJgUXsDhn00F-ptgvDyNgFfjdptusvkM-oDilIQm0B0F0K0EEggZ0IkK0Frl1r+IQpACQGgfIHTqPrgfgfrJgVgbXkHiLlILAJAHDlQTQWQeQYPr6FQQAKJo5sGMFME85+IAByygvBtu-BvBXm3BZQG+dA4Q6OW+Z+UBdYbWL+TQh+BAzenYnCJ+Mht2uSkhL4psEhz40h1+shOh0B4K++Shb+Khvuv+-+hhEBXwchehJyuk9cMgBsQBf2AsR2rwg8BYTS9grhBsUQUgCBTAbhDqUg9+ygCww6kQ4GxmTmHhUg92uQQYVEc4L2ABtqvhdwAwwQfEQ62wWgFme6No-hP8joKKJRGKD69cegPQSR6ibWrwJmwQSRjhe+XBQQdRwiaCmhwBbcd+j+lA1yrRQQ7RJhdYbyWRv4oGMWEGu69SoUuQGycx0QQceKswix+yz8rmza2xaYoBk2-202K8nA68PAWA28iChcrg84xg6Qw2VciShYGoLIdcJqjc6RWkcICIPqxIMoJi4kmk-YvxoWearq4oko0oywQJGkkkoJUWforgrIbSJILguS7wNAjcEKm43igKARiapkeJhgwmA8n0QoAAXl8FMEoE1CSeURFqGEQGQPDBAoQGuEnmmqyQoN0GoLSTMOJgya8AQJyWSXqPkKoFSV8DCfcU8UyUajyeyaKWqI7j6tyWyT0A2k2sUZeuJnqXZLKcKbxl0WUCqTIHWhKRSdSYbETDbMfIUUbNQKoG4WoMoFgsfASQBqYsyUqa0CKZyc3mMcoAqWMfrqJMkgGWqK9MbmGRkBFNkhOG6eCqIeQS5iyZqcmZGRydGamVgd-C4AqRqbyf6TmTIK9DMYuuaQNuYNxspozEZiRvVqQJAjOM2QwJ6TxkTmoArDvvSkenfE2Tvg+kKmNlTPoFQC6VonVjvpWVgZ2L2SIKTKabMQRIuaQMud+hYHWcEgYUuQcofpKW4dSbTFrFubhHElKF7EdmbD6gZpFr7qgUgT6qOQJkftnEuQFh9h2ZadWNaV8JRKeAyXIgRpegcoBdRJev2OebuVIXMCIAckedKWoBBehDkoVCCQyTWZXEWRmSWVGRaUGYuvBaQEyWMTWgRTGb7klk5qJnqW2peupqsjBeQZRnhXyU+egZRdhUekMHOSNNWeKX+VKTaaOGmMBToqBXZgVgGPUrRtBZsARiRfYM-EhdSW6YVnJehcCQiVhTBbJLhX6QRWqU0MpWRbmhRWWVRWrg8bmvgFbrwFbiZgRjkAyMkgctqc2vRUmYxSaSxSGnRZCQxQhpJjIMxSZmxX6RRXGbamoEnrZRYPZQIE5WIYuoFZhPqQhjFalbaq5eCi0TlYVbBkJtlbmrJOaQIHFf5UVUMDxT+vxRYIJQUYzGpQ4XQPVNNE2PsBmI8VVjoejghapf+R4MIj1J9Ktt0F8YoKCTBQRmQINXqsNR9H1BdMzDaHpYpf1coAta1SNR1StALjID9FRP9DNfKT6YqZqcZbGbaloCIOZUevgMWWaLudQE4N8YQBGj-NElRDEOCSGvgKBtIZNWXG-BQDQKAHfqqPYGtOCkxn0TcNmRVSZeQXvAfLDYUv9QOUtPdRdcWcqWuK9GGd-NtaRXjexaWcjQ1cEJNmuLYG-HklEEQB9QQF9QoD9W9dEFjSNIDZ8MDetJlAAJCC1zJHpNXVT2xUbihECKyoUMBykZAqFqDQxrXwyIk0WgV0wHLjnwxKzswKVTr7ZZSxa2nUz2kPp3xHIjl6rFz1EPAjrS2y1gLvjfE-IznOyxS+wrkVoO00Ay3QTO2wSEimSlVBBnI63LC9ke0qz2mDgwVlYVY0XaYB2HhB1MQMnlp3yARy3yVYXlrfxHLx3NX2y7R2SkA1h8kwl3JPGH5SDN6shW7l2aXdA26vBV2-kjj-mpxBwhwK0WAEZpwHLJyGgaI+QG3939U904ra2+3+1y2mRpzYUEZN2yXdAA7a4ixl0cjN1anBzyqzX9UuA7XDWL36VXiGVXVlko2-hH1k2VH1HVGxRT0cqvAr0phr2rLU1BD42U1im5rF3kkiUuJpLR3rVvH4kT0GFMDH1AM9lpIYW6XgN9znW4K+mX3Vk3UjTQNk2oPw1uLcXN4-0srIKgxLjiZuLvpU1Mbi3LYCjXCKyDymSk0MCMJoP4VX3rD5FendnMP9m3yXUllqBHLGUMrfydi8MGAPVMFPV4UvWM3vV6is1MBYiSB6oiAxVumJoEOq6h2gD0MC5Ek5xumflf1iE+m6O-gyM8lyOeJM0s0RoWNND4BQK2Dmj-RLQulvAQ36OMOONlCaPRDXLmkQyYNFV2oU1oLgiQiDw+FEne1hPBDBPxPkFUNiE0OIJOhgIy0mifFNwZEtkJqBNsME2qlEqXmNHbYvYMrplRWBGrZGFaEcIFOMPJNX2iMghsLCLn6ngvbc2gCDltxpxHaSPXrIoP0HE2itHqKSImTDOmPdFEnzONVtwTP3B-6mNqBpygxppHXaNq4mZEOhARIHxbOuhWzJCh13zHNtX6BpinMzjnN5n5mgCcUQKh2pO5rVntMpYiBsikCGgkA0Cxqtz2z6xaBvx5ZZqWpxmsiZNkDZMC65PfEIIuFd2uFTXp1IPHzVYwPHmwkrM6WYvNhbgH0GG8MHlv6tWxOBNnVekX3sMYM6Ni2424NMHeFWXX3cE+OGO8MFUJOmasv8vy6MMEUhNMtCvJaOhZOKCIsNx5PUYtl+MBWLMCMlMyAQxLNdYfNYGCXvwS2AN4sC53FTjYv9XzUbkUtWRUt6quCYnYnwymQmvYUGXk1GUcPUUMq6QRAGyJCVEaBYk4nV0Ub7ZHL+v2szhPM3pllxU2bsTZxkABsOuSPmMSuqv+lKv65J7etSjIpGMJvhvLl1W1kMqyTZu+uFifnx1CWd2wMSVPGCTyB0ldV9B3mLVAO3DTD0lYsCrfwAkeLEveCtutX2QygZ2-i9vSBy39hDtd1TtjtNATsC6aWxTzu-h3zDtiVgMDuGA9sdPtVjVdvbuRvmDrtd3LXNsti7uCTolqQINEvdXHv9NtuGueTDyINHtXvSAR3Tu2qnvtvfsR160x153jsgjD0-sjR-uGvgertfwgjpTRSPYQdrvPvSmkM7BAdbsPuftGuFmwf8Mbt3H4dBCLvovyvIdRsbtItAXdugcpYklIYkAAtAv2DCj6DKCm75atUostWuDs1NRTisNpvXUJUAo8a7Umv0tqsd2Czu05Ay1MRRBaAy3lHon8fqCGSXRqoPFeoSAkDKcbIeqgBDDciavw7YjrF359SrNmcAb4OHLIqHXHUXZJ74PkVJ6vMYHVsBFVBhDyfB3K36cqdyIrGCj+cTDr2F2C2bBQy3N2B9RGZKcy2vDZuXDggkCdnmDhZJcbJUqsipfRDpdfg0VBAFfpdVXBbYaXSVYWBqduKRPCzLCsg6fZo5fZoWomfxNrEbHWfxalEvBMb4B1eqACNmh4NSYOeVFOdKC-S3bxVhn0DheSEHLMr2eLe0TB1FtlXIxxfjVGb5dMAGxpdRBBLlvTfxcufVW-h8WDdgDDcyBln03w0efCKIHoFMZbc7k7lRDHWzBGYPo5fzNxXN4lcjQM5Hi+Ssj4A-czcjfs5belbOtXhWD-SNcPBLcdk7jVZeygjHiXTKPPwWqptHoAA6iCVgN0EIywWg0KxPIaZPXpK+WgT76JwP38AA5OAFRPQJ0N0FsJT1YOz-0DlWTyFnT8T2T04llG4JCI26wK8EfJw+L+kAz12TpuoIr8r7aqr+kJbV7Fr1gTr8EL2zFFFp2JrwbxYEb7rwvpb6T4qt-KSHx7LzFClwREfHkXT6L3bwk2T6F6QJp3z8-IXT700JL4zIH1ILGhGj0NH0wC8bTxL56AL8sCvt2QH3j90NuMr0bxT0QFTyytL+4J2Bn41xgW78RHHwn0YAXocl7J78EEb9Vn7V01XwciX-p5n15xK0b6X5dK0Acn2H31n8Lwb7n49ClJ2FX3eJQy3wyFXw39wd76H4VWT5vgoDoOaMHR5SlOz9OFoOz68Oz0o4f6AOz+Daf2f1EKf+z+Mjf7GvIO8Oz3keH-bJH-v1uge6tO8CoFp4n6v08UAh78rAWgHLFoB-74pL+Wva3rdUz5R8Y+CNTfmNVJij4iqMAyhHAMBakBQQEAv-ov197DAV+AAgjFgIYA78mQ7PUgTf3CBEB2g+gG-i6AlASQI0N-MuKwMdj0Bn+o-Nfv1VR7i5yB9wdnnwOoE2B6oM4G-rkEoD01OBR-PIKbGoG5AN+nAl-hmzH5gEtqTAagIeBnACC1A7PY8FoNyA39QMN-ZQFwJF6IJI+5oeIFBFIE4Df+ywf-mgMAG79rBD2HLKQLAG4CFAUA-lugN-CR8q+mjQwRG1QF+CmMgQhAaQM3Je9CBRA1Kq-0WiR87B4AhwcD1E7i8jeTiWnG4DEgoohGLfewfiicFiF-BskVnikO8FhDYh5BA0EKFyFjNeiQAzwakMgHVDc0-gwqpUIcHtDDeqg9HHAI-5b8DqrQvAdnyt5cZ4h5BcfmxDqEND76vRKwSkRlKFDRhjg-AfTziFTCmCiQvUFYKSBm0ShNQnjEAMui3NjYvgtQYkUwGrDvBcVXoc4OuGNd5gSgDEmsLiobDnBYvbYdMMsFwC+BRQv-krxz4xdGYcwycAsJ6AAi1hRwnYSWyvCs9oRVQq4VgXBF5C7aQAvgV4IcGXCOh-QpET0IsHE93+IAz-p1UBHrDxh5gI3kMGFo-DG+NdHIRCPyGRD4+USV4TEIAHfD6RTmXYQKEj45dAuBnWEUK176d8y+ByHLqPymFN9+qZw3LgMOeHyjDh0o1NuPxT7K11eagYfhgU+E98ni8o1UfSOX48inMqJWhjWxfY3tRId7OcHWz6oGEZmNCDytaNx6TJZmDJUllIUHqA5XRQzT0ZtQMK30VKqHdSqfRQZzBimv9UpuK1-BENWU22J0cLCwS-MTStndJrYn5J6IwYmY3MdmIOguk-OG3CLjtl86B9lG3qInqaMXRk8BRQXe4EAJMFH8aBdAigPf0f7GDPgrAuCLiJV7YB2e9ARQVoBkFX8SAnYnwUf1Tpmhn+eosJqZ36EhoAADK0ywIVkLGa41cWQRURAA')">function analyze_lambda_expression(component) {
    const parameters = lambda_parameters(component);
    const body = lambda_body(component);
    const bfun = analyze(body);
    return (env, succeed, fail) =>
           succeed(make_function(parameters, bfun, env),
                   fail);
}
</pre></div></div></td></tr></table>
  </p></div>

  <div class='permalink'>
<a name='p17' class='permalink'></a><p>
    
    Notice that looking up a
    
      <span style="color:green">variable</span>
      <span style="color:blue">name</span>
    
    always <QUOTE>succeeds.</QUOTE>  If
    
      <span style="color:green">
	<kbd>lookup\?variable\?value</kbd>
      </span>
      <span style="color:blue">
	<kbd>lookup_name_value</kbd>
      </span>
    
    fails to find the
    
      <span style="color:green">variable,</span>
      <span style="color:blue">name,</span>
    
    it signals an
    error, as usual.  Such a <QUOTE>failure</QUOTE> indicates a program
    bug—a reference to an unbound
    
      <span style="color:green">variable;</span>
      <span style="color:blue">name;</span>
    
    it is not an indication
    that we should try another nondeterministic choice instead of the one that
    is currently being tried.
  </p></div>

  
      <div class='permalink'>
        <a name='h4' class='permalink'></a><h2>
    
    Conditionals and sequences
  </h2></div>

  <div class='permalink'>
<a name='p18' class='permalink'></a><p>
    Conditionals are also handled in a similar way as in the ordinary
    evaluator.  The execution
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    generated by
    
      <span style="color:green">
	<kbd>analyze-if</kbd>
      </span>
      <span style="color:blue">
	<kbd>analyze_conditional</kbd>
      </span>
    
    invokes the predicate execution
    
      <span style="color:green">procedure
      <kbd>pproc</kbd>
      </span>
      <span style="color:blue">function
      <kbd>pfun</kbd>
      </span>
    
    with a success continuation that checks whether the predicate value is true
    and goes on to execute either the consequent or the alternative.  If the
    execution of
    
      <span style="color:green">
	<kbd>pproc</kbd>
      </span>
      <span style="color:blue">
	<kbd>pfun</kbd>
      </span>
    
    fails, the original failure continuation for
    the
    
      <span style="color:green">
	<kbd>if</kbd>
      </span>
      <span style="color:blue">
	conditional
      </span>
    
    expression is called.
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_90_9_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (analyze-if exp)
  (let ((pproc (analyze (if-predicate exp)))
        (cproc (analyze (if-consequent exp)))
        (aproc (analyze (if-alternative exp))))
   (lambda (env succeed fail)
           (pproc env
                  
                  
                  (lambda (pred-value fail2)
                    (if (true? pred-value)
                        (cproc env succeed fail2)
                        (aproc env succeed fail2)))
                  
                  fail))))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_90_9_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=4&prgrm=PTAEGUEkGEAVQFLlAFgHQGZMChslAGYCuAdgMYAuAlgPYkDOhATjQLYQzxKpoCMaAJlzFy1OqCr0A+gBsqFAKZMAhjIAUZNgAc6CkhQCUoAN7ZQ50EwUUiTEhOkkirAEZKN23fqOgAPr7MLIItJKXoKJioSAHMPVh0SPUNzf0DgoNCXGhoZBWUSOISko1T04NCnGXVNeK9ki1KykOlSABMFAiiFVsK6gwBubABfbBFKWns5RRUZKQA3VSIFXsTvEyC0y2tbexqi-UGR0dJx8VCKZWjo7tlJCjVw1goAGlAKAAsFKQvoo1Mgqw2OwOKRaZRUJgPChPIwAMlhoE+yh6j2SAF4MW9Pt9LodhCcxPYKspWMs9n0TJtATsQT9rq1buEVklXgAiEgkhSsgbDY6iCagegAT1cOSkNAIUg5pOZa3+FmpwKRPQuVGqnlWhh5RzGhNArGUAGsvsp6PQqNESKT9FDIjFXgoAB5aKxmiZ-KnbYFyJms03my3Wiis17hO3RB3O13mujavmnInSf0Wq1JWXJeXmRWJnFXG4++7kzVs5OBpLcvG6gWl1P6MIirLq2qaj0Ar32ZVqVXqTvd9MGAdxqviGtB+aLL5Ol0KN10fuUttAjt5FXg9R9ovFAd4+N60LtMgyZQqQlQmELhXt2mXemM+6otmaBgXOsHo8nibcvwBJrNXO3gszxeUBWQWSJlBcXIpDfY9lEJL9UhGYd7Bgj86HrUV1FRVssyvXs1zUfC1SAwchwJAVULgiZxxkJYpCnaMJhIi8tiXREVy7Ai+2w7deV3AVQiPVxWmUeioxnGMCmwljs2vPMGUAh8QKElwRLE6dZxICteWQ0AVLUsEVFJaZ6GYzNZINLQHgbMUJSlTlXiIrDoS1Mj+XEfTRKyVohTMtJZKczjiJ4uN+LOaRszCC5FCDPzLzY84b3zO4gLZSLwjghQg20pDyPESKGIkpjpPMvCOO4lzeJ1PKcyfVp5AmVQ4vimlEvku9UpAuqGroVR1MYugEJ-X85IAlKlNZbrCT6jKYvLNyE1AKbGtmad6rITLmtYmkCykKwCE63gFr1ZbetmJ96AUABHJYbRK-yr12-bOoEY6BVOjlZlUaYOWoOZlnulrvTuPaOk6jBQt00JLpuvQyAByqZKvNqxqZCaYdu+GcrC+wDWNMJrsxhGnnoHDtuB30MbhrlQxc0nKxqwVCepqLMqDUySosB62MCniGfc+xOiYcJWbmu66bJgKONRemdMZ10KFFrKkg5iWkbYiqSbe8L6PiCghQJ2HyGJihSfV1rHCIKogNl3KBZBI8Rdm5Xxa183gQqK31wImWqvxe3MhkGgyENLbyZzOlkrRly2Ug4PDWx3S45DqRvN8wGgeXZEgucmFIcZ0JlC0LQ5A208M-D0ao-vGOQKLkuqDLz9tcFmr+qKucK6l7PNa1fnFuPaJ2801Xz1Knnyq4n3Kr9vAwGQxgCBYdgoDgRBkHQfgMH9xbziYJY1EdMnK8ybJcnyQ+jE2MoAH5QEdUAMTRN594UUBr-SAAuUAlBYSFHVjmfPI9gpwKEoN0V4Vh4ZUH+q0T+2Mcb6iNF8ZCahDKchMq8NODoSBzGPrJQCk1PBtCkMhEMH8RroOMkoegWCaA+RwXg-ue5pDkhIaggg+DkbSEjgpFKBBHzEJIAyMhLdCBtyodYGhahOEsUrk9MGAjQBHWYQKZCqd6G+VkZmeRINnpKNeqo8Q6i9BzAhHQWK2jPRsQUQdJREMdy6Txl8SKCxaJkjoIoOU1idopVZK4icIYlqeOKEYnMAT3FqDcUsLhCUeFJT4UyaJCg0rthoksRO8s0nJKkE+Lx9xkmxJpIFQp+d7ZwyDuaGI9FcHmNrPcUxRTgR9kaWEwgEIRZL05GoRpcju49FaXLcp5BKlfBcFooyKSf64L+BsRcNIwQQhkZMxhcYLoUCxJOPWBtTF1KDI-UAlQZCDEQc40hkzrKYVoaAZJZsdGyUWZCYUVzXi3LEV00kGFGymQ+QoWZXN5lKg4r895kz0kzmWZyf55gfHNIIiCxxjMnReIZLslg9TLnfNeaoa5LhTSThmX0x6ehogfExTkM2T89IkrJW40mFCgh30eWoM5vzyUyGuXSgwWD8U1LwQyiw39cgxDJc875RgAA81KRXvCiTigwArGU-yYH-NQrIAAq2QkEkCFKAQezgVaCiIMXOQ3Rv6slAAAanfiNW1YYojRCoAQdONkOVGGtUEi11rFV2oiA6p1vkuUKtteYb+v8aCQg1VqggCgADueqmDRANfoRg9BjUNzNSBK1NqQ1NHtTEAN7KzYerZNmn1I182OudXKt1ZTFpBxoIaY1XyxTJPZasuRulTGyGyFZXpOigi6XoBtKSrrOXyrkU0WSntrZiopcG3NwQ77dobVZcttqKk0CqUPNFFi0yNIXYuwVgpXWP0xJ2Odbr11NDvp2Ll16yjf2HRfbiY7uVvAIkGwYTQRhNCdaAHpuCz3Pw+FsrQ+s+V7OKJOso4anmurZAAVRIFkNohzOTaR-T-Dlb8B1lHWcwTkByhadIuYMkNsln0FF+S2jlkLSTcofb+Gjtz6N-J5D+zYv7M7TLmD2mgfaZmIvtjWWj4L203NUB2nRXbcH8cE3gmD5gh0jqLdit1SngjTstrOt9THl1ydXWoJjQRN3bsg+i2KB6mNPtPVSi9emj0WDvpdRWd6cXqcPUep9qnX1XPfX2L9DKhg5vSP+wDcxgObN1uBnZtTLPQbw+kODEnWTIdQ8I9DpJQAAFoct6rdGWfQmGyghYUDhzTQQCO-OIx0xWbLyO2so6pmjl6fmTMY05poLGJztahRx0rXHYUgMM72iLoV8AL2YGwDga9uCbzQCgHeLDQSRFYA1f6pCaoyNIJLbh-5q47ZIGyF0VB1t-S5GI0752YFfDOyXF20UmIiD2xPHu8LduhQI9djbKCaqMGfoBChhDlRBIsMqXNnX0iEO7GD8w3ZIfPGB34x5cPQCPMR8j30BY0cFkx2UQhM6ZBBKJyNKHwRCH1XoCXZQQoglU5p7q385OgiELg3DuDIaWcWEIQaD4UgIL0BDHz94AuXCMCaNz8whDLVo4sIfV4QojBogAHz32zUzqXek-E5bl+YBXoAlePzVw-fLmukcE78QAKj1wBgBhvlcm9AFbw35gteEOALbg3RvVfq7AObrH9xWQAFIvf259074PrvQDu78U-OX3vHfq6pUri30O-EAEIMQJ-D0nh+Wfn6p8D2qiVYfFd59AFK8wRfLe+glWiPXifjfq-r9X2PvoVdl4d83h+au29p4p34lXDfXjBCb773vz8HcD9Z5n236ugi+-MBniwR8KE8m+2t37W2Ba0YBwyyyhEVyvB+xdnfCZZab7O9v9RNAXAACswGm0fgfouR3m+ENP7doJgUXsDhn00F-ptgvDyNgFfjdptusvkM-oDilIQm0B0F0K0EEggZ0IkK0Frl1r+IQpACQGgfIHTqPrgfgfrJgVgbXkHiLlILAJAHDlQTQWQeQYPr6FQQAKJo5sGMFME85+IAByygvBtu-BvBXm3BZQG+dA4Q6OW+Z+UBdYbWL+TQh+BAzenYnCJ+Mht2uSkhL4psEhz40h1+shOh0B4K++Shb+Khvuv+-+hhEBXwchehJyuk9cMgBsQBf2AsR2rwg8BYTS9grhBsUQUgCBTAbhDqUg9+ygCww6kQ4GxmTmHhUg92uQQYVEc4L2ABtqvhdwAwwQfEQ62wWgFme6No-hP8joKKJRGKD69cegPQSR6ibWrwJmwQSRjhe+XBQQdRwiaCmhwBbcd+j+lA1yrRQQ7RJhdYbyWRv4oGMWEGu69SoUuQGycx0QQceKswix+yz8rmza2xaYoBk2-202K8nA68PAWA28iChcrg84xg6Qw2VciShYGoLIdcJqjc6RWkcICIPqxIMoJi4kmk-YvxoWearq4oko0oywQJGkkkoJUWforgrIbSJILguS7wNAjcEKm43igKARiapkeJhgwmA8n0QoAAXl8FMEoE1CSeURFqGEQGQPDBAoQGuEnmmqyQoN0GoLSTMOJgya8AQJyWSXqPkKoFSV8DCfcU8UyUajyeyaKWqI7j6tyWyT0A2k2sUZeuJnqXZLKcKbxl0WUCqTIHWhKRSdSbIOiWpIVCCQyXIt9rBNQsLAcp5KCK6VIsLP2N+hYARmnB6XaV5Jon6ZsIGSIAcpKW4dSWoGnANrhGxAqRqbya0CKZycbuqSyZqSysgufqeJIpgqAC4CIKsjMSGuaZadWNaV8FTMbDbMfIUUbNQKoG4WoMoFgsfASQBqYsyUqemRyaqc3mMcoAqWMfrqJMkhmWqK9FmWIeYKEBEgfFOROKIeQS5jmWmR2eCjOTIK9BOUEN-C4CmVucqWuK9BWbmlWf6eYNxspozEZiRvVqQJAjOC+QwN2TxkTmoArDvvSkenfM+Tvg+kKmNvWa2VUFonVjvleV1p2H+SIKTKabMQRIhaQMhbeaAPecEgYUhQcofjGdKbTFrFhdplKF7EdmbD6gZpFr7qgUgT6mBQJkftnEhQFh9p+dWSOLWdBGAu+N8XKVVjoSephAcpRISLRuGcJQYXMFGc-ERXGRJdRDkg6QiQyYmZXKeQOXuUntenJaQEyWMTWnuXOb7klk5qJnqW2peupqslheQZRmeT0AxegaZZpUekMHBcxmKQUYzIpSaIVhik6TogRpetGUFWOJetJQGSJQZfYApbWR2ZFUkOCsPOpW8d4JpbJNpZqbpfOWUPFUZbmiZUOfuUng8bmvgFbrwFbiZgRjkAyMkh6dkDqWJjZQhiaQ5SGlZZCR1ZhHZV1SZk5QOSZYebamoBVcENVQIHVQubmr1ZhPqQhuNfNSNI1bueCWtdtUNTtb+LJOaQIJNd1dtUMB5T+t5cpr5dVPbFRuKEQIrMpZIUJSECoWoNDMzA2RpZpmFXTAcvWfDErOzDFekORVlLFobETI2Q+nfEcqBXqsXPUQ8COvdY9fxbBISD8jBc7LFL7ChRWijTQA9XxYeBjRMKZKtcEGcgDcsH+TjSrI2YOFhWVhVhZeRU9QUAyeWnfIBBzVJRpeWt-EcszX5fbLtHZKQDWHyTCXck8YflIM3qyFbpLUFd0Dbq8DLdxQEbxcnKHCFRGSJUGc-LrRoj5CDbhVIUHBtByv9YTcTRzaZAmVhQRirQGOgQDtriLBLRyKrVqcHPKs7YbfJXqklU7fKX2YqXlWVWqbaqWYZcivUdUbFFbR5qAK7SmN0Nco0pdUEKmeeaqf0LmqLeSVKTaelNFI9i9eYARkwMHQFb+WkmpUxBpWRVeLlWmflarj6rXfHbgjnfLm4u5c3nnT0GcsucsG4u+odfjdHeKQKNcIrIPKZMoEhYwv2VHVWesPkT2T+SvRheueYJuaNUcrpQyt-J2HvZ+cVdwfgKmWaLhdQE4N8YQBGliJIHqiIONR2YmkPV3dtQvQLkSTnB2exf3dwX2ZTbarfVuffXklEEQM-QQBGpAyNPgFArYOaP9EtG2W8DQKAAA0vSg7+N-dENcuaRDAVXtb+CPWguCJCIPD4USTPVQ1dWqBDGA0wdPRw+kDecXXqE6GAg9SaJ8U3Bka+QmqQ+vR3dHUSnEqtkYVoRwrtgykfbmYEfI-YQWc9uI0vcw9HWfSCGwsIlo2IyQFfDeuIrvmnEdgYAkbmgncYwcTaK0eokWdIpka0Uvdw5YwmEnWmH-v3fGZoqDGmjIMBNPSOV1jQ0udkhOEEz5CE1bMkJA3fOPdofoGmGnIk2EwfVgd-K5RApA1w9elWQYylmWSBKQIaCQDQLGq3PbPrFoG-HllmpaoeayAI2QEIwLiI98Qgi4bxa4V8aePrTJVIQQHXUlXCQNJzZlX3AbQYZfR7YRbWYw6Q6Ca3cmRHSPZ3Srg+hM73XMN4-rhUxE3-QuQQ0A0sy0SwxYBA7c5OUSXuRQ+cw83c46II4oD0w3KI9Rq+UQ4ul45HdI+Q3o0esU5w2Ke-DdSXbGSaHcVOMfARmQPhc-Cs6XVMuiZidifDKZIi9lW3ds85bs5prpBEAbIkJURoFiTibLRRvtkctSzizOLkxY+aZNTZuxNnGQDS7i7Y-c7czswC0EJNc3uS1KMisAzy8y8hedXeQyrJOK5S4WOxczXPTxRi1XSfNIAKfSXM6y4fSHRi7cNMHq82MUAKt-ACR4ua94DRUa3C-ZDKFzb+Fa9IBzf2PawFSTQJSM-q5ayCKOGmC6yNHfN60GzaCG4+oY3QPVNNE2PsIYF67xR9Ga4m6y267acJKJE3XOFGxY9656bm7M7a0m66yCDTZ67amG7xZWzTUDQzQLeW4HPHFW6Gw69KanFbXrf682xFGkvTZG72+296+XWzMG8O9G7cSefm7fB2zaeiW21O0mL0366Wwa6ADW8a0M780u1-MqqqiSUhiQNU7U-YMKPoMoKbvlgFf0-5a4AoG4j0s6GvcC-nRaVvXMjxvXYi+3e+1re0sLIrPQDkA9UxFEFoA9eUeiY+01IZJdGqg8V6hICQJBxsh6thdyMc2sRsX1E4y8MZYPYcsigLmE0oL9LdknoPcZUngUxgeqwEVUGEKB5je9ah1B3IisYKCx+TQcsLQAJCbBQwZN2B9RGYQcPWvDiuXDghmOabhYScbJUqsjSfRCydfgWVBCqeyfHXBbYaXSVYWAwdPvwfLCshIfZqKfZoWpDBYdMY4d354fxalEEdOb4DGeqDAtmhMalXKukc-RUT-QVUTkge0SY0HLMpEehdgeSFyu5rToiefTyZqradRBBJ+ffTkeBd-InW-heVMbucPtuJlW2AKA+e0fCKIHoFMZxc4U4VRABezBGYPqKdgOivmVjEM5Hi+Ssj4ANdZcyAHsRola5pnWbM0hWD-TCwAw8exc7jVZexenTdMAHIWpvOLoAA6iCVgN0EIywWg0K63tqW3PZK+Wgm7eqdxRg38AA5OAFRPQJ0N0FsLt1YDd4XQuVtyFkdw81t04llG4JCPIFlK8EfJ+z90ECd9+TpuoGDxDyNFD+kLDV7PD11oj8EFazFFFp2HD6j+YOj0jwvnj5t4qt-KSA+0DzFFJwREfHket198TztVt1x6QKZ60Hx17B94z8EH94zKZ1ILGhGj0IL0wC8Yd28+jzt0QHt2oCvj+az8eJdBgXT-T56K98sOT4D6xS5ah4r90BxcRCL2L0YAXocl7Cr5Dws+M0TcY0bwcp2Ar9N-R7c+j470rwcn2G7-r1zz95L49ClJ2Eb3eFPTbwyEbxb0wQz9z-NVt5vgoDoOaOF7AUyDd9OFoDd68Dd0g0wBn6ADdxQDQLn3n1ELnzd+MqX7GvIO8Dd3kbz-bPz2n1uj1El1oO8CoAh+L2tX7zYilKn1YFoDlq3+3woEXxDwT7avz0b30fH035je+kz0xvzzU6QKCG3-ipNRHwv999H2IbHyJcvwwB6b3wf6X+EEQO0PoKXy6BKBJBGqX2XPf47PQDXx93v7JUoOLkfyn1Ny4KfzYPVDOFL65BKApXZ-pnzyCmxT+uQePs-1r7Cs8eb-KQseGoCHgZwX-e4Dd2QGNxcgpfUDKX2UAv8Y+iCfnuaHiBQQD+q-YfqK0qosNu+viFPqQIew5YD+g-NfpdFH5UNx+lCPXgLyF7f0UBuQUmKPloGL8eBU-A-phVV7b8d+kfYgTwIoFD91+nfCXkJ0ZgGghQbgMSCijUAKC2BfycHl3wVZXhF2ug4fsIKO5cCQ06gzQQ4y1LH8berA4fhwJJ5vNTB+KcwbILeYN9++s-FaJQKUFM1LeQQaQTIJcE8ZrBk4SokjRIEpEZSNvfwR3037HdhgoQ7gnX0WgkCkg1MagYzzoEUwMBl0DJsbGcFj9RB03KUPEMUEd8PBe1SwYAR4E-8EhywbcL9xSGpDyC6QvUPz0aFVDmhBg1XoOjUG04bBUQ3oj0L0HKDd+RgtiIu3GFmD4edQkaBEK0FI1AIN3H-o4PxQlCQ0iwhcnMPcFECvBPAxvonz8G9CN+LQiwOjyGD8d+O7QoIeEOGGRDtBk-PgT-0kGGCQh9w3NJ0IFD89FObHNDpMNaFBAve7PZ+Ipx97R90eYVJIBFx4GFCvE8MY6hYLV7S8rA71GHmoDBGXDfeTxREVCNSFR9vhR6VEsthrLGtU2CbCkDQIBSxUDCWgSZpqypGrZugwzG1um00rIsmRcLDwMImb59QLon1V4uuy5EiVL60ZJKiyMy6icLsGzcOn3TfaDlN6rzQAiIGvqLpoGPJWBp4ngaINX6sHWiFRBiBbUoGYAUDNITZFlw34BfUAHflVD2A1o4KHzk6OnJlUzKezJgnvAPiui1ypoxdHfBRaHMpG77A8kwW-iX0-2yoi8jPUmxrhSuD9PUXqGz4-xokxo6IP6N-D4ALRa0dkbcK-aLpeGRwWxPyT0RgwSxFYssQdDbLMcwu5NHbEx1M4rdvUa3EkT8OwD-D2O9wNYXgMz5n8L+FACvlX1wGfB7+cEbYTz2wA3d6A0ArQGAOL4kARxI-TPqTTNA18khe1OzjvwAAMYLLrJeSIYHisCR4poCoiAA')">function analyze_conditional(component) {      
    const pfun = analyze(conditional_predicate(component));
    const cfun = analyze(conditional_consequent(component));
    const afun = analyze(conditional_alternative(component));
    return (env, succeed, fail) =>
           pfun(env,
                // success continuation for evaluating 
                // the predicate to obtain pred_value
                (pred_value, fail2) =>
                    is_true(pred_value) 
                    ? cfun(env, succeed, fail2)
                    : afun(env, succeed, fail2),
                // failure continuation for evaluating 
                // the predicate		    
                fail);
}
</pre></div></div></td></tr></table>
  </p></div>

  <div class='permalink'>
<a name='p19' class='permalink'></a><p>
    Sequences are also handled in the same way as in the previous
    evaluator, except for the machinations in the
    
      <span style="color:green">subprocedure</span>
      <span style="color:blue">subfunction</span>
    
    <kbd>sequentially</kbd> that are required for passing the
    continuations. Namely, to sequentially execute <kbd>a</kbd>
    and then <kbd>b</kbd>, we call
    <kbd>a</kbd> with a success continuation that calls
    <kbd>b</kbd>.
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_90_10_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (analyze-sequence exps)
  (define (sequentially a b)
    (lambda (env succeed fail)
      (a env
         ;; success continuation for calling a
         (lambda (a-value fail2)
           (b env succeed fail2))
         ;; failure continuation for calling a
         fail)))
  (define (loop first-proc rest-procs)
    (if (null? rest-procs)
        first-proc
        (loop (sequentially first-proc (car rest-procs))
              (cdr rest-procs))))
  (let ((procs (map analyze exps)))
    (if (null? procs)
        (error "Empty sequence - - ANALYZE"))
    (loop (car procs) (cdr procs))))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_90_10_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=4&prgrm=PTAEGUEkGEAVQFLlAFgHQGZMChslAGYCuAdgMYAuAlgPYkDOhATjQLYQzxKpoCMaAJlzFy1OqCr0A+gBsqFAKZMAhjIAUZNgAc6CkhQCUoAN7ZQ50EwUUiTEhOkkirAEZKN23fqOgAPr7MLIItJKXoKJioSAHMPVh0SPUNzf0DgoNCXGhoZBWUSOISko1T04NCnGXVNeK9ki1KykOlSABMFAiiFVsK6gwBubABfbBFKWns5RRUZKQA3VSIFXsTvEyC0y2tbexqi-UGR0dJx8VCKZWjo7tlJCjVw1goAGlAKAAsFKQvoo1Mgqw2OwOKRaZRUJgPChPIwAMlhoE+yh6j2SAF4MW9Pt9LodhCcxPYKspWMs9n0TJtATsQT9rq1buEVklXgAiEgkhSsgbDY6iCagegAT1cOSkNAIUg5pOZa3+FmpwKRPQuVGqnlWhh5RzGhNArGUAGsvsp6PQqNESKT9FDIjFXgoAB5aKxmiZ-KnbYFyJms03my3Wiis17hO3RB3O13mujavmnInSf0Wq1JWXJeXmRWJnFXG4++7kzVs5OBpLcvG6gWl1P6MIirLq2qaj0Ar32ZVqVXqTvd9MGAdxqviGtB+aLL5Ol0KN10fuUttAjt5FXg9R9ovFAd4+N60LtMgyZQqQlQmELhXt2mXemM+6otmaBgXOsHo8nibcvwBJrNXO3gszxeUBWQWSJlBcXIpDfY9lEJL9UhGYd7Bgj86HrUV1FRVssyvXs1zUfC1SAwchwJAVULgiZxxkJYpCnaMJhIi8tiXREVy7Ai+2w7deV3AVQiPVxWmUeioxnGMCmwljs2vPMGUAh8QKElwRLE6dZxICteWQ0AVLUsEVFJaZ6GYzNZINLQHgbMUJSlTlXiIrDoS1Mj+XEfTRKyVohTMtJZKczjiJ4uN+LOaRszCC5FCDPzLzY84b3zO4gLZSLwjghQg20pDyPESKGIkpjpPMvCOO4lzeJ1PKcyfVp5AmVQ4vimlEvku9UpAuqGroVR1MYugEJ-X85IAlKlNZbrCT6jKYvLNyE1AKbGtmad6rITLmtYmkCykKwCE63gFr1ZbetmJ96AUABHJYbRK-yr12-bOoEY6BVOjlZlUaYOWoOZlnulrvTuPaOk6jBQt00JLpuvQyAByqZKvNqxqZCaYdu+GcrC+wDWNMJrsxhGnnoHDtuB30MbhrlQxc0nKxqwVCepqLMqDUySosB62MCniGfc+xOiYcJWbmu66bJgKONRemdMZ10KFFrKkg5iWkbYiqSbe8L6PiCghQJ2HyGJihSfV1rHCIKogNl3KBZBI8Rdm5Xxa183gQqK31wImWqvxe3MhkGgyENLbyZzOlkrRly2Ug4PDWx3S45DqRvN8wGgeXZEgucmFIcZ0JlC0LQ5A208M-D0ao-vGOQKLkuqDLz9tcFmr+qKucK6l7PNa1fnFuPaJ2801Xz1Knnyq4n3Kr9vAwGQxgCBYdgoDgRBkHQfgMH9xbziYJY1EdMnK8ybJcnyQ+jE2MoAH5QEdUAMTRN594UUBr-SAAuUAlBYSFHVjmfPI9gpwKEoN0V4Vh4ZUH+q0T+2Mcb6iNF8ZCahDKchMq8NODoSBzGPrJQCk1PBtCkMhEMH8RroOMkoegWCaA+RwXg-ue5pDkhIaggg+DkbSEjgpFKBBHzEJIAyMhLdCBtyodYGhahOEsUrk9MGAjQBHWYQKZCqd6G+VkZmeRINnpKNeqo8Q6i9BzAhHQWK2jPRsQUQdJREMdy6Txl8SKCxaJkjoIoOU1idopVZK4icIYlqeOKEYnMAT3FqDcUsLhCUeFJT4UyaJCg0rthoksRO8s0nJKkE+Lx9xkmxJpIFQp+d7ZwyDuaGI9FcHmNrPcUxRTgR9kaWEwgEIRZL05GoRpcju49FaXLcp5BKlfBcFooyKSf64L+BsRcNIwQQhkZMxhcYLoUCxJOPWBtTF1KDI-UAlQZCDEQc40hkzrKYVoaAZJZsdGyUWZCYUVzXi3LEV00kGFGymQ+QoWZXN5lKg4r895kz0kzmWZyf55gfHNIIiCxxjMnReIZLslg9TLnfNeaoa5LhTSThmX0x6ehogfExTkM2T89IkrJW40mFCgh30eWoM5vzyUyGuXSgwWD8U1LwQyiw39cgxDJc875RgAA81KRXvCiTigwArGU-yYH-NQrIAAq2QkEkCFKAQezgVaCiIMXOQ3Rv6slAAAanfiNW1YYojRCoAQdONkOVGGtUEi11rFV2oiA6p1vkuUKtteYb+v8aCQg1VqggCgADueqmDRANfoRg9BjUNzNSBK1NqQ1NHtTEAN7KzYerZNmn1I182OudXKt1ZTFpBxoIaY1XyxTJPZasuRulTGyGyFZXpOigi6XoBtKSrrOXyrkU0WSntrZiopcG3NwQ77dobVZcttqKk0CqUPNFFi0yNIXYuwVgpXWP0xJ2Odbr11NDvp2Ll16yjf2HRfbiY7uVvAIkGwYTQRhNCdaAHpuCz3Pw+FsrQ+s+V7OKJOso4anmurZAAVRIFkNohzOTaR-T-Dlb8B1lHWcwTkByhadIuYMkNsln0FF+S2jlkLSTcofb+Gjtz6N-J5D+zYv7M7TLmD2mgfaZmIvtjWWj4L203NUB2nRXbcH8cE3gmD5gh0jqLdit1SngjTstrOt9THl1ydXWoJjQRN3bsg+i2KB6mNPtPVSi9emj0WDvpdRWd6cXqcPUep9qnX1XPfX2L9DKhg5vSP+wDcxgObN1uBnZtTLPQbw+kODEnWTIdQ8I9DpJQAAFoct6rdGWfQmGyghYUDhzTQQCO-OIx0xWbLyO2so6pmjl6fmTMY05poLGJztahRx0rXHYUgMM72iLoV8AL2YGwDga9uCbzQCgHeLDQSRFYA1f6pCaoyNIJLbh-5q47ZIGyF0VB1t-S5GI0752YFfDOyXF20UmIiD2xPHu8LduhQI9djbKCaqMGfoBChhDlRBIsMqXNnX0iEO7GD8w3ZIfPGB34x5cPQCPMR8j30BY0cFkx2UQhM6ZBBKJyNKHwRCH1XoCXZQQoglU5p7q385OgiELg3DuDIaWcWEIQaD4UgIL0BDHz94AuXCMCaNz8whDLVo4sIfV4QojBogAHz32zUzqXek-E5bl+YBXoAlePzVw-fLmukcE78QAKj1wBgBhvlcm9AFbw35gteEOALbg3RvVfq7AObrH9xWQAFIvf259074PrvQDu78U-OX3vHfq6pUri30O-EAEIMQJ-D0nh+Wfn6p8D2qiVYfFd59AFK8wRfLe+glWiPXifjfq-r9X2PvoVdl4d83h+au29p4p34lXDfXjBCb773vz8HcD9Z5n236ugi+-MBniwR8KE8m+2t37W2Ba0YBwyyyhEVyvB+xdnfCZZab7O9v9RNAXAACswGm0fgfouR3m+ENP7doJgUXsDhn00F-ptgvDyNgFfjdptusvkM-oDilIQm0B0F0K0EEggZ0IkK0Frl1r+IQpACQGgfIHTqPrgfgfrJgVgbXkHiLlILAJAHDlQTQWQeQYPr6FQQAKJo5sGMFME85+IAByygvBtu-BvBXm3BZQG+dA4Q6OW+Z+UBdYbWL+TQh+BAzenYnCJ+Mht2uSkhL4psEhz40h1+shOh0B4K++Shb+Khvuv+-+hhEBXwchehJyuk9cMgBsQBf2AsR2rwg8BYTS9grhBsUQUgCBTAbhDqUg9+ygCww6kQ4GxmTmHhUg92uQQYVEc4L2ABtqvhdwAwwQfEQ62wWgFme6No-hP8joKKJRGKD69cegPQSR6ibWrwJmwQSRjhe+XBQQdRwiaCmhwBbcd+j+lA1yrRQQ7RJhdYbyWRv4oGMWEGu69SoUuQGycx0QQceKswix+yz8rmza2xaYoBk2-202K8nA68PAWA28iChcrg84xg6Qw2VciShYGoLIdcJqjc6RWkcICIPqxIMoJi4kmk-YvxoWearq4oko0oywQJGkkkoJUWforgrIbSJILguS7wNAjcEKm43igKARiapkeJhgwmA8n0QoAAXl8FMEoE1CSeURFqGEQGQPDBAoQGuEnmmqyQoN0GoLSTMOJgya8AQJyWSXqPkKoFSV8DCfcU8UyUajyeyaKWqI7j6tyWyT0A2k2sUZeuJnqXZLKcKbxl0WUCqTIHWhKRSdSbIOiWpIVCCQyXIt9rBNQsLAcp5KCK6VIsLP2N+hYARmnB6XaV5Jon6ZsIGSIAcpKW4dSWoGnANrhGxAqRqbya0CKZycbuqSyZqSysgufqeJIpgqAC4CIKsjMSGuaZadWNaV8JRKeE6TogRpegcvWdRJeuGVVjoTclGc-DGdKWoG2ehDkg6QiQyYmZXCmTmWmRmaqc3tenMCIEyWMTWrOTIK9M3klk5qJnqW2peupqsv6dwZRtOXyagUgWuYYmMUMBWbalWeKTWVKTaaOGmI2RGd2S2X2YVvUrRp2QGd2YuaQNGbWWoC+VMROMPGOW8d4BObJFOUqemRyXOargyoBQUKYreUEKuUheuUng8bmvgFbrwFbiZgRjkAyMkh6dkDqWJnuQhiaUeYujuZCXRZhAeQxSZieQhauWMbmmoHhcEIRQICRWIUxd+bRROO2rxaJbmuReCi0TJYpbBkJtJUerJOaQIPxYxUpeYEMBOb+DeeuveQUYzP2TaR9PSdBRmI8V2QYVoL2XqiBRZatFYOtJtOOYxQRmQA5WZR4sIj1J9NoQwMzDaB5e+QYcoD5U5XQPVNNF9DID9FRP9KCYxXBRhYqZqWuWqbavZaQMuU5vgKmWaMEvoFEEQN8YQBGj-NElRDEOCSGvgKBtId0F8YoG8DQKAHfqqPYGtOCkxn0TcMkpedleQXvAfL1YUvVUenfN5XlelamcqWuK9Lxd-JFXNbgsyQhcNZhekJNmuLYG-HkmVRVQQFVQoDVdQHVUxo1Z8M1W5YoAAJAPVzJHrGXVT2xUbihECKxDkMBykZAqFqDQwhXwyIlbnNl0wHJUzGxKzsx-npDabzEGzQ2g2+wPp3xHIPqrXFz1EPAjpfU-VgLvjfE-J1aw1pi+yml2r400DfXQRE2wSEimSqXpBnIo3LAKzk0po2ykSMVlYVZbmI2-X9jlp3yAS-W-njnlrfxHJ80mX2y7R2SkA1h8kwl3JPGH5SDN6shW7K3fndA26vBq3Vkji1mpxBwhz-X-kGFBnPzJyGgaI+Tw0lVSEW04pQ00102-WmQJmeXdl60BjoEA7a4ixK0cj61anBzyp+021RVPnLC+3ynzWnmIVVlZm2qllzWVH1HVGxRu0cqvAB0pjdDXKNI7XBALWp1im5ry3knx2gxLhc2vHNiJbhVSFMBx2xkc1pKjlMRhUEkAbJ1bU4UjW-gd3rVzDl1YVuLDXN6V15n4wRIHxuLvoaVU3KZim116jXCKyDymRrUMCMKbWZUj3rD5ED1E6gUiD0o3oZVplqBHJZUMrfydgH2kz5XcGFXTnFVHVOAnVVUfCSB6oiCqWgWJqz0oVKU70C5Ek5xX2kCkxT1iEYUs0NVgBFWMC-3lV6inVMCoO2r4BQK2Dmj-RLSqAyDtWgDQN734MjRgPRDXLmkQzp06V2op1oLgiQiDw+FEnr2sODprgQxIPcFr3CNmmb3vWLROhgLfUmifFNwZGkA8MMPH0zmn33L7aNHbYvYMoubsOBGrZGFaEcJKMJoMN8Mb2qnP0ghsLCIFnPa7ZTXmB3zqJpxHYGAJG5rIo50HE2itHqJFnSKZGtF71iPKZty+P3B-5IPxmaKgxpoJUQNq4mbz2hBL0J1xOuhWzJD4N3zpNBX5KxM+TxPZOiFMHfznnoFhPdZLVU1VnWMpZlkgSkCGgkA0Cxqtz2z6xaBvx5ZZqWrSWsjSNkCyMC7yPfEIIuFm2uGtV91WXHzVad0DlwkDQFD93W1SFv0HKH6+XKPEnzOwVXjwUn1p2QOLoEBLkoNMHeE4UblnNiHUOwNv0KX8MWBXOvP66hM4XMP3MfNvOOgyOKBjMNwKPUZKO0NHpfOV1rlCMQvpCiO8X3nvySNWn13ok9LOgLPdmzUMDbNv67N6quCYnYnwymRTi8QD3HNqOnNq5bm6QRAGyJCVEaBYk4nq0Ub7ZHIsskszhlMjQuMER8u-gv0cRkCsuksePvOvPQtwtYVJ4MtSjIpwNis8ukwUuDZTpXgKtMuFjX0TlDAPmm3x1W1JkWy3DTCWUt3eA+p3y+Xmt0lNj7CGACrfwAkeJWvOu2q2tm1GnzMusgjC0Mk2uOX12Bt+vCsghgXN1OtCvOYhtd0C7fmxRBsRuhDOUi1evxvSlBWxUrQZtNCuvSCem91zgpv8tZs2nFvAlQUeuxuFuGxEz5u-jev13s0PAg1fDOxw1S2pvSD21Nu312v9tluPogjpTRSPYDu3wVsuJpJduvnhsFuRt3EjuDvTMruLujuFzjMNmbtrtos7tzO1v+spYklIYkCtPtP2DCj6DKCm75a+WTOmWuDnVNRThH132LVzn4UvWmvAi+UYtaCSsbWftV2qmGuCxk30A5DfVMRRBaDfXlHomvvqCGSXRqoPFeoSAkAIcbIeqgBDDcjVPRbrF359SRPEfYU6sC4JVKC-S3ZJ4z0rlJ6VPdAm0BFVBhAwdM1A04eIdyIrGCjccTDB2y0PWbBQz6B0d9RGbwffWvAKuXDggkDHwA0AZycbJUqsiKfRDKdfhblBA6fKdaXBbYaXSVYWDIduIcPCzLCsiYfZoafZoWqEd8NrEbHkfxalEvDXVgBWeqB31mj9Uz2HLIo0eJUXZ4W8XQe0RM0HLMohcxeweSH6VqXIxSd2AydjbadMAGxKdRBBLUffTSeRfaW2qGUFV+cvtuI4UHX9UsfCKIHoFMape6VDYZAZeBVGYPoafCP8WbljEM5Hi+Ssj4BRCJUUPs6tc-qHNsRWD-S2cPDCcpc7jVZexem2dMAHIWp-NHoAA6iCVgN0EIywQHZ9u3uaB3A9K+WgoAtrdxRg38AA5OAFRPQJ0N0FsMd1YE9-0DJQdyFhd7twd04llG4JCPIFlK8EfOd0D8EFdzxpfTD3D7agj+kBjV7Cj1gWj8EK6zFFFp2Mj1jxYDj+jwvsT-t4qt-KSC+xDzFApwREfHkRdwDxT6wwd4J6QGh598-LLWz00CD4zNz1ILGhGj0KL0wC8dCiz56N98sCvpfVz8eJdBgczzL22HLyymD+4J2Er7ZxgQz8RBL1L0YAXocl7Gr0EDj9VrTXY8bwcrrzh8r2x3968zj3ryrwcn2B7y78TzjwQilJ2Mb3eKvbbwyMb5b0waz-z4pQd5vgoDoOaHF7AUyE99OFoE968E97g5n6AE9xQDQLn3n1ELn09+MqX7GvIO8E93kYL-bML+n1ugFX1FoO8CoOh9L0pf749ClGn1YFoDlq3+3woEXyj6Tzlc7yL2LwNYnwFYg+z0xsL206QKCG3-ivxZHzpdHzH6JXH92cv7iyn-cE9wf6X+EEQO0PoKXy6BKBJBGqX2XA-47PQDX673vwYQt+Lh6b35-2fzYPVDOFL65BKAB1F-lnzyCmwz+uQBPi-1r6ysKe7-TZkwGoCHgZw3-VPseBQG5BS+oGUvsoFf7-dEEwvc0PECggH9V+w-frj+34bd8bEvfEgQ9hywH9B+a-S6KPxoGL9J+xvMBlgN5aj43enA2zlP0l4P1bearV3n823479uCdfRaEv1t4UD1+nfdXhYCcS043AYkFFKIJX5D98Uyg3fgylkjotyBugy6PwKB7j9c0BoIUBoO8a9FAIJ-W3iwOH7sDF0lgpSiYNYFTIDBu3Bvv3yb5xVFBHfQcBINAA49Ae0grrLQJpDWDbB2dXosQJSIykFBpg5YNuCiHDBIhYhWQXqGIFJBqYVA-ntEIpjH9LoUnY2K4LH6CDLoUoFIV4P4rmCOBiRSfp-yCFpDN+XfTIVkKj5ECWhSgDEqkMKFY8ceagmwZOHiE9BWhqQ-QdkMMFXh0WUwrwY0OB5jFYh4wrQQ4M-7OD8UlQkNO4MUqLDh+yw7HvAIsB+CE+AQlaG0I37pCSeXGJ6t0Ph4a11B6w3GsL24Gf9xBnQiIY8Kcw5CBQwvDTrx1w4zDJBmwH3q0AOQadQhO-a3h+SSDxdJ+ZQrxKDQ6EL8NeRAE7kDR0zqAIRtwuHsUOvZJAYR3QqQb8MXSollsj5BNm219idpGY0NagOQ18jKAsEqnHjFSy-YWl5y5BZQAqWkqgV5KtzUetwTSbZJJKokQpKgz0bcVJRE4Yaqg2-guBORYHXCsR0sYWk5ag6RmEZhIz1ZTGnNPVppkRpctDRCDWNmTz1E74saekMbIyKoDMiZEZNMsrQ07BmiGA-+VSn2HdHiD2uGzDZNfTxZWQCWvsVKpyy9hHYzYwbUxM3lY6tAfUQqMbGoXNGG91AerZYnojBi2J+SmYg6NmOzHkMuOsXETjtk47c8tu3qHbuSLcHYBARfHe4A4NwFZ9z+l-CgBXyr44DPgD-OCLsKeFPd6A0ArQGAOL4kBOxI-LPoeH9A180ROlIjqcMXQAAGCxuQVejqiygq41ohuN-AqIgAA')">function analyze_sequence(stmts) {
    function sequentially(a, b) {
        return (env, succeed, fail) => 
                   a(env, 
                     (a_value, fail2) =>
                        is_return_value(a_value)
                        ? succeed(a_value, fail2)
                        : b(env, succeed, fail2),
                     fail);
    }
    function loop(first_fun, rest_funs) {
        return is_null(rest_funs)
               ? first_fun
               : loop(sequentially(first_fun,
                          head(rest_funs)),
                      tail(rest_funs));
    }
    const funs = map(analyze, stmts);
    return is_null(funs) 
           ? env => undefined
           : loop(head(funs), tail(funs));
}
</pre></div></div></td></tr></table>
  </p></div>

  
      <div class='permalink'>
        <a name='h5' class='permalink'></a><h2>
    
    
      
	<span style="color:green">Definitions</span>
	<span style="color:blue">Declarations</span>
      
      and assignments
    
  </h2></div>

  <div class='permalink'>
<a name='p20' class='permalink'></a><p>
    
      <span style="color:green">Definitions</span>
      <span style="color:blue">Declarations</span>
    
    are another case where we must go to some trouble to
    manage the continuations, because it is necessary to evaluate the
    
      <span style="color:green">
	definition-value expression before actually defining the new variable.
      </span>
      <span style="color:blue">
	declaration-value expression before actually declaring the new name.
      </span>
    
    To accomplish this, the
    
      <span style="color:green">definition-value</span>
      <span style="color:blue">declaration-value</span>
    
    execution
    
      <span style="color:green">procedure
      <kbd>vproc</kbd>
      </span>
      <span style="color:blue">function
      <kbd>vfun</kbd>
      </span>
    
    is called with the environment, a success continuation, and the
    failure continuation.  If the execution of
    
      <span style="color:green">
	<kbd>vproc</kbd>
      </span>
      <span style="color:blue">
	<kbd>vfun</kbd>
      </span>
    
    succeeds, obtaining a value <kbd>val</kbd> for the
    
      <span style="color:green">
	defined variable, the variable is defined and the success is propagated:
      </span>
      <span style="color:blue">
	declared name, the name is declared and the success is propagated:
      </span>
    
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_90_11_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (analyze-definition exp)
  (let ((var (definition-variable exp))
        (vproc (analyze (definition-value exp))))
    (lambda (env succeed fail)
      (vproc env                        
             (lambda (val fail2)
               (define-variable! var val env)
               (succeed 'ok fail2))
             fail))))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_90_11_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=4&prgrm=PTAEGUEkGEAVQFLlAFgHQGZMChslAGYCuAdgMYAuAlgPYkDOhATjQLYQzxKpoCMaAJlzFy1OqCr0A+gBsqFAKZMAhjIAUZNgAc6CkhQCUoAN7ZQ50EwUUiTEhOkkirAEZKN23fqOgAPr7MLIItJKXoKJioSAHMPVh0SPUNzf0DgoNCXGhoZBWUSOISko1T04NCnGXVNeK9ki1KykOlSABMFAiiFVsK6gwBubABfbBFKWns5RRUZKQA3VSIFXsTvEyC0y2tbexqi-UGR0dJx8VCKZWjo7tlJCjVw1goAGlAKAAsFKQvoo1Mgqw2OwOKRaZRUJgPChPIwAMlhoE+yh6j2SAF4MW9Pt9LodhCcxPYKspWMs9n0TJtATsQT9rq1buEVklXgAiEgkhSsgbDY6iCagegAT1cOSkNAIUg5pOZa3+FmpwKRPQuVGqnlWhh5RzGhNArGUAGsvsp6PQqNESKT9FDIjFXgoAB5aKxmiZ-KnbYFyJms03my3Wiis17hO3RB3O13mujavmnInSf0Wq1JWXJeXmRWJnFXG4++7kzVs5OBpLcvG6gWl1P6MIirLq2qaj0Ar32ZVqVXqTvd9MGAdxqviGtB+aLL5Ol0KN10fuUttAjt5FXg9R9ovFAd4+N60LtMgyZQqQlQmELhXt2mXemM+6otmaBgXOsHo8nibcvwBJrNXO3gszxeUBWQWSJlBcXIpDfY9lEJL9UhGYd7Bgj86HrUV1FRVssyvXs1zUfC1SAwchwJAVULgiZxxkJYpCnaMJhIi8tiXREVy7Ai+2w7deV3AVQiPVxWmUeioxnGMCmwljs2vPMGUAh8QKElwRLE6dZxICteWQ0AVLUsEVFJaZ6GYzNZINLQHgbMUJSlTlXiIrDoS1Mj+XEfTRKyVohTMtJZKczjiJ4uN+LOaRszCC5FCDPzLzY84b3zO4gLZSLwjghQg20pDyPESKGIkpjpPMvCOO4lzeJ1PKcyfVp5AmVQ4vimlEvku9UpAuqGroVR1MYugEJ-X85IAlKlNZbrCT6jKYvLNyE1AKbGtmad6rITLmtYmkCykKwCE63gFr1ZbetmJ96AUABHJYbRK-yr12-bOoEY6BVOjlZlUaYOWoOZlnulrvTuPaOk6jBQt00JLpuvQyAByqZKvNqxqZCaYdu+GcrC+wDWNMJrsxhGnnoHDtuB30MbhrlQxc0nKxqwVCepqLMqDUySosB62MCniGfc+xOiYcJWbmu66bJgKONRemdMZ10KFFrKkg5iWkbYiqSbe8L6PiCghQJ2HyGJihSfV1rHCIKogNl3KBZBI8Rdm5Xxa183gQqK31wImWqvxe3MhkGgyENLbyZzOlkrRly2Ug4PDWx3S45DqRvN8wGgeXZEgucmFIcZ0JlC0LQ5A208M-D0ao-vGOQKLkuqDLz9tcFmr+qKucK6l7PNa1fnFuPaJ2801Xz1Knnyq4n3Kr9vAwGQxgCBYdgoDgRBkHQfgMH9xbziYJY1EdMnK8ybJcnyQ+jE2MoAH5QEdUAMTRN594UUBr-SAAuUAlBYSFHVjmfPI9gpwKEoN0V4Vh4ZUH+q0T+2Mcb6iNF8ZCahDKchMq8NODoSBzGPrJQCk1PBtCkMhEMH8RroOMkoegWCaA+RwXg-ue5pDkhIaggg+DkbSEjgpFKBBHzEJIAyMhLdCBtyodYGhahOEsUrk9MGAjQBHWYQKZCqd6G+VkZmeRINnpKNeqo8Q6i9BzAhHQWK2jPRsQUQdJREMdy6Txl8SKCxaJkjoIoOU1idopVZK4icIYlqeOKEYnMAT3FqDcUsLhCUeFJT4UyaJCg0rthoksRO8s0nJKkE+Lx9xkmxJpIFQp+d7ZwyDuaGI9FcHmNrPcUxRTgR9kaWEwgEIRZL05GoRpcju49FaXLcp5BKlfBcFooyKSf64L+BsRcNIwQQhkZMxhcYLoUCxJOPWBtTF1KDI-UAlQZCDEQc40hkzrKYVoaAZJZsdGyUWZCYUVzXi3LEV00kGFGymQ+QoWZXN5lKg4r895kz0kzmWZyf55gfHNIIiCxxjMnReIZLslg9TLnfNeaoa5LhTSThmX0x6ehogfExTkM2T89IkrJW40mFCgh30eWoM5vzyUyGuXSgwWD8U1LwQyiw39cgxDJc875RgAA81KRXvCiTigwArGU-yYH-NQrIAAq2QkEkCFKAQezgVaCiIMXOQ3Rv6slAAAanfiNW1YYojRCoAQdONkOVGGtUEi11rFV2oiA6p1vkuUKtteYb+v8aCQg1VqggCgADueqmDRANfoRg9BjUNzNSBK1NqQ1NHtTEAN7KzYerZNmn1I182OudXKt1ZTFpBxoIaY1XyxTJPZasuRulTGyGyFZXpOigi6XoBtKSrrOXyrkU0WSntrZiopcG3NwQ77dobVZcttqKk0CqUPNFFi0yNIXYuwVgpXWP0xJ2Odbr11NDvp2Ll16yjf2HRfbiY7uVvAIkGwYTQRhNCdaAHpuCz3Pw+FsrQ+s+V7OKJOso4anmurZAAVRIFkNohzOTaR-T-Dlb8B1lHWcwTkByhadIuYMkNsln0FF+S2jlkLSTcofb+Gjtz6N-J5D+zYv7M7TLmD2mgfaZmIvtjWWj4L203NUB2nRXbcH8cE3gmD5gh0jqLdit1SngjTstrOt9THl1ydXWoJjQRN3bsg+i2KB6mNPtPVSi9emj0WDvpdRWd6cXqcPUep9qnX1XPfX2L9DKhg5vSP+wDcxgObN1uBnZtTLPQbw+kODEnWTIdQ8I9DpJQAAFoct6rdGWfQmGyghYUDhzTQQCO-OIx0xWbLyO2so6pmjl6fmTMY05poLGJztahRx0rXHYUgMM72iLoV8AL2YGwDga9uCbzQCgHeLDQSRFYA1f6pCaoyNIJLbh-5q47ZIGyF0VB1t-S5GI0752YFfDOyXF20UmIiD2xPHu8LduhQI9djbKCaqMGfoBChhDlRBIsMqXNnX0iEO7GD8w3ZIfPGB34x5cPQCPMR8j30BY0cFkx2UQhM6ZBBKJyNKHwRCH1XoCXZQQoglU5p7q385OgiELg3DuDIaWcWEIQaD4UgIL0BDHz94AuXCMCaNz8whDLVo4sIfV4QojBogAHz32zUzqXek-E5bl+YBXoAlePzVw-fLmukcE78QAKj1wBgBhvlcm9AFbw35gteEOALbg3RvVfq7AObrH9xWQAFIvf259074PrvQDu78U-OX3vHfq6pUri30O-EAEIMQJ-D0nh+Wfn6p8D2qiVYfFd59AFK8wRfLe+glWiPXifjfq-r9X2PvoVdl4d83h+au29p4p34lXDfXjBCb773vz8HcD9Z5n236ugi+-MBniwR8KE8m+2t37W2Ba0YBwyyyhEVyvB+xdnfCZZab7O9v9RNAXAACswGm0fgfouR3m+ENP7doJgUXsDhn00F-ptgvDyNgFfjdptusvkM-oDilIQm0B0F0K0EEggZ0IkK0Frl1r+IQpACQGgfIHTqPrgfgfrJgVgbXkHiLlILAJAHDlQTQWQeQYPr6FQQAKJo5sGMFME85+IAByygvBtu-BvBXm3BZQG+dA4Q6OW+Z+UBdYbWL+TQh+BAzenYnCJ+Mht2uSkhL4psEhz40h1+shOh0B4K++Shb+Khvuv+-+hhEBXwchehJyuk9cMgBsQBf2AsR2rwg8BYTS9grhBsUQUgCBTAbhDqUg9+ygCww6kQ4GxmTmHhUg92uQQYVEc4L2ABtqvhdwAwwQfEQ62wWgFme6No-hP8joKKJRGKD69cegPQSR6ibWrwJmwQSRjhe+XBQQdRwiaCmhwBbcd+j+lA1yrRQQ7RJhdYbyWRv4oGMWEGu69SoUuQGycx0QQceKswix+yz8rmza2xaYoBk2-202K8nA68PAWA28iChcrg84xg6Qw2VciShYGoLIdcJqjc6RWkcICIPqxIMoJi4kmk-YvxoWearq4oko0oywQJGkkkoJUWforgrIbSJILguS7wNAjcEKm43igKARiapkeJhgwmA8n0QoAAXl8FMEoE1CSeURFqGEQGQPDBAoQGuEnmmqyQoN0GoLSTMOJgya8AQJyWSXqPkKoFSV8DCfcU8UyUajyeyaKWqI7j6tyWyT0A2k2sUZeuJnqXZLKcKbxl0WUCqTIHWhKRSdSbIOiWpIVCCQyXIt9rBNQsLAcp5KCK6VIsLP2N+hYARmnB6XaV5Jon6ZsIGSIAcpKW4dSWoGnANrhGxAqRqbya0CKZycbuqSyZqSysgufqeJIpgqAC4CIKsjMSGuaZadWNaV8FTMbDbMfIUUbNQKoG4WoMoFgsfASQBqYsyUqemRyaqc3mMcoAqWMfrqJMkhmWqK9FmWIeYKEBEgfFOROKIeQS5jmWmR2eCjOTIK9BOUEN-C4CmVucqWuK9BWbmlWf6eYNxspozEZiRvVqQJAjOC+QwN2TxkTmoArDvvSkenfM+Tvg+kKmNvWa2VUFonVjvleV1p2H+SIKTKabMQRIhaQMhbeaAPecEgYUhQcofjGdKbTFrFhdplKF7EdmbD6gZpFr7qgUgT6mBQJkftnEhQFh9p+dWSOLWQLoVhik6TogRpetGfxWOJeuGVVjoTclGc-ERXGaOEkOCsPAiQyYmZXKeQOXuWqU0HMCIEyeujWnuXOb7g8bmvgFbrwFbiZgRjkAyMkh6dkDqWJm2peqslhbmqJnqa5QhpJjIO5SZpRmeT0G4nBWIWoEnmZRYBZQINZQuZ5fxS5ROO2oefFbanZbueCWldlSaR5TlT2eaQIBFXldlUMOpb+EMGFcpmKQUYzPJQ4XQPVNNE2PsBmI8VJQYVoLJXqrWR4MIj1J9Ktt0F8YoKCVhQRmQN1fVX1U1StNoQwMzDaGpeNdJcoFNb1R9H1N9EoL9LdmNfKX2YqZqdpfOZQvpX2UxvgKmWaLhdQE4N8YQBGj-NElRDEFlbavgKBtIcNWXG-BQDQKAHfqqPYGtOCkxn0TcNOUOfuTpeQXvAfKDYUu9YunfJNaQJpcddDQeUwd-GtejYdameebOSheYJNmuLYG-HklEEQA9QQE9QoC9XddEMjb+J9Z8N9etJlAAJBc1zJHo3m1X2xUbihECKyUSEjElvH4khAqFqDQyLXwyIlJa4VSEywHL1nwxKzsySVlDkVZSxaGxEyNkPp3xHKgV6rFz1EPAjoi1i1gLvjfE-IwXOyxS+wk2-jC00Ci3QT22wQS0JE5VnIa3LB-ku0qyNmDhYVlYVbK3kXi1MQMnlp3yATx3oQSVqXlrfxHJR2C31ogx2SkA1h8kwl3JPGH5SDN6shW6F38XdA26vAl3cUBG8XJyhyCURnSVBnPyt0aI+Q63mAEZBwbQcrq021e122Hh+0TCmQJkrUGE10BjoEA7a4iwF0ci11anBzypz1SGlmkDRm9Wz0HW4L9mY1VmnW-h70FDIr1HVGxRD0eagAL0pjdDXKNJVVBCE2Dk3m5q51WlSk2npTRSPZykdVSFMDrUAMh1pIOmqVS19zH1zCn1pknWq4+oQP40n3g2hVY1cnBV5n4zLnLBuLvqFXu0C3VT2zXCKyDymR40MCMLINE0WnrD5E9k-n0MAW3xHXblHLaUMrfydicMGAGViFXVbk3VU33V6h01MBYiSB6oiCpUdmJrGWw3xXUMC5Ek5wdnsUf1iEXX5VlDiM8mSOeLU200RqpXmVgBQK2Dmj-RLRtlvAA2aO0PWMhoqPRDXLmkQwX1GNlBf1oLgiQiDw+FEnu0BPQ0Qz6PcFkOxNmk1WUOLROhgKi0mifFNwZGvkJreNMPf2Zn3L7aNHbYvYMqbkDkdkmruH9GeEJjeG5OkwJPVWqkCMghsLCIFnPa7Ys1AVtxpxHYiPXo32dMHE2itHqJFnSKZGtG0PNPiK75jP3B-76PxmaKgxpoyDARkMjldZBNLnZLJVpwbNWzJAeOgB3xEPzX5JrM+QnNbPrnkHfwMXoHzOJPE36NVltMpZlkgSkCGgkA0Cxqtz2z6xaBvx5ZZqWqHmsipNkDpMC6ZPfEIIuG8WuEjUJ3wPHzVaQOxmwltywOYvNhbg70bKcMEVv71XhPeP7U9kY0oPQ3qOVnnVYNMENM7NoMaPWBaM0ucMtFRPmCGMCteM+Nrh+OcsCumaOhpOKCIsNxZPUavnnNOZzM8PMMxPKvvMw1vOMv9DvzJP-14sC53FTjYvSVo0MAUtWRUt6quCYnYnwymSmvqWyT0vMORUMq6QRAGyJCVEaBYk4ml0Ub7ZHL+sOsziPO-hAUESRtNCCMcRkABuOsiNCsBNf06ueNJ7etSjIo6OJvhvIXlUWA4U9nZu+uFjsVR3ik1lQOgPfnSACn0lYs0U9VQO3DTBNvEveACrfwAkeJduGAtv1X2QyiJ2-i9vSCp0FBjsjR3zDtTv9g9sgiKVLXNu2pztotiVpgzuPrtONUDWdutWxvmAbttubUtV9BLuCQhkqVEtHtDu8WemEtzg7tfwgjB2LvruttGsfvB1a3h0Z3jsgit2fuzvfvSmpxD1t1rtxsghANszbswdRvgeANpJh2rsDuxsTvGsnmvvcPDvomge7uFxIunh4fpCntGvosKtEdvspYklIYkAAtAv2DCj6DKCm75b1Uot1WuAM1NRTiMNqsFPDlRUAo8bTWmtusicWnVvGLO05Ci1MRRBaCi3lHon8fqCGSXRqoPFeoSAkCqcbIerYXchvNrEbF9RLNvNGWHLIoC5bM7VUT-RJ6hVjERXN4vPdBN16pVBhCKf+0qdqdyIrGCgBfT0HLZ1c2bBQz6BOezBGZBfATZuXDggkBfmLmy1JdIkpfRBpdfjK1BC5dpfFXBbYaXSVYWAaduLBPCzLCsh6fZrZcmdDBmdMYWd35WfxalEvCXVgDVeqA8NmjYNSZ2eVEOc-TOd-LN6Fd2rheSEHLMo4P0DzefklW5rTpxd2B9RGasjFdRBBLlsTdOcXZFsjSVV9e2tuBuLQ0U3g1J5eetBMZnfYVDYZBbeDVGYPpJexMeemVjEM5Hi+Ssj4BRCTcyDKp-wla5plVkVXhWD-R1cPCre2y4DVZexel1dyPPwWqSuLoAA6iCVgN0EIywWg0KePtqhPPZK+WgFzV3Hn38AA5OAFRPQJ0N0FsCT1YEz3qwuYTyFpTwK4T04llG4JCPIFlK8EfKw0L8ENT-WxRdbDL3LyNArxR4cl7Kr11ur8EL2zFFFp2Cr9r+YLrxrw-Cb0emb3r-qGL+4JL6wK8H2EfHkXjwL5bzlYT6F6QNp5z8-NnR72UCL4zL71ILGhGj0OH0wC8RT5K7r8T0QKT2oCvj+T78eJdBga72756Nz8sKSHx5CJ2Gn3VxgU7wRFHzH0YAXpr1UFn0ELr9Vl7Z0xXwckX4Z+n953z0Y7r8Xxnwcn2L3539r-H49ClJ2BX3eKQ03wyBX3X0we74H-FYT5vgoDoOaBLR6SlEz9OFoEz68Ez7I3v6AEz-9Uf8f1EEf0z+Mpf7GvIO8Ez3kcH-bKHzv1uge6tO8CoDp7H2lSPzYlvzvxyxaBP++KM-nL2t6UIO+YfCPhDTX4DUmm+VCAb+FD6AtSAoIEAd-zn6e9hgi-JfmAWkqoDLWsBJkEz0IGX9wgRAdoPoEv4ugJQEkCNJfzLiMDHY9AB-nz2X7SVEe4uTfiQK4HkCbA9UGcJf1yCUAKarA-fnkFNjkDcgq-VgY-01Ye8OBBhY8NQEPAzgeB9wJnioMbi5BL+oGS-soDYF4DdIofc0PECgiED0BX-ZYD-2yp-9fEJAswQ9hyyECgBGAhQGAO75MZQ+FfFRqoNyAIComSAwAlAN8GEDMK2fQXrgO4JP9FoKApvlYPxQecxOlPXXk4lpxuAxIKKNQJYOAHWDbBYhJAbJEI65D3Bo+IXsEJGgGghQmQkZlqS36uC8hoA8oVbwUHBBSh1glofPzaHjEoBr-dfnNSaGYDtw9fLjNEKwL2DgQ1Q2oZUStqmCUiMpBIUMJsFYCqeOA8Yd0JMFQDLocXBsgUOz49lAITPHYV4nhieDVelQ9IPELQHLCIqXQxAd4KgFcDEhmArvl4KiEbCdeiCUPs8NuH7CAmaQxmNMMnCzDeivw9wf8PIJFCrwhHcEZ0IuFjFgRWQq2kcK4FuDrB5w3NJcLEJwj8U9wiYT0IsAv8rAcA5qi8JWEjCLAuvIYDzU+GjCeySIuobV0ujQDo+USJQOLkpF4CPhdIgnt8KgFJc5ahnYLikNSGbBB+rQA5ElzeGL8G+0lE4Yt22FJBqYxVMUW2Fz5y0dM6gCUVyLVE8YThMojYQv15FHpUSy2GtkawXbt0wGGyESs-Cna0Z+6KtDZHpX3pyVeqDonJM+2nZYsXWV4aTqgzVzXpXR19VllgVs4cs1cs3BKovSSqRI3KflAKguSCqVNHuajdbragu7kEKGuAWxPyT0Rgw8xRYgsQdDbL+daI-tYgH5195yNvUuPE0ViOwCh9BRRw-QfvwoFUCKAN-O-noM+CMC4ImI9IIT2OEyCtA4g8-iQF7EeD9+k9M0A-1WH5U2uuAgAAyRNyCl5TVhuKwJbimgKiIAA')">function analyze_declaration(component) {
    const symbol = declaration_symbol(component);
    const vfun = analyze(declaration_value_expression(component));
    return (env, succeed, fail) => 
              vfun(env,
                   (val, fail2) => {
                       assign_symbol_value(symbol, val, env);
                       return succeed(undefined, fail2);
                   },
                   fail);
}
</pre></div></div></td></tr></table>
  </p></div>

  <div class='permalink'>
<a name='p21' class='permalink'></a><p>
    
    Assignments are more interesting.  This is the first place where we
    really use the continuations, rather than just passing them around.
    The execution
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    for assignments starts out like the one for
    
      <span style="color:green">definitions.</span>
      <span style="color:blue">declarations.</span>
    
    It first attempts
    to obtain the new value to be assigned to the
    
      <span style="color:green">variable.</span>
      <span style="color:blue">name.</span>
    
    If this evaluation of
    
      <span style="color:green"><kbd>vproc</kbd></span>
      <span style="color:blue"><kbd>vfun</kbd></span>
      
    fails, the assignment fails.
  </p></div>

  <div class='permalink'>
<a name='p22' class='permalink'></a><p>
    If
    
      <span style="color:green"><kbd>vproc</kbd></span>
      <span style="color:blue"><kbd>vfun</kbd></span>
      
    succeeds, however, and we go on to make the assignment, we must consider the
    possibility that this branch of the computation might later fail, which will
    require us to backtrack out of the assignment.  Thus, we must arrange to
    undo the assignment as part of the backtracking  process.<a class='superscript' id='footnote-link-4' href='#footnote-4'>[4]</a>
  </p></div>

  <div class='permalink'>
<a name='p23' class='permalink'></a><p>
    This is accomplished by giving
    
      <span style="color:green"><kbd>vproc</kbd></span>
      <span style="color:blue"><kbd>vfun</kbd></span>
      
    a success continuation (marked with the comment <QUOTE>*1*</QUOTE> below)
    that saves the old value of the variable before assigning the new value to
    the variable and proceeding from the assignment.  The failure continuation
    that is passed along with the value of the assignment (marked with the
    comment <QUOTE>*2*</QUOTE> below) restores the old value of the variable
    before continuing the failure. That is, a successful assignment provides a
    failure continuation that will intercept a subsequent failure; whatever
    failure would otherwise have called <kbd>fail2</kbd> calls
    this
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    instead, to undo the assignment before actually calling
    <kbd>fail2</kbd>.
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_90_12_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (analyze-assignment exp)
  (let ((var (assignment-variable exp))
        (vproc (analyze (assignment-value exp))))
    (lambda (env succeed fail)
      (vproc env
             (lambda (val fail2)        
               (let ((old-value
                     (lookup-variable-value var env))) 
                 (set-variable-value! var val env)
                 (succeed 'ok
                          (lambda ()    
                            (set-variable-value! var
                                                 old-value
                                                 env)
                            (fail2)))))
             fail))))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_90_12_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=4&prgrm=PTAEGUEkGEAVQFLlAFgHQGZMChslAGYCuAdgMYAuAlgPYkDOhATjQLYQzxKpoCMaAJlzFy1OqCr0A+gBsqFAKZMAhjIAUZNgAc6CkhQCUoAN7ZQ50EwUUiTEhOkkirAEZKN23fqOgAPr7MLIItJKXoKJioSAHMPVh0SPUNzf0DgoNCXGhoZBWUSOISko1T04NCnGXVNeK9ki1KykOlSABMFAiiFVsK6gwBubABfbBFKWns5RRUZKQA3VSIFXsTvEyC0y2tbexqi-UGR0dJx8VCKZWjo7tlJCjVw1goAGlAKAAsFKQvoo1Mgqw2OwOKRaZRUJgPChPIwAMlhoE+yh6j2SAF4MW9Pt9LodhCcxPYKspWMs9n0TJtATsQT9rq1buEVklXgAiEgkhSsgbDY6iCagegAT1cOSkNAIUg5pOZa3+FmpwKRPQuVGqnlWhh5RzGhNArGUAGsvsp6PQqNESKT9FDIjFXgoAB5aKxmiZ-KnbYFyJms03my3Wiis17hO3RB3O13mujavmnInSf0Wq1JWXJeXmRWJnFXG4++7kzVs5OBpLcvG6gWl1P6MIirLq2qaj0Ar32ZVqVXqTvd9MGAdxqviGtB+aLL5Ol0KN10fuUttAjt5FXg9R9ovFAd4+N60LtMgyZQqQlQmELhXt2mXemM+6otmaBgXOsHo8nibcvwBJrNXO3gszxeUBWQWSJlBcXIpDfY9lEJL9UhGYd7Bgj86HrUV1FRVssyvXs1zUfC1SAwchwJAVULgiZxxkJYpCnaMJhIi8tiXREVy7Ai+2w7deV3AVQiPVxWmUeioxnGMCmwljs2vPMGUAh8QKElwRLE6dZxICteWQ0AVLUsEVFJaZ6GYzNZINLQHgbMUJSlTlXiIrDoS1Mj+XEfTRKyVohTMtJZKczjiJ4uN+LOaRszCC5FCDPzLzY84b3zO4gLZSLwjghQg20pDyPESKGIkpjpPMvCOO4lzeJ1PKcyfVp5AmVQ4vimlEvku9UpAuqGroVR1MYugEJ-X85IAlKlNZbrCT6jKYvLNyE1AKbGtmad6rITLmtYmkCykKwCE63gFr1ZbetmJ96AUABHJYbRK-yr12-bOoEY6BVOjlZlUaYOWoOZlnulrvTuPaOk6jBQt00JLpuvQyAByqZKvNqxqZCaYdu+GcrC+wDWNMJrsxhGnnoHDtuB30MbhrlQxc0nKxqwVCepqLMqDUySosB62MCniGfc+xOiYcJWbmu66bJgKONRemdMZ10KFFrKkg5iWkbYiqSbe8L6PiCghQJ2HyGJihSfV1rHCIKogNl3KBZBI8Rdm5Xxa183gQqK31wImWqvxe3MhkGgyENLbyZzOlkrRly2Ug4PDWx3S45DqRvN8wGgeXZEgucmFIcZ0JlC0LQ5A208M-D0ao-vGOQKLkuqDLz9tcFmr+qKucK6l7PNa1fnFuPaJ2801Xz1Knnyq4n3Kr9vAwGQxgCBYdgoDgRBkHQfgMH9xbziYJY1EdMnK8ybJcnyQ+jE2MoAH5QEdUAMTRN594UUBr-SAAuUAlBYSFHVjmfPI9gpwKEoN0V4Vh4ZUH+q0T+2Mcb6iNF8ZCahDKchMq8NODoSBzGPrJQCk1PBtCkMhEMH8RroOMkoegWCaA+RwXg-ue5pDkhIaggg+DkbSEjgpFKBBHzEJIAyMhLdCBtyodYGhahOEsUrk9MGAjQBHWYQKZCqd6G+VkZmeRINnpKNeqo8Q6i9BzAhHQWK2jPRsQUQdJREMdy6Txl8SKCxaJkjoIoOU1idopVZK4icIYlqeOKEYnMAT3FqDcUsLhCUeFJT4UyaJCg0rthoksRO8s0nJKkE+Lx9xkmxJpIFQp+d7ZwyDuaGI9FcHmNrPcUxRTgR9kaWEwgEIRZL05GoRpcju49FaXLcp5BKlfBcFooyKSf64L+BsRcNIwQQhkZMxhcYLoUCxJOPWBtTF1KDI-UAlQZCDEQc40hkzrKYVoaAZJZsdGyUWZCYUVzXi3LEV00kGFGymQ+QoWZXN5lKg4r895kz0kzmWZyf55gfHNIIiCxxjMnReIZLslg9TLnfNeaoa5LhTSThmX0x6ehogfExTkM2T89IkrJW40mFCgh30eWoM5vzyUyGuXSgwWD8U1LwQyiw39cgxDJc875RgAA81KRXvCiTigwArGU-yYH-NQrIAAq2QkEkCFKAQezgVaCiIMXOQ3Rv6slAAAanfiNW1YYojRCoAQdONkOVGGtUEi11rFV2oiA6p1vkuUKtteYb+v8aCQg1VqggCgADueqmDRANfoRg9BjUNzNSBK1NqQ1NHtTEAN7KzYerZNmn1I182OudXKt1ZTFpBxoIaY1XyxTJPZasuRulTGyGyFZXpOigi6XoBtKSrrOXyrkU0WSntrZiopcG3NwQ77dobVZcttqKk0CqUPNFFi0yNIXYuwVgpXWP0xJ2Odbr11NDvp2Ll16yjf2HRfbiY7uVvAIkGwYTQRhNCdaAHpuCz3Pw+FsrQ+s+V7OKJOso4anmurZAAVRIFkNohzOTaR-T-Dlb8B1lHWcwTkByhadIuYMkNsln0FF+S2jlkLSTcofb+Gjtz6N-J5D+zYv7M7TLmD2mgfaZmIvtjWWj4L203NUB2nRXbcH8cE3gmD5gh0jqLdit1SngjTstrOt9THl1ydXWoJjQRN3bsg+i2KB6mNPtPVSi9emj0WDvpdRWd6cXqcPUep9qnX1XPfX2L9DKhg5vSP+wDcxgObN1uBnZtTLPQbw+kODEnWTIdQ8I9DpJQAAFoct6rdGWfQmGyghYUDhzTQQCO-OIx0xWbLyO2so6pmjl6fmTMY05poLGJztahRx0rXHYUgMM72iLoV8AL2YGwDga9uCbzQCgHeLDQSRFYA1f6pCaoyNIJLbh-5q47ZIGyF0VB1t-S5GI0752YFfDOyXF20UmIiD2xPHu8LduhQI9djbKCaqMGfoBChhDlRBIsMqXNnX0iEO7GD8w3ZIfPGB34x5cPQCPMR8j30BY0cFkx2UQhM6ZBBKJyNKHwRCH1XoCXZQQoglU5p7q385OgiELg3DuDIaWcWEIQaD4UgIL0BDHz94AuXCMCaNz8whDLVo4sIfV4QojBogAHz32zUzqXek-E5bl+YBXoAlePzVw-fLmukcE78QAKj1wBgBhvlcm9AFbw35gteEOALbg3RvVfq7AObrH9xWQAFIvf259074PrvQDu78U-OX3vHfq6pUri30O-EAEIMQJ-D0nh+Wfn6p8D2qiVYfFd59AFK8wRfLe+glWiPXifjfq-r9X2PvoVdl4d83h+au29p4p34lXDfXjBCb773vz8HcD9Z5n236ugi+-MBniwR8KE8m+2t37W2Ba0YBwyyyhEVyvB+xdnfCZZab7O9v9RNAXAACswGm0fgfouR3m+ENP7doJgUXsDhn00F-ptgvDyNgFfjdptusvkM-oDilIQm0B0F0K0EEggZ0IkK0Frl1r+IQpACQGgfIHTqPrgfgfrJgVgbXkHiLlILAJAHDlQTQWQeQYPr6FQQAKJo5sGMFME85+IAByygvBtu-BvBXm3BZQG+dA4Q6OW+Z+UBdYbWL+TQh+BAzenYnCJ+Mht2uSkhL4psEhz40h1+shOh0B4K++Shb+Khvuv+-+hhEBXwchehJyuk9cMgBsQBf2AsR2rwg8BYTS9grhBsUQUgCBTAbhDqUg9+ygCww6kQ4GxmTmHhUg92uQQYVEc4L2ABtqvhdwAwwQfEQ62wWgFme6No-hP8joKKJRGKD69cegPQSR6ibWrwJmwQSRjhe+XBQQdRwiaCmhwBbcd+j+lA1yrRQQ7RJhdYbyWRv4oGMWEGu69SoUuQGycx0QQceKswix+yz8rmza2xaYoBk2-202K8nA68PAWA28iChcrg84xg6Qw2VciShYGoLIdcJqjc6RWkcICIPqxIMoJi4kmk-YvxoWearq4oko0oywQJGkkkoJUWforgrIbSJILguS7wNAjcEKm43igKARiapkeJhgwmA8n0QoAAXl8FMEoE1CSeURFqGEQGQPDBAoQGuEnmmqyQoN0GoLSTMOJgya8AQJyWSXqPkKoFSV8DCfcU8UyUajyeyaKWqI7j6tyWyT0A2k2sUZeuJnqXZLKcKbxl0WUCqTIHWhKRSdSbIOiWpIVCCQyXIt9rBNQsLAcp5KCK6VIsLP2N+hYARmnB6XaV5Jon6ZsIGSIAcpKW4dSWoGnANrhGxAqRqbya0CKZycbuqSyZqSysgufqeJIpgqAC4CIKsjMSGuaZadWNaV8FTMbDbMfIUUbNQKoG4WoMoFgsfASQBqYsyUqemRyaqc3mMcoAqWMfrqJMkhmWqK9FmWIeYKEBEgfFOROKIeQS5jmWmR2eCjOTIK9BOUEN-C4CmVucqWuK9BWbmlWf6eYNxspozEZiRvVqQJAjOC+QwN2TxkTmoArDvvSkenfM+Tvg+kKmNvWa2VUFonVjvleV1p2H+SIKTKabMQRIhaQMhbeaAPecEgYUhQcofjGdKbTFrFhdplKF7EdmbD6gZpFr7qgUgT6mBQJkftnEhQFh9p+dWSOLWdBGAu+N8XKVVjoSephAcpRISLRuGcJQYXMFGc-ERXGRJdRDkg6QiQyYmZXKeQOXuUntenJaQEyWMTWnuXOb7klk5qJnqW2peupqslheQZRmeT0AxegaZZpUekMHBcxmKQUYzIpQ4XQPVNNE2PsBmI8TJVIVoPJXqrWR4MIj1J9Ktt0F8YoKCVhQRmQDFQFfFcFStNoQwMzDaBpRlSJcoNlXFR9H1N9EoL9LdulfKX2YqZqbpfOZQiIEZU5vgKmWaLhdQE4N8YQBGj-NElRDEOCSGvgKBtISlWXG-BQDQKAHfqqPYGtOCkxn0TcNOUOfuWqUwXvAfGtYUhNYBUtB1U1ameebOeuYut-OVYZRdc5e5d5cEJNmuLYG-HklEEQINQQMNQoKNf1dECdSNFNZ8DNetJlAAJBQ1zJHo3l+X2xUbihECKzKWSFCUhAqFqDQxFXwyIkWUEYywHL1nwxKzszSVlDkVZSxaGxEyNkPp3xHKgV6rFz1EPAjoo1o38WwSEg-IwXOyxS+woUVqc00Co18WHi80TCmSHllBnKk3LB-mC0qyNmDhYVlYVYWXkXo0FAMnlp3yAS61SUaXlrfxHIa2I31ogx2SkA1h8kwl3JPGH5SDN6shW522FboE26vCO3cUBG8XJyhxOk6KBmaIHJB0aI+SU3mAEZBwbQcok1i0S262mQJmlUGGe0BjoEA7a4iy20che18nx3yoZ1SGlmkDRlxXp2NW4L9ktU7V7UjQV0FDIr1HVGxQl0cqvBZ0pjdDXKNIvVBCXWDk3m5pW1WlSk2npTRSPaY2x0iVMAVVT1K1pJqVMQlW11zD11pmtWq4+pL0PV10bVuLuXN4j15n4zLnLBuLvrmmXlMYI3VT2zXCKyDymT3UMCMI71XUWnrD5E9k-mf0AW3zNXblHK6UMrfydjAMGCdXcHdVbm9VfUDV6h-VMBYiSB6oiBy0dmJpn370LkWCv0C5Ek5wdnsVD1iF9ly25qIM8nIOeLfW-URq0OTVgBQK2Dmj-RLRtlvCLUkPv1sO2p4PRDXLmkQxtVEO5oX3MqDw+FEki3SNmlrgQxUPcH31KPpBP3LYChOhgKo0mifFNwZGvkJpiM-2j2Zn3L7aNHbYvYMqbkDkdkmruH9GeEJjeHmOkzqMWBVlQMghsLCIFnPa7Yg2gBAVtxpxHZwPXpt3BMHE2itHqJFnSKZGtHv2+MPm76JP3B-5UPxmaKgxpoyDASaMjldYX1LnZITiFM+TFNWzJDCN3zX0FX5J1MGyuiNM3VYHfyuUQLCOaNUP+NNBhoqoRpeOsikCGgkA0Cxqtz2z6xaBvx5ZZqWqHmsj6NkCGMC7GPfEIIuG8WuGpUb1vH4kBkiUEDL2xmwltzr1zib2RUbLAMEVv4BUKNiMNU9naUN1VlSOVnnXH1MFePlOEMLmCNkPAMtHKOwZAswtj6ZM7WSNgvwuwaOgGOKC7MNwmPUavnCOWVEmWN7lqP4sqPXVZN+NinvzP3kkr0C53FTjHyZX4XPyEW1k+GuCYnYnwymSMuaWyQ-O72N3N4WW6QRAGyJCVEaBYk4lO0Ub7ZHLSvcszg9M3o7VqCquPrsTZxkAys8twM0OosWAj0UuLoavN7itSjIrkO6vKvIUeUWA4U9mWuSuFjsUa3ik1kr3z0nzSACn0lnOGA0WxV0v+uhV9ACrfwAkeLNjFDBsBX2Qyj62-hRvSC639jxu8XpvJujMgijhpg5u-h3wJv5vFWBuqupsFV5VnQZu2rFu8VVXhstiRsOwhnDzqXluZuhttv3N62dspsgiK21sjT1t0tDuK3k2q2m0DuBzxzDtFshs3Opzx3B39u5vVNLiTtluxveBdtLsz1swFtrtau3EnmFtqslt3HnvBCVvHM4vzsXtHN7OnjXtHnKqqoklIYkAzNzP2DCj6DKCm75YBUHP+WuAA1NRTjf1gO-3QoAo8Y5WMuCuweevGIC05Co1MRRBaCo3lHokQfqCGSXRqoPFeoSAkA4cbIerYXcimtrEbF9S5OmsmWHLIoC6lO1VUT-RJ6n3GVJ79MYGocBFVBhAYd8040Ue4dyIrGChicy0HIW1Q2bBQz6CcezBGbYeo2vCWuXDggkBfmLnY2acbJUqsg6fRB6dfgWVBDmd6casOWOvYaXSVYWD4duJoLHjEesikfZrGfZoWpDC0dMb0d36MfxalEvBMb4BueqBgNmgn1SaseVHsc-Rcd-IisTn0ByeSEHLMqn2ye0R80OuLrTqqd2B9RGZmdMAGy6dRBBKuspeccXbFe-heVRdgAxcyA7UfUbX8fCKIHoFMYtc4U4VRCpfqdjYPrGfqPmvmVjEM5Hi+Ssj4BjdqfvsRola5pDD8tXhWD-TCwAzZefk7jVZexekHcYPPwWpGtdYAA6iCVgN0EIywWgcHN3ua93PZK+WgETeqdxRg38AA5OAFRPQJ0N0FsE91YID-0EQ-dyFu94j+YPd04llG4JCPIFlK8EfP-Uj2UJ99+TpuoDj3jyGgT+kEzV7KT+QeTzexIDFFFp2CT9T0ELTxTwviz05mz3T6SOBxjzFNpwREfHkUj-D5z6i-dzJ6QERxD8-BbeL7+Cj4zDL1ILGhGj0Gr0wC8W9+97T490QM92oCvj+dL5590NuKT3r4TIb7z+j6xS5RR2bxgYL8RJr9r0YAXocl7CL8ELT9VuLcE27wcp2Kbwd4Jzd7T6H5dK0Acn2FH+b7Dyz1bzYilJ2G73eHfQHwyG7z79wWLwr8o-d5vgoDoOaHzR6SlID9OFoID68ID+g7X6AIDwtY3031EI34D+Mh37GvIO8ID3kUr-bCr9X1uolX1FoO8CoMRzr3D08YBFX1YFoDlhP1PwoK39T9z5Qmb6r+r5taX4lT4-C5v7+Cr7M6QKCJP-ihq7n0f8MAX4X2ASJWfwwBX0yID8-x3+EEQO0PoB3y6BKBJAjQd8y4wAx2PQH76J8i+IlfbuLlf73BAeMAz-jYHqgzgO+uQSgB9XAF188gpsT-rkBL7gCB+pLAvlAIMLHhqAh4GcHALUCA9yBjcXIB31Awd9lAEA2frpBV7mh4gUEZ-hf1X7msHiEfOfpX04EPYcsz-Zfpf0ujr8JeTGFXm7zwYUDcgh-QQYkW37yDn+mFUXnf3v5sDle2-HgSvyv4z9deynRmAaCFBuAxIKKNQAYMkHpcBBMLY-rJHRI2CA+vA-FKPkt5jFzBlg+JlqUr7iDDBUgzwUemP7SNbBq-EIUwTCFENh+i-UfiFXcHT91arPLjDoOiHO1acvgyouzQ4EpEZSbgoIcsAt5c9tB6QvPogg4FJBqY-AkgUILf6XRVOxsaQUn1kH6DChdgjVlENv6qCDu8wJQBiSKHX9E+RrfPuUIyHsDt+MApIcUNx5eDB0ZgrIZOByG9FphRQ4wRUKnRXgXBawuwd0JMHkEfByw6wfPxgESDV+LQj7sQOCC7DIhs-RHnEJL4JD8qQw0iCMNAC08hgMNcYekGT40gjhVg3IWoN34wDNB0jMYT8Lu6VDt+xnCTpRw2EqCLA8fGPs-GM7vCdBfvESo0JM7o5t+2ImoTf1GGegoeywE3o7zD4lD5hPGbEeiJ+EQjIRR6VErox4p0tS2rxHdhmAjJYi7MBWbOmOEvQx1cKUhAyvYAUpxU2R4Kdtqcw5G8Rvmj1HSsKxRY3DAW29ddCx1BZq4HBtqfAFbl4BW4TMBGHIAyGSQelsgOpMTDZQQwmkHO2RL2haNqa2VJMMgeyiZicrONeO73WbpqNepgArcAgfUaTysqQlLRmEU1tTyNG7lwmPwxrEj1kj317O1wx1i12CBtdryvlI4LYn5J6IwYmY3MdmIOhtlROhXGWjthE4y8MG3qa7gyNCHYAVesI+fkwLr5f8f+FAbvr30YGfBgBcES4b8OwCA96A+ArQFgLb4kAOxa-OvlLTND99CRqLILukIAAMWjcgg-RhYriusa4soCoiAA')">function analyze_assignment(component) {
    const symbol = assignment_symbol(component);
    const vfun = analyze(assignment_value_expression(component));
    return (env, succeed, fail) =>
        vfun(env,
             (val, fail2) => {              // *1*
                 const old_value = lookup_symbol_value(symbol, env);
                 assign_symbol_value(symbol, val, env);
                 return succeed(val,
                                () => {     // *2*
                                    assign_symbol_value(symbol,
                                                        old_value, 
                                                        env);
                                    return fail2();
                                });
             },
             fail);
}
</pre></div></div></td></tr></table>
  </p></div>

  <table width="100%">
        <colgroup><col width="48%"><col width="1%"><col width="51%"></colgroup>
        <tr>
          <td class="meta" style = "color:grey; text-align: center">Original</td>
          <td></td>
          <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
        </tr>
        <tr><td><span style="color:green">
    </span>    </td>
          <td></td>
          <td><span style="color:blue">
      
      <div class='permalink'>
        <a name='h6' class='permalink'></a><h2>
    
	Return statements and blocks
      </h2></div>

      <div class='permalink'>
<a name='p24' class='permalink'></a><p>
	Analyzing return statements is straightforward. The execution
	function applies the execution function that results from
	analyzing the return expression to a success continuation that
	calls the original success continuation with the return value
	wrapped in a return value object.
	<div class='snippet' id='javascript_90_13_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=4&prgrm=PTAEGUEkGEAVQFLlAFgHQGZMChslAGYCuAdgMYAuAlgPYkDOhATjQLYQzxKpoCMaAJlzFy1OqCr0A+gBsqFAKZMAhjIAUZNgAc6CkhQCUoAN7ZQ50EwUUiTEhOkkirAEZKN23fqOgAPr7MLIItJKXoKJioSAHMPVh0SPUNzf0DgoNCXGhoZBWUSOISko1T04NCnGXVNeK9ki1KykOlSABMFAiiFVsK6gwBubABfbBFKWns5RRUZKQA3VSIFXsTvEyC0y2tbexqi-UGR0dJx8VCKZWjo7tlJCjVw1goAGlAKAAsFKQvoo1Mgqw2OwOKRaZRUJgPChPIwAMlhoE+yh6j2SAF4MW9Pt9LodhCcxPYKspWMs9n0TJtATsQT9rq1buEVklXgAiEgkhSsgbDY6iCagegAT1cOSkNAIUg5pOZa3+FmpwKRPQuVGqnlWhh5RzGhNArGUAGsvsp6PQqNESKT9FDIjFXgoAB5aKxmiZ-KnbYFyJms03my3Wiis17hO3RB3O13mujavmnInSf0Wq1JWXJeXmRWJnFXG4++7kzVs5OBpLcvG6gWl1P6MIirLq2qaj0Ar32ZVqVXqTvd9MGAdxqviGtB+aLL5Ol0KN10fuUttAjt5FXg9R9ovFAd4+N60LtMgyZQqQlQmELhXt2mXemM+6otmaBgXOsHo8nibcvwBJrNXO3gszxeUBWQWSJlBcXIpDfY9lEJL9UhGYd7Bgj86HrUV1FRVssyvXs1zUfC1SAwchwJAVULgiZxxkJYpCnaMJhIi8tiXREVy7Ai+2w7deV3AVQiPVxWmUeioxnGMCmwljs2vPMGUAh8QKElwRLE6dZxICteWQ0AVLUsEVFJaZ6GYzNZINLQHgbMUJSlTlXiIrDoS1Mj+XEfTRKyVohTMtJZKczjiJ4uN+LOaRszCC5FCDPzLzY84b3zO4gLZSLwjghQg20pDyPESKGIkpjpPMvCOO4lzeJ1PKcyfVp5AmVQ4vimlEvku9UpAuqGroVR1MYugEJ-X85IAlKlNZbrCT6jKYvLNyE1AKbGtmad6rITLmtYmkCykKwCE63gFr1ZbetmJ96AUABHJYbRK-yr12-bOoEY6BVOjlZlUaYOWoOZlnulrvTuPaOk6jBQt00JLpuvQyAByqZKvNqxqZCaYdu+GcrC+wDWNMJrsxhGnnoHDtuB30MbhrlQxc0nKxqwVCepqLMqDUySosB62MCniGfc+xOiYcJWbmu66bJgKONRemdMZ10KFFrKkg5iWkbYiqSbe8L6PiCghQJ2HyGJihSfV1rHCIKogNl3KBZBI8Rdm5Xxa183gQqK31wImWqvxe3MhkGgyENLbyZzOlkrRly2Ug4PDWx3S45DqRvN8wGgeXZEgucmFIcZ0JlC0LQ5A208M-D0ao-vGOQKLkuqDLz9tcFmr+qKucK6l7PNa1fnFuPaJ2801Xz1Knnyq4n3Kr9vAwGQxgCBYdgoDgRBkHQfgMH9xbziYJY1EdMnK8ybJcnyQ+jE2MoAH5QEdUAMTRN594UUBr-SAAuUAlBYSFHVjmfPI9gpwKEoN0V4Vh4ZUH+q0T+2Mcb6iNF8ZCahDKchMq8NODoSBzGPrJQCk1PBtCkMhEMH8RroOMkoegWCaA+RwXg-ue5pDkhIaggg+DkbSEjgpFKBBHzEJIAyMhLdCBtyodYGhahOEsUrk9MGAjQBHWYQKZCqd6G+VkZmeRINnpKNeqo8Q6i9BzAhHQWK2jPRsQUQdJREMdy6Txl8SKCxaJkjoIoOU1idopVZK4icIYlqeOKEYnMAT3FqDcUsLhCUeFJT4UyaJCg0rthoksRO8s0nJKkE+Lx9xkmxJpIFQp+d7ZwyDuaGI9FcHmNrPcUxRTgR9kaWEwgEIRZL05GoRpcju49FaXLcp5BKlfBcFooyKSf64L+BsRcNIwQQhkZMxhcYLoUCxJOPWBtTF1KDI-UAlQZCDEQc40hkzrKYVoaAZJZsdGyUWZCYUVzXi3LEV00kGFGymQ+QoWZXN5lKg4r895kz0kzmWZyf55gfHNIIiCxxjMnReIZLslg9TLnfNeaoa5LhTSThmX0x6ehogfExTkM2T89IkrJW40mFCgh30eWoM5vzyUyGuXSgwWD8U1LwQyiw39cgxDJc875RgAA81KRXvCiTigwArGU-yYH-NQrIAAq2QkEkCFKAQezgVaCiIMXOQ3Rv6slAAAanfiNW1YYojRCoAQdONkOVGGtUEi11rFV2oiA6p1vkuUKtteYb+v8aCQg1VqggCgADueqmDRANfoRg9BjUNzNSBK1NqQ1NHtTEAN7KzYerZNmn1I182OudXKt1ZTFpBxoIaY1XyxTJPZasuRulTGyGyFZXpOigi6XoBtKSrrOXyrkU0WSntrZiopcG3NwQ77dobVZcttqKk0CqUPNFFi0yNIXYuwVgpXWP0xJ2Odbr11NDvp2Ll16yjf2HRfbiY7uVvAIkGwYTQRhNCdaAHpuCz3Pw+FsrQ+s+V7OKJOso4anmurZAAVRIFkNohzOTaR-T-Dlb8B1lHWcwTkByhadIuYMkNsln0FF+S2jlkLSTcofb+Gjtz6N-J5D+zYv7M7TLmD2mgfaZmIvtjWWj4L203NUB2nRXbcH8cE3gmD5gh0jqLdit1SngjTstrOt9THl1ydXWoJjQRN3bsg+i2KB6mNPtPVSi9emj0WDvpdRWd6cXqcPUep9qnX1XPfX2L9DKhg5vSP+wDcxgObN1uBnZtTLPQbw+kODEnWTIdQ8I9DpJQAAFoct6rdGWfQmGyghYUDhzTQQCO-OIx0xWbLyO2so6pmjl6fmTMY05poLGJztahRx0rXHYUgMM72iLoV8AL2YGwDga9uCbzQCgHeLDQSRFYA1f6pCaoyNIJLbh-5q47ZIGyF0VB1t-S5GI0752YFfDOyXF20UmIiD2xPHu8LduhQI9djbKCaqMGfoBChhDlRBIsMqXNnX0iEO7GD8w3ZIfPGB34x5cPQCPMR8j30BY0cFkx2UQhM6ZBBKJyNKHwRCH1XoCXZQQoglU5p7q385OgiELg3DuDIaWcWEIQaD4UgIL0BDHz94AuXCMCaNz8whDLVo4sIfV4QojBogAHz32zUzqXek-E5bl+YBXoAlePzVw-fLmukcE78QAKj1wBgBhvlcm9AFbw35gteEOALbg3RvVfq7AObrH9xWQAFIvf259074PrvQDu78U-OX3vHfq6pUri30O-EAEIMQJ-D0nh+Wfn6p8D2qiVYfFd59AFK8wRfLe+glWiPXifjfq-r9X2PvoVdl4d83h+au29p4p34lXDfXjBCb773vz8HcD9Z5n236ugi+-MBniwR8KE8m+2t37W2Ba0YBwyyyhEVyvB+xdnfCZZab7O9v9RNAXAACswGm0fgfouR3m+ENP7doJgUXsDhn00F-ptgvDyNgFfjdptusvkM-oDilIQm0B0F0K0EEggZ0IkK0Frl1r+IQpACQGgfIHTqPrgfgfrJgVgbXkHiLlILAJAHDlQTQWQeQYPr6FQQAKJo5sGMFME85+IAByygvBtu-BvBXm3BZQG+dA4Q6OW+Z+UBdYbWL+TQh+BAzenYnCJ+Mht2uSkhL4psEhz40h1+shOh0B4K++Shb+Khvuv+-+hhEBXwchehJyuk9cMgBsQBf2AsR2rwg8BYTS9grhBsUQUgCBTAbhDqUg9+ygCww6kQ4GxmTmHhUg92uQQYVEc4L2ABtqvhdwAwwQfEQ62wWgFme6No-hP8joKKJRGKD69cegPQSR6ibWrwJmwQSRjhe+XBQQdRwiaCmhwBbcd+j+lA1yrRQQ7RJhdYbyWRv4oGMWEGu69SoUuQGycx0QQceKswix+yz8rmza2xaYoBk2-202K8nA68PAWA28iChcrg84xg6Qw2VciShYGoLIdcJqjc6RWkcICIPqxIMoJi4kmk-YvxoWearq4oko0oywQJGkkkoJUWforgrIbSJILguS7wNAjcEKm43igKARiapkeJhgwmA8n0QoAAXl8FMEoE1CSeURFqGEQGQPDBAoQGuEnmmqyQoN0GoLSTMOJgya8AQJyWSXqPkKoFSV8DCfcU8UyUajyeyaKWqI7j6tyWyT0A2k2sUZeuJnqXZLKcKbxl0WUCqTIHWhKRSdSbIOiWpIVCCQyXIt9rBNQsLAcp5KCK6VIsLP2N+hYARmnB6XaV5Jon6ZsIGSIAcpKW4dSWoGnANrhGxAqRqbya0CKZycbuqSyZqSysgufqeJIpgqAC4CIKsjMSGuaZadWNaV8FTMbDbMfIUUbNQKoG4WoMoFgsfASQBqYsyUqemRyaqc3mMcoAqWMfrqJMkhmWqK9FmWIeYKEBEgfFOROKIeQS5jmWmR2eCjOTIK9BOUEN-C4CmVucqWuK9BWbmlWf6eYNxspozEZiRvVqQJAjOC+QwN2TxkTmoArDvvSkenfM+Tvg+kKmNvWa2VUFonVjvleV1p2H+SIKTKabMQRIhaQMhbeaAPecEgYUhQcofjGdKbTFrFhdplKF7EdmbD6gZpFr7qgUgT6mBQJkftnEhQFh9p+dWSOLWdBGAu+N8XKVVjoSephAcpRISLRuGcJQYXMFGc-ERXGRJdRDkg6QiQyYmZXKeQOXuUntenJaQEyWMTWnuXOb7klk5qJnqW2peupqslheQZRmeT0AxegaZZpUekMHBcxmKQUYzIpSaIVhik6TogRpetGUFWOJetJQGSJQZfYApbWR2ZFUkOCsPOpW8d4JpbJNpZqbpfOWUPFUZbmiZUOfuUng8bmvgFbrwFbiZgRjkAyMkh6dkDqWJjZQhiaQ5SGlZZCR1ZhHZV1SZk5QOSZYebamoBVcENVQIHVQubmr1ZhPqQhuNfNSNI1bueCWtdtUNTtb+LJOaQIJNd1dtUMB5T+t5cpr5dVCJrxR9PSZlRmI8TJVIVoPJXqklfdatFYOtJtBpVhQRmQO9QFR4MIj1J9NoQwMzDaP9RGSJcoMDZ9XQPVNNF9DID9FRP9KCWRVeLlWmflarj6m9YZX2UxvgKmWaLhdQE4N8YQBGj-NElRDEFtbavgKBtId0F8YoG8DQKAHfqqPYGtOCkxn0TcNOWVWZSrhOXvAfELYUizYunfEDSTbgv2XlRLeuYut-AjSrXMGrfjRrZdUEJNmuLYG-HklEEQLTQQPTQoIzdTdEArb+GzZ8Bzb9YoAAJAe1zJHo3l+X2xUbihECKzKWSFCUhAqFqDQzQ3wyIkWVhV0wHL1nwxKzswxXpDkVZSxaGxEyNkPp3xHKgV6rFz1EPAjpB0h38WwSEg-IwXOyxS+woUVrl00DB18WHjV0TCmSrXBBnLJ3LB-n10qyNmDhYVlYVYWXkWh0FAMnlp3yATT1SUaXlrfxHJj3+31ogx2SkA1h8kwl3JPGH5SDN6shW471BXdA26vD73cUBG8XJyhwhVw0GFBnPwP0aI+Tp24VSFBwbQcpJ0t1t3T2mQJkA0iXn0BjoEA7a4izb0cgX1anBzypgMv2I1SlxmgPyl9mKnq1VkFW-ilkk2VH1HVGxS-0eagAQMpjdDXKNJG0WCpnnmqn9C5ob16jXCKyDymQ60MCML61MMWnrD5E9k-k8MAW3w4PblHK6UMrfydhiMGDFXcHk1bmU0W0016g21MBYiSB6oiDjUdmJruX4MLkcMC5Ek5wdnsX0PcGk17VlAqM8lqOeKW3W0Ro92s1gBQK2Dmj-RLRtk82gBmNcMeMjSGPRDXLmkQwmP2PpCMMNHgiQiDw+FElN2xNXVqgQw2NMGHVpPpB+03WLROhgLB0mifFNwZGvkJoRP8ODl4P3L7aNHbYvYMqbmjWBGrZGFaEcJVNcN5NlWa2gDfyhBsLCIFnPa7ZO1AVtxpxHaKPXrIokMHE2itHqJFnSKZGtFcPZMPm77LP3B-70PxmaKgxpro3GO+4mbxNR0RTZITjHM+SnNWzJAeN3zLkOEhI2hpxPPo2DNdbfyuUQIeO5P0NVmyPKqqplkgSkCGgkA0Cxqtz2z6xaBvx5ZZqWqHmsjFNkClMC7lPfEIIuG8WuFc1MRP0vUbIEBoOxmwltxqVkuPW8QUt6MYUEVv4BUpMRPY1YOq2SMCNqm+0iBKNYHeEa0xPkHBMWNiMtHpPmB2OyvhORNrjROE2yvBDYu4sksVPUavmhNHrbN8t1PKv9O+0XkmsDMsNsM1noMmh3FTjHyA34XPyEW1k+GuCYnYnwymT2vZW43YPxME1q4WW6QRAGyJCVEaBYk4kH0Ub7ZHKRueszh-MSPmmTU2bsTZxkBRteuKPyuxMBt6tj5J6htSjIqWNZuJvIXnV3kMqyQlvhuFjsVj3inWs0vh1JkWy3DTAPXNjFA0UfU2tdt0lNj7CGACrDOODdKz22p3wBX2QyjTtNATvt0CWniLu-izu8XT39jjsgijhpjrs3oDs0sC4pUw2Mu7sjPI3g09ujvJugCbuDtfU7u-jLuen0tziHsSNzvvvAkZW9veCXvSD90vsjSPsnsgf92p3D3L2vsggP2gcbvHvSmpy-2P0XtwdLlpJD3nsAdjszvIc2npTRSPaIdfx7t3FfvpDgcofolkfBDLtauCVUdLqEdlMNzav0dHkQsRrphIYkCwvwv2DCj6DKCm75YBWEv+WuB21NRTh8OGv5WVU+0dvAgg32t438stvGJ105DB1MRRBaDB3lHomyfqCGSXRqoPFeoSAkBGcbIerYXcg7Pw7YjrF359T7MucAZuLX3IoC7o1KC-S3ZJ6+fGVJ6AsYHacBFVBhB6c11R12fGdyIrGCjxdd0HJr0e2bBQz6BBd9RGaGfB2vAluXDggkBfmLmR1FcbJUqsilfRDldfgWVBANflfHXBbYaXSVYWCmduJoLHiWesjWfZo1fZoWpDDOdMZrEbGefxalEvBk1gB9eqCSNmgi2+eHL+ffT5cXYVUTn0DpeSEHLMqbeHe0Q13Vu5rTp5d2AFdjb1dMAGxldRBBINsBcY17cnW-heVLd6oyduJlVm0i0RfCKIHoFMZXc4U4VRAY2zBGYPo1c2OTXN4tcjQM5Hi+Ssj4Cw-5cyA8dMAla5pnU41sRWD-TCwAxHefk7jVZexemU-aPPwWpquLoAA6iCVgN0EIywWg0KrPtqHPPZK+WgD7-3J5Rg38AA5OAFRPQJ0N0FsNz1YFLywwuRzyFgL7Kxz04llG4JCPIFlK8EfEI1r8EEL9+TpuoCb2byNBb9R4cl7Lb11vbwxxIDFFFp2Db87+YK7w7w-D70en7276SDJwbzFCVwREfHkazxr4HztRz6l6QBZ4r8-GvfH2UDr4zCn1ILGhGj0Hn0wC8fz2q671z0QDz2oCvj+cn4N90NuFr2X4TJX6H-r6xS5XZ3XxgZH8RIX8X0YAXo71UDH+b8-VITbSQn3wcp2LX5T1F+k677P5dK0Acn2Ev-X2r2b03zYilJ2H33eO+hP2M33yP9wXHxn-NRz5vgoDoOaDXR6SlFL9OFoFL68FL1o6-6AFLxQDQJ-1-1EJ-yl7jJABsaeQO8Cl55Es+9sHPs-y3Q3tVo7wFQJZxL5rVt+viJkE-ysBaAcsWgRAfij-5b8mMOfPvqLVv7g1SYo+basH0oR18pQrdEgKCDwHIDT+e1c-hfzEJX8RKcLVlrAQwHcCSAgA8IEQHaD6BABLoCUBJAjSACy40gx2PQAgFq9OBslJQOLgf4YCKeLgQQTYHqgzhABuQSgGbXkFv88gpsQQbkBv7yDIBhbQPkoKkLHhqAh4GcGoPuBS97BjcXIIANAyADlACgy-oghz7mh4gUEfgYwKQHLAUBVAp4oBCl6BCHsOWfgTgKYEKACB9jagb+GIH59DGDg3IBQO15EDaBJA-gZhVj7DB2B6vfwbQJCG4CwhKPZTo3xy6MwDQQoNwGJBRRqAqhSQiIRwNrZXg6OHQsIZQIF5pDbUTQloYs16LRCEh1Q-AYMPZ7WCgg-Q-FLMPILDD5qMArAXANRqhD8Uk1UekEFd6a8yhTmNAcCFGGThiGvRAISkRlL0DthzAzfnMMOFHCsCUAxaAEKSDUxah8fE4ZMEf6XQ8uxsFIbb1WHpAc+iw5AcsIT75DKe8wFQXcPCEsCoRTw54ccIqEwiNB8Ir4cCIaH2wzhrQ0uhiOmGXQuhZ-HoWxDo6EikhkIhfmMTxHjCtSj-DQYkLCFAjc0IIsQpSIGF+C1W6wm-psJWiYjSIDwg4V7RRH7DD6tOMYRcISYwiSBGg4oagNKFiiXeaIy6MkSS73AauJImkUEHX4r9n4NXB4Rf1d5hUkgJ3Wgf8K8Sx1ERqQz0Mr2WA19O+c-BvoQJ7KWijRzwtgcqMXSollsrbFDsRzZgHtGWzpESkwGpbSlfyaSD9jPUZa+tky-rZyoGx9Thjda2TUqrk2bzXMzk7zGtIfzNbZMCmuAWxPyT0RgwSxFYssQdDbJxcLuXdHbLFxT7aNvULPb0WyOwA58aupYjAV4Lf5CCRBFAEAWAM8GfBpBcEVkekA54xDzBWgIwf-wEFv9exX-DumaAgE2i9qU3dgQAAZzWTmS8nq33FYFDxTQFREAA')">function analyze_return_statement(component) {
    const rfun = analyze(return_expression(component));
    return (env, succeed, fail) =>
           rfun(env,
                (val, fail2) => succeed(make_return_value(val), fail2),
                fail);
}
</pre></div></div>
	The execution function for blocks calls the body's execution
	function on an extended environment, without changing success or
	failure continuations.
	<div class='snippet' id='javascript_90_14_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=4&prgrm=PTAEGUEkGEAVQFLlAFgHQGZMChsDMBXAOwGMAXASwHsjQAbCgZzIH0q8XiBDRxigcyIBTACYAKIlwC2QxgEpQAb2yhVoAE5CyBdbSlcADmJagAvAD5QAIgBU3XgOEibVgDShJM+QG5sAX1wQUEJSShpGYPUqKQgYeCRUNABGNAAmXBDyalomFgYyIXUuOjESaIMaISIyBWU1DS0dHMYWIgIpACNC0vLK6oVQAB9BlXqx0FzmdQoifh6pCuF+1WHR8bVcjqoqOiEuInnFqpqhkfX63La6ErKFvpO1VfONluIRITwZ0UP7uV8AzJhWj5QrFFgAN2KBCEPyWJ0U9TWDW0ulAtyO1X+GWIWRoExaZC4-H4ojyTDIYmYUjI7jIAAshCxCfxakjNCjmiwDFwKOpKWRqQoAGRC0AMrjiKknUwy0D0xnMrH4HFA-GtaQw9G-JRsxqo3LMkkiMnMWHHdxWTxCKx-fzK0LZUCMACenR2bA4VrNyzqanZTTFe3EhIoN16cLktoC9txei4AGtGTw+IIZNV+dNZu4hAAPAyaBw0Vn1f2ohimqzJxxpshuJ1kTP8bN5gt8ItYwGO3JV1PHb3w3UctWG0nlilauEWntEGs2jsqx3TmssF1usN3CM6kt62ji4M8kp7sQh9cYmqRqMx1VL44QqGM3P52Rtg4T47Fv07wMS48H3+h-sLyVTs8Vyd4SDoLgiiBflBS3T8hwNIkjRNCkpQtMoiGYfZWHAyDoOyG1TiRdYkOJUdyVgmlrEhaYuA6XYWDwqCuCBIjVgBBc8WYgiaBXV0thKKUP2RAMjxPMRxL-YSgLtEDaB41jsjvOhoRYR9W2yKiRNLXcg3-EoJJky8ry7FpIM6EQuHUltny04T4NE-UCWQijTXQ6wLI6KybKfQsiDnOSuOBaRvOs7kihkAp1EYbTHN00B9CMVdBI9dUZHcKSAOM+cHTxLyfK2ERnTi30nL0n8JKMgVzxM+S1V0ldCQKGtSrWBKyJQscqItRrsJa45As4vLaEajS7JoNqELE-TqsFOrgrVTCRAoIFiim6bnKZVzjW6jyrGW1bsjBcb-PYs5nmHHbUJ66xDrWugmtYoRZ0ver7uOx6nxWkhno28r6HJFhNDwW6kjexaPpoMFMMYIQAEdoXTByyoSsdgY+W7Ughka0RoFaHpYYposkShwRhFH2q-dGQdujAFtxyYEaRkgKZqnSv06ty0Jqi04cRqpWaG0y8X0RMV2ZwW2epeR4upyirH5lnrXcKUfCC3Glalp6BuqWKUbUKmhyyoT2Zx2Ngl5ZgdZevs1Y5439Pt3KLYLVh+ttvWqNl1Gvzmsh1eGi3chegwyGdCWBdIaWA4dgNLgIa5vfN1Vckg62Pda+25cQlorkM6SavkBng5aBiqBIeN-oBrndso-by8r4X6sb+MWCKkrKe3R3KsL+bgMW7sDAMBhfpgrvVA6lzyLr9zeesQwR4oMfCJTx15N8zTJongGTe0te8Sg-hN4mrD-oSvf-dk6MgnkiI8CiGIoDgRBkHQFIMGxRmCXUaExBzESNcy7bF2Psf+CgSLjAAPygBzGYWUDZoSgEgWMAAXKAQoUQ+Q5gtFsHYexaCPiEOQUQ7hNCswoOTEQqDhYizjOLeSYgIoamiowdwHdsxEHBIAtGCstRvBYPJNwKDnjMKioUNhoAOEYK4QfTk-CiDGkYXgHhnNp5dUongDCvQBFCLkcEYKXIWLiJimIFRjkAY00xlo0A4MXaqg3h3MxqihxWNBjY7G9j16GKqOCXkNBWrmLKpYoGtMbH0wHrjMWjJGqQlUpqGgBQfSDgDN1KwsT7x1kwkkmoXjQItAyfEsQcToQuPjuo7mxT7y9R3CpaEzdFqFLUtkvsJShBlNRHvNpkZIkW0FnQKgfBZjqS4f4mcfZfEdNoBJSZeTaCfBiqwB+GoxCTIsRffSsyNZ9NIAMuG7cSrLIyjI7hShETdwDNyXkZjIpCE4dwrEsMyBygZOpBY4cRl+KiOM6oZgPCJzoL4OhiUEyMiORTASOxJFtJ9ik1EVy+QpShe4GF+jwX8TXLFcFtRzmbQquIbFczIgajqbIG5GocWGwuaiCShK7TAtzEk40vixlZ0hXQaFxRJEdB4A+WR6zqZVH4PSSk7LZYylMPQIVIq4nyBEWoGBCKxDRMEbc0VmKUVcrkOw3lny5DytUOg3YswRVIo5QoAAPFKk1dIqnmoNQqjB6gsFiCsAAFW2CCogzpQBH3aMcCIjACDDwYKIdBVhQAAGpkGXVjVMGY-AKB4E7mKhQ0a6wRujQ6y68bZhJpKrKyM2bQDoMwVQPk7rPV4CEAAd19eofg-q9ZOmDUvMN1go0xtjc8XNibk3qsErLdNFpO3FvOL2-Ndri69NVAMqg8Zg0YtSm0gdOx7mAPqr4vI2wjBrOCfUeqjBfoHDNZy81FjzhT1aAC1d9ru3rBgVuudRgx3PH6YMhNnzWUTNkfq+94x0FmvgZKo8p6-3-ugd+cQhbX0AadMegyt75C0j-IW205wAjnCTaAVZXDgMvIfO8iOLLvk1kAecMtiL2UWgAKpEC2G8DwGpAoYYwRyoQF71hPOJTIP5Czrbgtww87NCUj1gPRae8lMhtWwfOOimFUn2nofWJhtQqnJ5fifTuoTJdrwOEEEu90K6zWaroOuixm6uHbqoLu-l+61CHoQ6e0zsLu1Xvzkh8D-7H1WefWIWTah31DOPiRgJP7uFefvYB9l+HQOpoCzAuGrAjyytM5F-9gGENGVTShgCaHfCsZEdhoT+H5RvLDsR0ZpH3ycfGJR29tH6NUEY1aUAABaNrvr9M-NrMp8Yfg2Nw1q2Mbj4K+NWyWWqrZbmvxiYOBJsVimZMQeePJ+8WLbk9JEep0AO2EpaZszppUt9gr30frEF+CR35oBQF-UuXJphSCOuTQRwUzHEDjltEcs8KQhAtPmCgT2ybWn0QDoHlDGSA5Hp7ZqWkQiffxYh+HJluNg+e2C07fzuooLSXuOsag9z3uW+MNJJ58eqBPET1wOOFYIvJ6ABFVOacVjHPTscTP1hpITtcOs3O6CXWJ2MNJK1GAjy4M6OsIuxc+ueIL+oaTKPk8o92uXag0n6HpETDojA3Aa7pFriI5xVeqDSZG+nah-7uGdAoCwsDO0y+N4DCsbXzeqEt6Aa3ZhLBwM6w76nnOFYuHcOMd3nvbdwJsB71Qju0nAFdzhnBHubfe9AGAP3zOKRWAAKTx9D8nu3Weo+gBjwrCV5u89e7txKpP-uScKwAIQynL4nsPKfG+Sut7XoXCsLW55b-nuBVrVCd4z66i1phXcV-D6Acfw+S8VnMH3q3A-QCWDn13+XCtzAT+D-UKfKft-r9H1Yev8e7f1Ft6oevagAEoNtKjx76PXsjUMxyswIikqSSDO4NHwPn+xnVgf0Byfw3ioA6AACtiEA539zhP8QhK80lf8Ic6w95kdHcxgkCXs75bRsAgDwcXsnkcIIhJVuo0k3gPgvgRA6xyDPgnB0CVtng0lIAiBaDVoJdg9mDWDw56CGCA8Kw9cWBYBIBycBChCeDeDu9+DWJ9cABRenAQmQ8QiQtXBWAAOS4FUPj3UNUPS2UPWHv3CGeUwMZEIOqFf2II-0MDMUryPBUR-0fz-1MNjl8DwKfycNJQsNgKsLwBsNmj-BUW1QZwcIhxYCcPVmBUXjoAjmMP-xgj+3rX4DHCmV9RDQjhmE4EUUKCiM-XAK4EhCPWmDDn8xWxiKh12BrCUkmnhw327SPiSO8DGHpUPUaAMC-Wq3TGSMZSqGZSqzC3TFfUXm6KYWCKwMMWcy7WUJiPcLAxqMukGMUWGOAL-1AIgKgMkQC3qCmMMJwg8KULUDK1Dg+VCx6xMl2GeTK0SLAJOl6J6z+SS0XWONahwJOxGjO2iAu3iDfkwBwGBW7E6EAjOUaOpU5G+xujfGqCnBDWXkqICmFFFAdUuBWQ3lOhfEAjhImPHXZTSi9GRNsn8jRPw0rE6CsCJVClCLpCoGXjJXBIHGBISNihpN00XEkCiIAC9GQQQihTxtRgkEohNVYCASBWZSFggDx88g0hShBvhOSwQV1GT3A8AxSZ1mTihnR2T0oEkNwateSvx+SW1JSRTFTQxk8HUJThTxA50F1WizVSVb1sSVl5STk9jxgjS6AmTD4WS1SOTQofIUStJGSLFUdjEtAJEscfTwpgzWFAICs1BuMO4wzLJrInFGSYzVA4z4DJV9hVT2SxAO4+sAY9SzSpSRAFSxSvdTTBTzTlVQVYitIxEQyYp2F4jJlZj71XT3TaAsy2TGQtZo5k4LNFpezKBigoixAuB2FyM8UcNfEBSDSSzRTjTK8NiuA9SNi3drI2lSzQxsZyy9CXgMYORbSNz7xdDeDEtKziyxzSUty6BsY1z6h0EOhCyLzDSDxsZWz-12zUzdskR6o-N+MlliAyFZBAKsJJyNNc5r0k43Zn85UIMYEALn9X0jVtMhyKARzDkJtn8PzeCjwYKQhi4cL70JJ8LiBp0kQdtRsyK-lP8uyvTVYi58z3Mb0CKIFY0fNwRK8aDKCHUULDtbCyLAjaVBKOzfVPT1TFIYIAzgluMgNJVJLlIzVoykRuNwQMyxLsyYQFK+I2kT58TGSmLdSZz9TzSbz88x01LiB+SNi7Ubydzbd7MGDpxX9bSTNQA4l11vyJDRMXzxBuKnA7L8yIM-AiLVslSmjFo6L1Sbx0xpKVLDCnQYtMzutlwlKUz4qsJnlLLaBMzxKYQYrWBdK-TJoDLvy+TjKizXzFyLARFsrrL71bKFzbz88ER70ggbAkgbBZNuMdhjQ2ksdtgrSXLjNqMnSvLajuthr7wGt3LihPLZMfK5zbL7zY0xAWqxh2rUguq9z-1nKbSRq1xQqdq9zerryMTjqLrAtZFxrLq6TXTUg1qbqLq-AgqMMjqmrRKoqTD8YjpoZuTNxWrcU0yEqDB1KvqehFFfqWSHtRBoSCg0TvzuMSAwa8qIaCZPpQjwhJZYrwx3x8zuMuAUbNK0aoawRiZChSYIcEa4VaBny5yzLdzLpQarKZzYMggizeA8ZqgZgCAYTghy0MESklJZhzrY0gh5QgjYax4OMyAqBQAwCQxaBvpSVYNhjSRNymr7LzA1yDRf4YRlbulRbvM0QQg6bTLNbTyotfVTaKrfLAr3q1Bb4DwdAONskea+a8ABahAhbKARa2awAJbvo4ahAABIEOoGts8K6MRzfYNgAgXCYhfCGEhk3G5JC4HwsQJmKOVmAkxyrm5gesGWO47G1mG2GsFOrU-oJ6q9Q4iOXsnO+2V9GBfOZClIgwIYubOOhOiCFiIELFLCzOO2Ri50nNY9LupiRO3u7IWKFa8YFVeumEGCwer2e2WSeoAbIQdjYbK9bS18VOmobNGBbqXe1-NE7NdBfOb8gIaOyKvKg8poMuvsOK+objdQIm7ssQMaPE1E0qmm6crhWc829sxm54N+lmgB1Wjyi2yvSq8QFVJpGEOJQI+6kej65UvEEkVgI+WKQmsi+5QB4shmwGqlKcvnMc1ikRc8pa-OMykRdBI8XBsC+qvQ9mi8zmt2toD2gW+kJga24gFaschtQKkBnazBomBtWKCSRh5DWe7tVm2684VhyU9hxJd2hxctWRsWsAchHQPgcmNEEcuUOWsR7BzRy6QR-gSRV0+mERhR9YWBphHkPkI+dwbB1Bux1Qax9x3glBh2uTKOu7VUXMYheOpMKEleKooC+kghqqt0gVSCmI5RD7Shkyy8yI6IkYjHEad7IgVxiR7x9suhpaHRRRWsyJogNih9AxF-JxeHYo+9Lo0px4vsALDeesqM6ogLbBvxhzHxG4wJD7Z03MqgYqDGINOgaiFBpchghx3IBB4Z0ZgsROE4TRmBBBzG6oPsDuMZ5Zy2hg9Bfy0hTR3xsdQp84UtZ1ctHJi0YgeMIgKgGteZRacOdu9rTrTNe8qwYJkgUJomcJmE2heqL6v5peCJveyu2k2MhKvAd+r0nJ2MPSn+-erbF+hK6Rmiqwr6vJyx6muks2whj62xy6GF8B8EHpvfeIqZmq46kxiR8hvBo2y6+Rjx9ciRm8mx6lllsYb535yIuGuHICsxiDbp1J2J+mcllbE55Qr85BG+3GYF0KVZPMQBJGgijFowLF31Tockyk1mWKR8FFqc-F2JlqkReqBsCOYQHMccCkqk1zWNZipOEgW1vVvZqp10ta2Deh-SZ13V2QOQZhjx2BiV-9NayvC11oRlRDX1u1telTERBKCNq18cViq+9Bzs1G5+0h8yVaUEf698B1GBYFmU-N-oeVdBREmQQCQtjS7sjU6t54CtloXehty6Itu+ltxk8ttUAq1t54dtzSomFKp+5F7t3IKGFkvt84Adutid9aLtxttUAqayYq8Fs8N10AGdr0vIcMxF-00dxdrO5WKdqp4FheykEuns5qGHCu9dvZpt9uAZSuE9yDYF1uF9tQB9vqa91qBdtt2t7d7956X9g985nt-4v9-tgD6KiD0D9YB9vlsFj9+oLd6K-5qSuDuDerGkxrO5h52gF0aoLgH3TrL6wFyKzob29aR8fB0V+c4B4h1QP+8Gg141+jgJ4FRCxgHYeOrSGYAweO5I0KKjkoCKOGV1BETNCYIgAT55dNXbG0ENi4gZHlR6ZpiEmyqB5NomCZimpScmfPDymy-PQ5kQT664FcHjvuzOmTwTixM4p0Kz6ev5S+kO38weTZ3QMEPzfj+O2kdQCOIkHkCp4bYrXz55avKwCNoLmYIiPO+oaL-gYLx67bQbDjeLtQYTuJRxmKGEKwSTztcLztCNPwRT2DZTq4tT-p80f2rVroOJVJ3gSBuajwRlHTkmfT9pSvDLnNJz8IP5JVKB7j1SPu16-9DqTz6GvzKLgLomJL2L9wbT8mrz4HMb54EK2rrL4oJql21WkzzI2g0QWDNbnbHbGYDrx6PzV9cLvxsNhyjYqXSCEqKwIIc7vT-nRXNblTQyocTQcmXLykPrsCpUKiizsTwoP5CNLliDAAHWBU0ERl5H1spWh-vTh7pOvwME3bq7DfQQAHJwAlJGBPhRAGhEfNA8eGidq4eBtUfoe4f6oZBKO+Rc2pB3AAFAS6fxh0fs2oKSgOeufY0efIN85BfeDhe0EJgWpYt9IBexe1AJfIM4F5eVtFfJemeugWeWpct+eek6eaeVeFG4eHPiBweRAXOAUqfDfufgVweWAa1y1xAHf1AfsUfUeJeEeCAkexBr8yHTeoI4YzO-guePfmZveNfugjx-fcuzOdexBnfXeFB29-lrhg+bfUXMr+aBEE+-ko+ZOA-RA0+7GJfo-A+-kJJS-C+reQ+-7uojwE-UJkHmtSmE+i+9CDfreLq4eH8hAKg+A+6sdKI8enwDA8f3A8fPb1Ax-QA8fZbp+Z+Zhp+8eOhnQl+a1Vo6Q8fg+GfFo7eR+P1CYDA6QihxO3fLrQ-XEh+R+2sj+T+hB5-Be1emaC-7fHe1a++obkMjfYM7f7niAuRj+vKNam32-609O+1PXAglT-5YRB+poPHtAKX7MACA7waoEv3zDsBnw5aJfmPGwHpxGAW-Knt3wSr-dtcsAikHjxIGIDtAK0WQEv12DkAXa+A8fnsADiIDdgvffAdvyFbW8iBmfKCJQAgiyAyBYgPHvwOXi7Al+8oJflwAIHHUd+uMO3nwAWCMRoBAAu-mG0Y63UL+qSIfkoOhxtZoBN-QAXDAf7F8f+L-BPoIwEG7Av+LLJ-qIgsFv9oB06d3v4HAFyDbeL-VQbfyAFn9XBB6RaPoGdBdAbITKCQM3zUG8o-BEAy9F+EVbeDjBdyMXvYNjRBCQhjTC0kP0ME+CTBu+WHtwLGAJC7+eQ5QikOOp79NAH-Q-okOAF68FeFFdwRIW0Gog0hD4a1kMUUFlFGQRQ3wSAO7Qd9GhpQzwblwlibM+y0Q-XrX10HHApYpg5IeYJGE9DT+JQ7-iURf4kDIhp-PoefzcGDChh9UO3hsJyEwgJhdg9zlEnFzpD2hCxI4YkNOFDDYhQ4RVrcOKHzCJCrQ0IUMW6gUDCgHQIwXfzmFo8Ch9QF4byhWHi9gRagCob3wP4Y1jhtQtvhLz8Bh09hYwZoXGGCFtCwhdvSwSQJcFd9dhqIhgvIIth29wuNnWTvcI8Yl98+MfP5OF2r7gCJeslY4ANxf5wwxhOdbYasM-Dk8YQfvWkYHzqE186SHIsgIyL2EDCiREGEkoExVJ1t32WbYGpn3jKSpW47cEZiVHSoZ8C6T7LlHcTHrNZu6SdaznmURoJV7AKYJwMQSdysB2AGRacNKQrhapzRKo2FjmTNF-02ODNTls8A6A21rhPRL5H0QpB6iOU7gS0Y4FECSIWysGYNmg3vT0o3EYgZMamNCSYxkxI5SziN2nrvYweBfdQKOih7Sj-0cPMkbZ1DFD8pB4-JASgLIBr8N+kghkNgNYiAibeePRgOwIMBMCF+RAJsff3H491eAW-bkbdTK7uCAADN414LvkhWs4mcfQTsRAA')">function analyze_block(component) {
    const body = block_body(component);
    const locals = scan_out_declarations(body);
    const unassigneds = list_of_unassigned(locals);
    const bfun = analyze(body);
    return (env, succeed, fail) =>
           bfun(extend_environment(locals, unassigneds, env),
                succeed, fail);             
}
</pre></div></div>
      </p></div>
    </span></td></tr></table>
  
  
      <div class='permalink'>
        <a name='h7' class='permalink'></a><h2>
    
    
      
	<span style="color:green">Procedure</span>
	<span style="color:blue">Function</span>
      
      applications
    
  </h2></div>

  <div class='permalink'>
<a name='p25' class='permalink'></a><p>
    The execution function 
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    for applications contains no new ideas except for the technical complexity
    of managing the continuations.  This complexity arises in
    
      <span style="color:green"><kbd>analyze-application</kbd>,</span>
      <span style="color:blue">
      <kbd>analyze_application</kbd>,</span>
      
    due to the need to keep track of the success and failure continuations as
    we evaluate the operands.  We use a
    
      <span style="color:green">procedure <kbd>get-args</kbd></span>
      <span style="color:blue">function <kbd>get_args</kbd>
      </span>
      
    to evaluate the list of operands, rather than a simple
    <kbd>map</kbd> as in the ordinary evaluator.
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_90_15_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (analyze-application exp)
  (let ((fproc (analyze (operator exp)))
        (aprocs (map analyze (operands exp))))
    (lambda (env succeed fail)
      (fproc env
             (lambda (proc fail2)
               (get-args aprocs
                         env
                         (lambda (args fail3)
                           (execute-application
                            proc args succeed fail3))
                         fail2))
             fail))))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_90_15_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=4&prgrm=PTAEGUEkGEAVQFLlAFgHQGZMChsDMBXAOwGMAXASwHsjQBzAUzIH0BDAJzoGcAKVwolwA0oBkQBuIrgRIkGDACYi8rCgBsAlKADeoPfuz7Q7JgXa0KXZkQJq1fAVw2Gj+gPyhps+Qp427yqqaLq6gAFygABYMrL78xE48YpIhoWmhIJ4yclxcoCQ0lDaslDSgeFTsoGSRlqDxRKnpzaB8nIHqAExaALwAfE0tQ4wsHNw8ZEEOCRpCg0MLoclzi6vpmV45eQVERQQl1LQV7PNri5kmJGZcFOIM+ax21VT0TGycXKdnQ23cHWoYXoDb4goybHw8AAOqnYvxEYycK1ByLSKnUgKRKIWaLU3UxoJxGgA3NgAL64ATkQ6iAAeDCuZAYbEhkLUFBIBxoPAE8I+UmyPn+Wm0qRMZDMFiskPYFAAthRKHdmJTSkRucRnOkPODFHwWWoAJ7MaVyhW3Jkqw7qoi87izL7NQmnCKWZgFWWQqjEBTK4hUrkCLSnDyWmjMABGVAUButGh4DqMDBpjKIPuSFHYNFlYjI8ZBoaIxo4rGzjPYvED+NWCKriwLzHTmaI2d2sftqx4kejzBM0jUZH+3VA-VACdCOt8rrFEuY4keBAYnajRt7tjIQax7mMpnMs-nTJ2KdzXZXDD767Hiwi3oYeAoREUtYJQTxl-KQU1aQiDHYmdhPNAAAiYgAGsiCoAB3I4-VVaoDUhe4AFpEKA0AAGo3zSQCk3pAhGWZVl2U5IhAOJMlcEyAs8jwTNZQgGB4CQVA0AARjQToKRg6lXTZMtHh4d1PQfXZhVFHdJWsAhZXDH8BKoD0aBzLRQAAHxUhNXS4MgZSIOg5IU4T1z0NSNKsSMqDUGI1UExSRNU9Shldfx7BswzlOMhyWldG87wfXxXKUklyQLUBeJ-R49zUBd9KEpSdCMMTxXMfJ5Ni3Ygs40hYNdSY6EYH02S0ngtNlAdqmiZhctEoxp2S11oQzYqyFKrQADJWqiGJfBKoyej68qmVyjL8C4sonJLRcArskUavE0ActYPLFGYQrcymsrAKICbSIykKuANaSLOYKg8GsCaYtsoyZv0WraGiWIJimdaNDI8kRqy6lZVYECmVYXIKDoZscyanS6BEJNpTPG4aGqm65tWnhAL+m5AZbMhAKkbT7zB2lIf+mHdtGiTkYBoHW2enREolearFy-KVssNbUsukQkf+1Gcx28iQpJjndmYfbDpc5m3Mp2akrurrHvUHh7t8SYZeel7Xve-1aF5smWDnKKmQh3toeskW4uuvRbs6h6FfsS2Lrcl7hpC10FHpNRi1VJqWrFuGJZpyrFvphGetZnYtNYfmnZIF32GI0j7NM32loKxn3Y2ucZVYcNLOYcPI+jrQTOConQGz13DgFg7I3sHrYe3b25el+w6+tqvlcJj6ymLqPVUihcGxpPGDeT6uzcbqYm+a9c7fI1XsqsF3pIUVhe-7q0q89mvqYWhOGaKwOgLn8MF6X-XDi5gu29offD+hKPSx-XhV5Ns2vshYry6Ok6zuzEQR5l5uVZCy+i8TyDzXsPKW1sx4tUnm9B2VhboC0mIyNGIDH5zU3v7JOu9ALwJDkgzm-9C7wL1lDFe48h5zR-pXMhKtp7cSsDsBQZoaD8QflTOqtM-bLQDuPIONBGGqgisQ-GJE86eWaOgrhmCeFAQYUwraagEElAYGjU+tCyiyIEQoyGjCOSMhQSEM2q0ey3mTiIFiBDz4pVTHIiKwcGAAEcFytlYV7amRiTB4FMaAborc1ZWP4YcCKjwyxbUVIuFxpt4aM2MZ43egJ7aF00g4pxch9GuPYfHDBO9pGAS4MksQchVEhS+j9AW+TSDhPHk4UBUSiq5PKYUzGpUnC+NgnkxxBSmS4OUTme+ZD4p6AMRQ8BUxm6tOpHecsLBunIJ6tU1BtcpZzIsX43s0zEE9N2H05p5DvaQLIC07miSrDKMhGQI07SUmVJ2TU72TlbBUJ2eMsas8-rrKUbMqpuyN5WGcvXZOTgaGwIjGoKgJAQJpPSRJOmkjsmlVZhnMFIEimF0ReCiMy5IWRMWRbUZ1CEmWNdKwfURE3YRPXhkmFic4UbWJYRXRJ8VmwXrEIge5KwG4t-vio5lixhHxITQbZV0hk4vlqPPFUCaGUSJtRWi9E4CIGQOgNiGBMp+JyuwaKNJq4UokuZSyoceDatHEMDwNJhz9W0guE1LRvy-kqEahFVALJWVxvSRkShtxyHNAoMIqi1G0BKRaImUJiy33LCIE84MJA6sMUnQCNlvS+nPhjTCoBr4TTLMIUAUbRAxueRJRNqZk1q25LGtBHCt4IzwLwhSSaCwossfWDN4aKzlu9u4kxNbQDmILeUImGLoxlrXrq0K0SPHchED4nlfiWUSAzFmYGeB21uPHV2kQ8Sp7FO+kyeB2toqHmNmwi+8a937gxlYo8TK6HGIlt3Rc+6GArspZw6luZH2szPTrRtqzxL3rdIUYGj7n2S05fYYDQLC4FNBTcXSDZ51NmQckED1QpjIb7ZMrSyob6LmQyOjlvh0MztgtBqgeSIwxhohNaN4hhQJXFtTBq-4cM0ZVsHMgA0GwenOfB8QC7NbDlAM5EkAbQBBuw+dQWFds2Pvmce9NMJX5Cxk-uQ5Z9Z04bLsp7kOG6MGAY8lOuVHszXrKMZpksmdMTT04MgztBrbmcg5YpMKY0wIcXc4t+agVPecjX9XWMb8PwzEHQGoSnpO9H6pZXSYXtZOATB4JjPBxPmfCxZHziIc3+d45+ZoERouhciGl7zWgAA8oUQuxcePFxYHgfx-kRgAFWdWJ0OBp6icCkr0rIJLFAREAuhG1oItKgwoHgGMUn0taDQkBVmg202uBG9jMbMY4svUvHahrgFmsvDwAwCCHW6Bda2T1wifXUIzYW2CLGukVvFeqTNi9A3LsoiW7d8bPA1tOb8aCqgIECCQi0xXe9xXWMjpCskFazqX54ZNq4PaHI1STd86ANbI70hm3uXYe7uWzh1YkFDqgL8ruuFI7BugvH+NIZjbjtYERkcWp6ObbqXmavIg8HXNbJO9D08R-85HmXrZfZJOkck6QxutGSIzzjpyeONg88KhY9WHXI9ZgAVSIJGb0QntpkVF6Ibz9w4fpHY+UHDgnMMsFS0RhYZsuB8-M0D9LVmTNPm+I7yzjm9dpDF-oX32LqaQ9+zD-NW7C4aydwox9oPUePDB3DiHBPg9JEC8b-QCPDUC5EGjtPoRMe-IeTjtN+PxCE+J8iMn2NKeIeBsh2nQx6deel3XAX9eFjajeJz6r2fHht4b54PnTdWezFQzLYXpxSRDdcBLlP4hpc1F1txo08vNY6vSMr2EqugIa616mHX2ZQDIXqOzTWXN9cMEN+jtIpvzMW4zFh63ofbdzXt4ax3AuXdPrd2cD3qnP+T1F1SH91HSD2h1nylTACojN3knlUYiVVYjQBQDVRnmNBlHlDCRLTdkDFuR+UyVhVzAAkAhNHQPNB-VgmILNCVDlFZE2UQStGwIWWpkoTbGGlNwoIwKgKZwRnmARkAjlgvX0DlkWHbFCF4MtgEL0EtmEKfF4KYwkIUwzGkJ4PjVWnkNWiULSF4KxzUAvW0JaBENcF4MYS4FZFYANAvWMNMPa2aAMKMF4I3wkI3wWFsP0F4K+hqDYHDC4AxncMiE8LyHSBcL0F4LQnkP0EdVAANCBFAHNRm2sKCLHTqUQjCL0AiKiOHD6BiMP0iL0ASN4IACoUjWgaQRB0iRxzV8icjQA8j41gAii0jojzUwB4iZD40ABSeokoyIxo0ANoqomoupPqHoMIhojIrIoY7o1oupAAQj6hGK6LKMyPNVmKZyiKmNzEAlK06NKJ6PKz0DWOULqVK2GJEFcFGPKNAGOP2IGI2L6G2O6LGPNUyOuPWMRj6BONCHOKWNAHeJeMOI2OmKKKyKMBHD0GmP0G1XmDIjYLQMoODXPkjzyB6FOGflli6hEHYPNEwMOEORhNNA4IHSoHDAACt3UkSUTiVrQxjZDYSwkL1mDAwXpv99BMSlQqIyJsA8SSClR2NQ4DlBMEZeCfJ7xFAL1hS-IEjNxXD41IAiBfIFRzDTjZT5TzlJSpTEiNjfDmBYBIAJCtSdS1SpS3CSg-CABReQrU00w0zcXggAOVYFtKKPtNtL7ylOhMFQ41ZIPA9L5MROHApJfjwDGKMxHy9IA0EEmC2XdIjPTVpKxN5P5lk39PSFRKDJHAZKZNjPxPjJ9KjJEx5n1CNDDILGtFtFWhQzpUNGYHvGYBvHYENCr2JNYDnHtxlDOTzDWDDOoMsjRmIljGZNCDGHLKJFcDD0sTyXFEBxX2QRQxczEDcz4xr1bEwjpXnKhDjLZIHSzynxBDDITOmWHwHKMFXNTHXOzM3IRKJNJPIGzW5z0D3NzK1lU2tKMAXy4zOWX3c1X2Gksg4zfLoFBXDEES-LRkEwnIB2rwVx4A5OlXPllRgKgAVSYnQCwFVVEyJWkhtmNlCHkwkTfSwt2FZkrNJUZVAHah3NCHGmzGtDVn5WEQIonjIo6gTGR2OlOi2mopZT7mPi5CVmlyRmkkAj7RLHDDdEiCoHZDPAYorI+GkoJT8VDkeANAAC8mQwoo5hYDIj07NJcJB+RvBHx3x1BoiJweB1KIpo9nohR5LYJFLDRVLP5JojZpp5NZ99K5BDLCQMiWKBRdRft-tAdWLo9WKP4OKnKtKRJWMjzUQPwbLqQ7KVK1KRLD5WUrQKY4c2Cw0mA74BTkrF4W1sryw5LUhTcTxcr54gFMVnoRd9BSqBBBMErVKlxoxvcA9ko3KsgDLPUvL+gfKurksd1sSuQCqs1I0AJkNorQhCQ4qyhGqukGlrkDkdU9pylKBHhDQ+BI018oVdLJBOqPLuqPwxiSdWAOq7y+B71BwgQ7z9Apw-1o9F5gMbq9BtRfK4hLqjLcRXS6cc0OqJwrrJqYrjKaq9BgCAEwDLdk0RA1lk05MMcK1JJscYbHBvrXAQx78rdiBMJ8swDLkcwKB1rKMMaobnrBCpZkaZgXyWhrYKbBAAC-cSqPT+1BBBNUS5qmklqQbR1tDrRqkEs8058RxxTFAEwcaic0SHoUaRAHNKaZr1Z5FEqs5nYS5eLnLFdaqmaGcmcO5iJI9iqjBTdxB6qmc5qeAdau5H06KB4lYuazY-q3qhRjrVgjbiA3KSdPs49PqhwRxc8zgI8gr9wY9tZWMubQQ7c3qeBhbDquhWqzhSRAajBpqxyFKFaHKNZkF0rGaYytbj8UZNY9bqqs6tJUdjb6hU7Fx06cx-1UrVaIqJ5ba5p7aurHber0gXa1RlhLwPa1ArqxjdBzgwB8iWJ8iFtTcLIfRH0BTnUArI8Qct8bc-aT9Z7gqvMe8e6BbY7Fhw7+rg7Sb0hoK+7XBMh8jOgR71Shh-avM57V697z7XBx6Prb6779AF7n6885ocROhoLQ677SRN7Rdoqk6YFw9y7wyAlmFNK0orocKDambIRS7TaNFAktETAdElFpLY7TcSAEHy65JrFNFwy8byY1b6a9BTcGgGrcGkGIG2B+wfxQlzQMGG7vYm6DqW7gQWh4HXbO6zgNgBRchL17x9hmVKhRB90DhdIKKWhMgF9YzFBSV7gyAXgiSFZaBtF70011zloP0vbrrkQNVop1HgMpHat8gBBWHBRdHucIgGgLHPKXwqb9BKIggzB7hDwhHiJyhRGGBxGig6ATH1gwBZHtEFGABIUJ+jNYIB5A6kV-QsL0Fgc2nE6SkdGfJJDpCpDBq-MhzWqpMChaxRPBLZfWtIfPd8njIh1JZZTCDwZybG+oFkNcuJ46PCJWiOFWwQbkYmmZYGZZRxloZphJtpnOVUXgJ+1rUpSpxcGGnp4pvp0h0ASfC-PJbJ7mqwJJ2uqB1G0ADwBGDZwsZHDBscCIYTIA5O2CIxD+YgDWXUMKuGna1E5gMYwCfI65k-RQQokQO577Wy0BtFCFTO2BmMsqpnf5wdGMQuoF4u0FDkbzMCxHFpxJ5WzuZJk8TBpmt5vOxQJEjUti2srad53wGF6rdF4FnBpSpqtF5h6mOx6OzQbyoYcMcxuc4tac4GYllHTF0mbFqKtNf6z64kRYc5+K0BnBDZDOkhkdU3dgcl+y6Zv9Guw2OuhZu25Yfayxnqjh5oGV7hvSzR4O3RsY0y8TL9aKbWEfT+-pgVuWsuil36TCiGHVLBxwVmyk9m+oaSMSiSnIJIPuFVxutV-lzV1ZkKbSI0B8ZMAScSyS+5loMpv5EgaNnIbZowEMKYFN-QCIOuRN71s8OMHht+vQf68ZowA+kcMN6wFzf5HNmNluCfU4M2CtiNtaFGrm0kG1xByVuHMp8yyBy6VGjwOahmPiPttyL4F0X5c6Z6fmodsK6S8dn2fZ+d01W1uV4Zjp5d9ICdtgE-CV5Vmd0Byu4h-dvLH2ah+RTd5oQd0B89-iad09niPKq2tKkhg9u1laJ9xVy90IbdqZ79tIa999v9qZwp2g3gJWBd10f5-90IQDtd6D+9rdn2MVj5YGRDq91dxWlDoppmE9pDjC8MGDtGzDtOzC9Dn9n2YihlTZ-tt9tdqjvs8j1wTbB1dadXIgMCSCWgfaXYVgc1I-Oa-1HmaSHx-iCGGjdyjVo6-uyJtq+Wu131yEfNvS9V+x4G4VszbpiyPCK0e8SEPCCskT7WUNcsRcQCXQZ7eaIgfTjjR7RZ0iBO-Qf8wC4CxchXRz1Ig15t2hkJA4O4aI3e0EMtzIqOn5+KuwAWbT0ZngPTgzkdX8zwKLnEwTYTUJ1IB2XYehiKZPWLsqCtxaVQIgbavQNJ6zvCfi-LugQrmOX2189gI0Ar+8b+ifA3FZ2r-QES0T+wa+PJRGCzwbXLwbAbUkBztNZzok1zqnHMBOzITr7WdV3IfVz27z4JLLsJaI9rgZpLwVQTJLA1rgbbumn+1YTHTL8wbLsAwCSr6rr5lzHztb80f+loeOtNWbozx4T61xzR6IqOtNJ7xZs5owe8XzhRZPTCXLwG4L1ZoYSwl2GMQCTIYHrLtQUQe1dgM-VYP+6l5KEwO4Uz4qQ7tTXAG-B5IsUzqoJnAbQt74AAHVExMEcQzEXCU4GWp7WDp50vBMhB2Y9cI60AiAAHJwADguA7xFBtxGeTABeRzNw6fJ82eFe9A6fillEZJYQFRlERBjUZPFfQgOedqebjVdeFh9fYOhMHljfQRTfmP5okFm8pYjfLejBrezfzUnfaeHQIhswRP1ekFpaphtVBXFe5f3e366eEviAevxemdhNQ-mhlfC4o-mAIJKhfAU-2A30bNg+xJJfFxwSebI+OA8kFA7ZjfreGeCAmfktVfZI65C-TOS--eZZ0-M+tAVjze7Ag-XBreb8vRi0W-BM6-rOi-FAu-n7rf6-i-BNrZJ-R+ZfLfy-alcw64W-t51xlA++fQW+x-kQQ+4-z66eYSGBPQbhRmBSk4BfIZIQBeRABfjgb-QABelGH-H-7wH+BfwwDR3+IIFRIgBfBWE+liJPlfzIw2ItEkQKOL1yz4H95MCMS-iYEhCIRIQEA-zC-wX5pok+LfLRifzkSZY76LvIYEn3AjEBjQKAqATv3wFkh9+MA03MQJZpcEL+dA9-lpAIBOxdg7-aUCdChiVB3+uiXgS7FyD-8Zeh-Jmnjy8Ln8ioAvMQcwPFCMIzw7-SyOQFcZcB3+MQA5MwMsjH8VBAAktqHxEExkOAlACOGeAkG5gBehg9kJZHf4L53+rAIQVKUAF+Ik+NwD0JnDoGkDIBi4aAZQJ0pwCXBNBRCHQKQFkCGAaAsPhgJH7J9U+bQIwZZDwGFsCBnDSIVgLoGAp5+1PPftQNl6iYiBffDwf5gPo69de1vbdAaBki9xXMfgPIcgM8HeDsh8Nb2CJSqEkCah-mU4mXxJxfQyhusZMGuTgFBDWheSMIasESHn13BgwhgO0JRCjD1SwAhAaAIIYTDoKLcZ3kASyG795MXQ8oSy18DODuyTIcYSEOWHpDFgmQ9YRsJCjOCcwnSQofv0X4doL+eSTLhUmGHoCzguQloUcJHxs8ZhaQJPmIPyHkCThlA+XucIuGJ9IhAIpYXUJ+HpdC4WwnoZUKhEhCYR0whtnNCaHIjPBUw7PqCAREVC+hF-MQcEM8GvCTeug-QFiLaEOCKR95SISANP7INARXglYfoGt6khwmYIvXpsLMLbDehp5TAdELEFpCYBoIrkR70uGRDcuMXMrtA3d4T9h+DfQTLl2BF3Ci6HGJ4RxiZxXDnhqSCgeENmi58YuBebHLPxL76iMh8mTUaqPOFnDxRawISjE1mqHsSU1HJVlsylZM08AsrRKjRS7hfsba6o+oC6yZxs1y6tocDiQ1jqqsVOQbI6q3VWDejdWKQZEKWUNYJisQIwd4OMAaC3kFeBbanr8GzQ4hAQDLY3jhAZC-RXRfZHkLSOaA1hVOdLDEHWMtYec9A01UcG9E7SeJuxZlNdD2P7F9isME6dapFyijRdCAEXKPlUEuxU97R7PbAEn2lFwCbBt-FgWwLIDf9f+1g6ILwJKBkju+2AAXlwE0GQgVBt-N-rf1XGP92mgg0vor1G7rCAADFa2RCvg767474J+LSC9ogAA')">function analyze_application(component) {
    const ffun = analyze(function_expression(component));
    const afuns = map(analyze, args(component));
    return (env, succeed, fail) =>
               ffun(env,
                    (fun, fail2) =>
                        get_args(afuns, 
                                 env,
                                 (args, fail3) =>
                                     execute_application(fun,
                                         args, succeed, fail3),
                                 fail2),
                    fail); 
}
</pre></div></div></td></tr></table>
    
  </p></div>

  <div class='permalink'>
<a name='p26' class='permalink'></a><p>
    
      <span style="color:green">
	In  <kbd>get-args</kbd>, notice how
	<kbd>cdr</kbd>ing down the list of
	<kbd>aproc</kbd>
	execution procedures and
	<kbd>cons</kbd>ing
	up the resulting list of
	<kbd>args</kbd> is accomplished by calling each
	<kbd>aproc</kbd>
	in the list with a success continuation that recursively calls
	<kbd>get-args</kbd>.
      </span>
      <span style="color:blue">
	In <kbd>get_args</kbd>,
	notice how recursing down the list of
	<kbd>afun</kbd>
	execution functions using
	<kbd>tail</kbd>
	and constructing the resulting list of
	<kbd>args</kbd> using
	<kbd>pair</kbd>
	is accomplished by calling each
	<kbd>afun</kbd>
	in the list with a success continuation that recursively calls
	<kbd>get_args</kbd>.
      </span>
    
    Each of these recursive calls to
    
      <span style="color:green"><kbd>get-args</kbd></span>
      <span style="color:blue"><kbd>get_args</kbd></span>
      
    has a success continuation whose value is the
    
      <span style="color:green">
	<kbd>cons</kbd>
	of the newly obtained argument onto the list of accumulated arguments:
      </span>
      <span style="color:blue">
	result of 
	<kbd>pair</kbd>ing
	the newly obtained argument with the list of accumulated arguments:
      </span>
    
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_90_16_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (get-args aprocs env succeed fail)
  (if (null? aprocs)
      (succeed '() fail)
      ((car aprocs) env
                    
                    (lambda (arg fail2)
                      (get-args (cdr aprocs)
                                env
                                
                                
                                (lambda (args fail3)
                                  (succeed (cons arg args)
                                           fail3))
                                fail2))
                    fail)))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_90_16_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=4&prgrm=PTAEGUEkGEAVQFLlAFgHQGZMChslAGYCuAdgMYAuAlgPYkDOhATjQLYQzxKpoCMaAJlzFy1OqCr0A+gBsqFAKZMAhjIAUZNgAc6CkhQCUoAN7ZQ50EwUUiTEhOkkirAEZKN23fqOgAPr7MLIItJKXoKJioSAHMPVh0SPUNzf0DgoNCXGhoZBWUSOISko1T04NCnGXVNeK9ki1KykOlSABMFAiiFVsK6gwBubABfbBFKWns5RRUZKQA3VSIFXsTvEyC0y2tbexqi-UGR0dJx8VCKZWjo7tlJCjVw1goAGlAKAAsFKQvoo1Mgqw2OwOKRaZRUJgPChPIwAMlhoE+yh6j2SAF4MW9Pt9LodhCcxPYKspWMs9n0TJtATsQT9rq1buEVklXgAiEgkhSsgbDY6iCagegAT1cOSkNAIUg5pOZa3+FmpwKRPQuVGqnlWhh5RzGhNArGUAGsvsp6PQqNESKT9FDIjFXgoAB5aKxmiZ-KnbYFyJms03my3Wiis17hO3RB3O13mujavmnInSf0Wq1JWXJeXmRWJnFXG4++7kzVs5OBpLcvG6gWl1P6MIirLq2qaj0Ar32ZVqVXqTvd9MGAdxqviGtB+aLL5Ol0KN10fuUttAjt5FXg9R9ovFAd4+N60LtMgyZQqQlQmELhXt2mXemM+6otmaBgXOsHo8nibcvwBJrNXO3gszxeUBWQWSJlBcXIpDfY9lEJL9UhGYd7Bgj86HrUV1FRVssyvXs1zUfC1SAwchwJAVULgiZxxkJYpCnaMJhIi8tiXREVy7Ai+2w7deV3AVQiPVxWmUeioxnGMCmwljs2vPMGUAh8QKElwRLE6dZxICteWQ0AVLUsEVFJaZ6GYzNZINLQHgbMUJSlTlXiIrDoS1Mj+XEfTRKyVohTMtJZKczjiJ4uN+LOaRszCC5FCDPzLzY84b3zO4gLZSLwjghQg20pDyPESKGIkpjpPMvCOO4lzeJ1PKcyfVp5AmVQ4vimlEvku9UpAuqGroVR1MYugEJ-X85IAlKlNZbrCT6jKYvLNyE1AKbGtmad6rITLmtYmkCykKwCE63gFr1ZbetmJ96AUABHJYbRK-yr12-bOoEY6BVOjlZlUaYOWoOZlnulrvTuPaOk6jBQt00JLpuvQyAByqZKvNqxqZCaYdu+GcrC+wDWNMJrsxhGnnoHDtuB30MbhrlQxc0nKxqwVCepqLMqDUySosB62MCniGfc+xOiYcJWbmu66bJgKONRemdMZ10KFFrKkg5iWkbYiqSbe8L6PiCghQJ2HyGJihSfV1rHCIKogNl3KBZBI8Rdm5Xxa183gQqK31wImWqvxe3MhkGgyENLbyZzOlkrRly2Ug4PDWx3S45DqRvN8wGgeXZEgucmFIcZ0JlC0LQ5A208M-D0ao-vGOQKLkuqDLz9tcFmr+qKucK6l7PNa1fnFuPaJ2801Xz1Knnyq4n3Kr9vAwGQxgCBYdgoDgRBkHQfgMH9xbziYJY1EdMnK8ybJcnyQ+jE2MoAH5QEdUAMTRN594UUBr-SAAuUAlBYSFHVjmfPI9gpwKEoN0V4Vh4ZUH+q0T+2Mcb6iNF8ZCahDKchMq8NODoSBzGPrJQCk1PBtCkMhEMH8RroOMkoegWCaA+RwXg-ue5pDkhIaggg+DkbSEjgpFKBBHzEJIAyMhLdCBtyodYGhahOEsUrk9MGAjQBHWYQKZCqd6G+VkZmeRINnpKNeqo8Q6i9BzAhHQWK2jPRsQUQdJREMdy6Txl8SKCxaJkjoIoOU1idopVZK4icIYlqeOKEYnMAT3FqDcUsLhCUeFJT4UyaJCg0rthoksRO8s0nJKkE+Lx9xkmxJpIFQp+d7ZwyDuaGI9FcHmNrPcUxRTgR9kaWEwgEIRZL05GoRpcju49FaXLcp5BKlfBcFooyKSf64L+BsRcNIwQQhkZMxhcYLoUCxJOPWBtTF1KDI-UAlQZCDEQc40hkzrKYVoaAZJZsdGyUWZCYUVzXi3LEV00kGFGymQ+QoWZXN5lKg4r895kz0kzmWZyf55gfHNIIiCxxjMnReIZLslg9TLnfNeaoa5LhTSThmX0x6ehogfExTkM2T89IkrJW40mFCgh30eWoM5vzyUyGuXSgwWD8U1LwQyiw39cgxDJc875RgAA81KRXvCiTigwArGU-yYH-NQrIAAq2QkEkCFKAQezgVaCiIMXOQ3Rv6slAAAanfiNW1YYojRCoAQdONkOVGGtUEi11rFV2oiA6p1vkuUKtteYb+v8aCQg1VqggCgADueqmDRANfoRg9BjUNzNSBK1NqQ1NHtTEAN7KzYerZNmn1I182OudXKt1ZTFpBxoIaY1XyxTJPZasuRulTGyGyFZXpOigi6XoBtKSrrOXyrkU0WSntrZiopcG3NwQ77dobVZcttqKk0CqUPNFFi0yNIXYuwVgpXWP0xJ2Odbr11NDvp2Ll16yjf2HRfbiY7uVvAIkGwYTQRhNCdaAHpuCz3Pw+FsrQ+s+V7OKJOso4anmurZAAVRIFkNohzOTaR-T-Dlb8B1lHWcwTkByhadIuYMkNsln0FF+S2jlkLSTcofb+Gjtz6N-J5D+zYv7M7TLmD2mgfaZmIvtjWWj4L203NUB2nRXbcH8cE3gmD5gh0jqLdit1SngjTstrOt9THl1ydXWoJjQRN3bsg+i2KB6mNPtPVSi9emj0WDvpdRWd6cXqcPUep9qnX1XPfX2L9DKhg5vSP+wDcxgObN1uBnZtTLPQbw+kODEnWTIdQ8I9DpJQAAFoct6rdGWfQmGyghYUDhzTQQCO-OIx0xWbLyO2so6pmjl6fmTMY05poLGJztahRx0rXHYUgMM72iLoV8AL2YGwDga9uCbzQCgHeLDQSRFYA1f6pCaoyNIJLbh-5q47ZIGyF0VB1t-S5GI0752YFfDOyXF20UmIiD2xPHu8LduhQI9djbKCaqMGfoBChhDlRBIsMqXNnX0iEO7GD8w3ZIfPGB34x5cPQCPMR8j30BY0cFkx2UQhM6ZBBKJyNKHwRCH1XoCXZQQoglU5p7q385OgiELg3DuDIaWcWEIQaD4UgIL0BDHz94AuXCMCaNz8whDLVo4sIfV4QojBogAHz32zUzqXek-E5bl+YBXoAlePzVw-fLmukcE78QAKj1wBgBhvlcm9AFbw35gteEOALbg3RvVfq7AObrH9xWQAFIvf259074PrvQDu78U-OX3vHfq6pUri30O-EAEIMQJ-D0nh+Wfn6p8D2qiVYfFd59AFK8wRfLe+glWiPXifjfq-r9X2PvoVdl4d83h+au29p4p34lXDfXjBCb773vz8HcD9Z5n236ugi+-MBniwR8KE8m+2t37W2Ba0YBwyyyhEVyvB+xdnfCZZab7O9v9RNAXAACswGm0fgfouR3m+ENP7doJgUXsDhn00F-ptgvDyNgFfjdptusvkM-oDilIQm0B0F0K0EEggZ0IkK0Frl1r+IQpACQGgfIHTqPrgfgfrJgVgbXkHiLlILAJAHDlQTQWQeQYPr6FQQAKJo5sGMFME85+IAByygvBtu-BvBXm3BZQG+dA4Q6OW+Z+UBdYbWL+TQh+BAzenYnCJ+Mht2uSkhL4psEhz40h1+shOh0B4K++Shb+Khvuv+-+hhEBXwchehJyuk9cMgBsQBf2AsR2rwg8BYTS9grhBsUQUgCBTAbhDqUg9+ygCww6kQ4GxmTmHhUg92uQQYVEc4L2ABtqvhdwAwwQfEQ62wWgFme6No-hP8joKKJRGKD69cegPQSR6ibWrwJmwQSRjhe+XBQQdRwiaCmhwBbcd+j+lA1yrRQQ7RJhdYbyWRv4oGMWEGu69SoUuQGycx0QQceKswix+yz8rmza2xaYoBk2-202K8nA68PAWA28iChcrg84xg6Qw2VciShYGoLIdcJqjc6RWkcICIPqxIMoJi4kmk-YvxoWearq4oko0oywQJGkkkoJUWforgrIbSJILguS7wNAjcEKm43igKARiapkeJhgwmA8n0QoAAXl8FMEoE1CSeURFqGEQGQPDBAoQGuEnmmqyQoN0GoLSTMOJgya8AQJyWSXqPkKoFSV8DCfcU8UyUajyeyaKWqI7j6tyWyT0A2k2sUZeuJnqXZLKcKbxl0WUCqTIHWhKRSdSbIOiWpIVCCQyXIt9rBNQsLAcp5KCK6VIsLP2N+hYARmnB6XaV5Jon6ZsIGSIAcpKW4dSWoGnANrhGxAqRqbya0CKZycbuqSyZqSysgufqeJIpgqAC4CIKsjMSGuaZadWNaV8FTMbDbMfIUUbNQKoG4WoMoFgsfASQBqYsyUqemRyaqc3mMcoAqWMfrqJMkhmWqK9FmWIeYKEBEgfFOROKIeQS5jmWmR2eCjOTIK9BOUEN-C4CmVucqWuK9BWbmlWf6eYNxspozEZiRvVqQJAjOC+QwN2TxkTmoArDvvSkenfM+Tvg+kKmNvWa2VUFonVjvleV1p2H+SIKTKabMQRIhaQMhbeaAPecEgYUhQcofjGdKbTFrFhdplKF7EdmbD6gZpFr7qgUgT6mBQJkftnEhQFh9p+dWSOLWdBGAu+N8XKVVjoSephAcpRISLRuGcJQYXMFGc-ERXGRJdRDkg6QiQyYmZXKeQOXuUntenJaQEyWMTWnuXOb7klk5qJnqW2peupqslheQZRmeT0AxegaZZpUekMHBcxmKQUYzIpSaIVhik6TogRpetGUFWOJetJQGSJQZfYApbWR2ZFUkOCsPOpW8d4JpbJNpZqbpfOWUPFUZbmiZUOfuUng8bmvgFbrwFbiZgRjkAyMkh6dkDqWJjZQhiaQ5SGlZZCR1ZhHZV1SZk5QOSZYebamoBVcENVQIHVQubmr1ZhPqQhuNfNSNI1bueCWtdtUNTtb+LJOaQIJNd1dtUMB5T+t5cpr5dVCJrxR9PSZlRmI8TJVIVoPJXqklfdatFYOtJtBpVhQRmQO9QFR4MIj1J9NoQwMzDaP9RGSJcoMDZ9XQPVNNF9DID9FRP9KCWRVeLlWmflarj6m9YZX2UxvgKmWaLhdQE4N8YQBGj-NElRDEFtbavgKBtId0F8YoG8DQKAHfqqPYGtOCkxn0TcNOWVWZSrhOXvAfELYUizYunfEDSTbgv2XlRLeuYut-AjSrXMGrfjRrZdUEJNmuLYG-HklEEQLTQQPTQoIzdTdEArb+GzZ8Bzb9YoAAJAe1zJHo3l+X2xUbihECKzKWSFCUhAqFqDQzQ3wyIkWVhV0wHL1nwxKzswxXpDkVZSxaGxEyNkPp3xHKgV6rFz1EPAjpB0h38WwSEg-IwXOyxS+woUVrl00DB18WHjV0TCmSrXBBnLJ3LB-n10qyNmDhYVlYVYWXkWh0FAMnlp3yATT1SUaXlrfxHJj3+31ogx2SkA1h8kwl3JPGH5SDN6shW471BXdA26vD73cUBG8XJyhwhVw0GFBnPwP0aI+Tp24VSFBwbQcpJ0t1t3T2mQJkA0iXn0BjoEA7a4izb0cgX1anBzypgMv2I1SlxmgPyl9mKnq1VkFW-ilkk2VH1HVGxS-0eagAQMpjdDXKNJG0WCpnnmqn9C5ob1WnoMuJpJD0w2PXHwEZMBoOxkD1pJqVMSw09l41MMWn4NToiDFVHqlWHVcnOV5n4zLnLBuLvpKP0NXXMNsMChOhgLB0mifFNwZGvkJrRDXKMODl4P3L7aNHbYvYMqbmjWBGrZGFaEcIWODykw6MWBVkMrfyhBsLCIFnPa7ZO1AVtxpxHYGAJG5rIokMHE2itHqJFnSKZGtG+P+MPm74pP3B-70PxmaKgxpro3uUjldY2NR0RTZITglM+RlNWzJA92gB3zqOQ35KNMGyugtOa1YHfyuUQJtPaPXqBNNBhoqoRreEgSkCGgkA0Cxqtz2z6xaBvx5ZZqWqHmsiGNkDGMC6mPfEIIuG8WuFc1iO8POkiUECCPSlHYJjpWXPNhbgoNSE60MAEVv4BU+FEnY1YOq04MG14OE2+1yOk1MGzNKMyNMHXCKy+MdlIUtF7XBAQsovy45NlUQwwvovmB7MHPnNmPUavltOWVEn61SMQy5NOZjNME3nvw3XkkcMC53FTh8MiXK2fPPyEW1k+GuCYnYnwymRsvZW43YM2ME1q4WW6QRAGyJCVEaBYk4kH0Ub7ZHKKuCszgDM3plWTU2bsTZxkBKtCvxNovosSukvpCTXN6ytSjIo5wavKuj3BYMqyS2vyuFjsVj3ik1kcPh1JkWy3DTAPUvPeA0UfXMsCkhv7CGACrBOODdKz22p3wBX2QyhJuTMgjT39jhupvZsZuPogijhpgFs6upvFs8Ohuxu-jxuQ0o0rQ5vJsRtCN1vg3Rt9BxsOwhlPNzilu3zNvSm2nCSiSiO9u8OdvR1Gyx19vpApu8X90PAx11nRSPbEm8Pau1sP2NsjRzvMtbszvHpLlcMruxQHtKqpvpQnslvjs1tFt3FnvOYDs2nonbuFuFxHOngPvmC7stuEuCUPtTOqoklIYkALNLP2DCj6DKCm75YBUnP+WuB21NRTiMIUu2OZmVU+0BvAgg1suSPod6OMt6jAX0A5DB1MRRBaDB3lHolIfqCGSXRqoPFeoSAkBUcbIerYXcjUvRbrF359QFM8elUesC7o1KC-S3ZJ5uJCdJ7DMYE+sjhVBhBkc11R1sfUdyIrGCgqdd0HJr0e2bBQz6Did9RGaUfB2vC2uXDggkBfmLmR3mcbJUqshWfRA2dfgWVBCuc2fHXBbYaXSVYWC0duJoLHiMesjMfZqOfZoWpDDcdMZrEbECfxalEvBk1gDBeqBAtmgi3SeHLIqicY0XYVUTmke0Q10HLMp5dlfkeSHnWLrTrGd2CmdjYudMAGzWdRBBIiffQmfFcnW-heXpd6qIduJlVm0i2yfCKIHoFMb1fYVDYZBNcQ1GYPqOc6PWvmVjEM5Hi+Ssj4BRAY0yDKp-wla5pnU41sRWD-TCwAw6d1c7jVZexem3dMAHIWq4tOYAA6iCVgN0EIywWg0Kn3uaP3PZK+Wg7TI3J5Rg38AA5OAFRPQJ0N0FsP91YHDywwuT9yFiD3jz904llG4JCPIFlK8EfOsHj00GD9+TpuoBT1TyGjT7O4cl7Iz+Qcz8EMEzFFFp2Az+z0EJzyzw-AL11kL1z-qET+4KT6wJZwREfHkfj8MKLyiz91p6QAx6j8-GvSr7+AT4zJr1ILGhGj0Mb0wC8cDyD5z390QAD2oCvj+Rr2F90NuIz9b4THb6SIh5CJ2E77dxgXL8RGbxb0YAXqz1UIr8EJz9Vq3WE8Hwcr72x87-J7i5z375dK0Acn2Ony71j+z+7zYilJ2MH3eFo7HwyMH5H9wTj7rztT95vgoDoOaBV7AUyHD9OFoHD68HDzbUwF36AHDxQDQP3wP1EP33D+MuP7GvIO8HD3kfr-bIbx31um26tO8CoIx5b2tQX74m3x3zlloOv-iiP-n0xob8H6LU3+DX43teL5Qs71KLH6CEf5v1X7f8r7X9v2ASJYsxhR6SlHD1-4kBx+4QIgO0H0Dj8XQEoCSBGnH5lw4BjsegHPyx7184qSgcXP-zb43cXAIAmwPVBnDj9cglAM2kgO755BTYIA3II3yQHz9LWtfVAQYWPDUBDwM4TAfcDh5MDG4uQcfqBnH7KBkB81BfotEN7mh4gUEIAc-w37LAt+21HfhTHYGiCHsOWIAQfxf4KAT+qvM-g-wv6cCWBN-VPloNu5G8TeagIAZhSV649P+2PRBIbwkGH8pB1rTDm70M6MwDQQoNwGJBRSmCn+9g-FDILEJ39K4L7OwWoNHzODyCbgjwUk16KARABsfVQVII0GLpAha1EIVILCHV86BbRB-sv2b4rRJB+KSaqPUF5cYrBTBOQbjFpxRDiGvREQSkRlI+C1BRQvPskI-5lDMhukEQUkGpiOD6BTxWIZdGM7Gwkhp-RIg-zSGFD30n3FIWUEN7YCChr-Foe-0sHtCOeNgh-vMN8Gb9KeowgJq4KqGTgahPQTYWoP8GZCp0V4F9icPSEC8Zhv4SIYcK8GxDsBCQ4-hkNaEg9rh+Kd4WsJB5L8rAV-VGgsOkHFCLAnPIYF7VWHpAKhSCdwY8NLrn8TB2A8wV-xWFQjvu6wowY5zU7sczhBgoIDn0z7PxHOSwz-tHxEqDCnO6OB-pSJ6Fv90W7vdHssEd5J9-ervXYdhwg5JBSRqwmvuiKwKollsAoOFgLj+YfNaGgLCVmVS35PEfy4ogZq41zJHJdKQTA1j0HlHyMmC5NLcpTQto01iO9ND4JID1QiBxqHZRNJU1BZrURRCLPsPKJ45OYzWn3bUTyV1GeJLa1tCNFkPSD4AoEtgc0P9CWhtkeaoAG0USW9Fj5MW5pbFlaPZ41NmUg8X5lYybqfdoxKY8grS24J+0jgtifknojBi5jCx+Yg6G2WU7lcu6O2JTprze7eoPu-Io9D90N7YjYhvA7vqAPAEUAp+M-HgZ8DgFwQRh0I7AHD3oBUCtApA0fsAO76tiB+HdM0HP3pEot4uZQgAAzpjyCl5S1huKwJbimgKiIAA')">function get_args(afuns, env, succeed, fail) {      
    return is_null(afuns)
        ? succeed(null, fail)
        : head(afuns)(env,
                      // success continuation for this afun
                      (arg, fail2) =>
                          get_args(tail(afuns),
                                   env,
                                   // success continuation for
                                   // recursive call to get_args
                                   (args, fail3) =>
                                       succeed(pair(arg, args),
                                               fail3),
                                   fail2),
                      fail);
}
</pre></div></div></td></tr></table>
  </p></div>

  <div class='permalink'>
<a name='p27' class='permalink'></a><p>
    The actual
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    application, which is performed by
    
      <span style="color:green"><kbd>execute\?application</kbd>,</span>
      <span style="color:blue"><kbd>execute_application</kbd>,
      </span>
      
    is accomplished in the same way as for the ordinary evaluator, except for
    the need to manage the continuations.
      
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_90_17_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (execute-application proc args succeed fail)
  (cond ((primitive-procedure? proc)
         (succeed (apply-primitive-procedure proc args)
                  fail))
        ((compound-procedure? proc)
         ((procedure-body proc)
          (extend-environment (procedure-parameters proc)
                              args
                              (procedure-environment proc))
          succeed
          fail))
        (else
         (error
          "Unknown procedure type - - EXECUTE-APPLICATION"
          proc))))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_90_17_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=4&prgrm=PTAEGUEkGEAVQFLlAFgHQGZMChslAGYCuAdgMYAuAlgPYkDOhATjQLYQzxKpoCMaAJlzFy1OqCr0A+gBsqFAKZMAhjIAUZNgAc6CkhQCUoAN7ZQ50EwUUiTEhOkkirAEZKN23fqOgAPr7MLIItJKXoKJioSAHMPVh0SPUNzf0DgoNCXGhoZBWUSOISko1T04NCnGXVNeK9ki1KykOlSABMFAiiFVsK6gwBubABfbBFKWns5RRUZKQA3VSIFXsTvEyC0y2tbexqi-UGR0dJx8VCKZWjo7tlJCjVw1goAGlAKAAsFKQvoo1Mgqw2OwOKRaZRUJgPChPIwAMlhoE+yh6j2SAF4MW9Pt9LodhCcxPYKspWMs9n0TJtATsQT9rq1buEVklXgAiEgkhSsgbDY6iCagegAT1cOSkNAIUg5pOZa3+FmpwKRPQuVGqnlWhh5RzGhNArGUAGsvsp6PQqNESKT9FDIjFXgoAB5aKxmiZ-KnbYFyJms03my3Wiis17hO3RB3O13mujavmnInSf0Wq1JWXJeXmRWJnFXG4++7kzVs5OBpLcvG6gWl1P6MIirLq2qaj0Ar32ZVqVXqTvd9MGAdxqviGtB+aLL5Ol0KN10fuUttAjt5FXg9R9ovFAd4+N60LtMgyZQqQlQmELhXt2mXemM+6otmaBgXOsHo8nibcvwBJrNXO3gszxeUBWQWSJlBcXIpDfY9lEJL9UhGYd7Bgj86HrUV1FRVssyvXs1zUfC1SAwchwJAVULgiZxxkJYpCnaMJhIi8tiXREVy7Ai+2w7deV3AVQiPVxWmUeioxnGMCmwljs2vPMGUAh8QKElwRLE6dZxICteWQ0AVLUsEVFJaZ6GYzNZINLQHgbMUJSlTlXiIrDoS1Mj+XEfTRKyVohTMtJZKczjiJ4uN+LOaRszCC5FCDPzLzY84b3zO4gLZSLwjghQg20pDyPESKGIkpjpPMvCOO4lzeJ1PKcyfVp5AmVQ4vimlEvku9UpAuqGroVR1MYugEJ-X85IAlKlNZbrCT6jKYvLNyE1AKbGtmad6rITLmtYmkCykKwCE63gFr1ZbetmJ96AUABHJYbRK-yr12-bOoEY6BVOjlZlUaYOWoOZlnulrvTuPaOk6jBQt00JLpuvQyAByqZKvNqxqZCaYdu+GcrC+wDWNMJrsxhGnnoHDtuB30MbhrlQxc0nKxqwVCepqLMqDUySosB62MCniGfc+xOiYcJWbmu66bJgKONRemdMZ10KFFrKkg5iWkbYiqSbe8L6PiCghQJ2HyGJihSfV1rHCIKogNl3KBZBI8Rdm5Xxa183gQqK31wImWqvxe3MhkGgyENLbyZzOlkrRly2Ug4PDWx3S45DqRvN8wGgeXZEgucmFIcZ0JlC0LQ5A208M-D0ao-vGOQKLkuqDLz9tcFmr+qKucK6l7PNa1fnFuPaJ2801Xz1Knnyq4n3Kr9vAwGQxgCBYdgoDgRBkHQfgMH9xbziYJY1EdMnK8ybJcnyQ+jE2MoAH5QEdUAMTRN594UUBr-SAAuUAlBYSFHVjmfPI9gpwKEoN0V4Vh4ZUH+q0T+2Mcb6iNF8ZCahDKchMq8NODoSBzGPrJQCk1PBtCkMhEMH8RroOMkoegWCaA+RwXg-ue5pDkhIaggg+DkbSEjgpFKBBHzEJIAyMhLdCBtyodYGhahOEsUrk9MGAjQBHWYQKZCqd6G+VkZmeRINnpKNeqo8Q6i9BzAhHQWK2jPRsQUQdJREMdy6Txl8SKCxaJkjoIoOU1idopVZK4icIYlqeOKEYnMAT3FqDcUsLhCUeFJT4UyaJCg0rthoksRO8s0nJKkE+Lx9xkmxJpIFQp+d7ZwyDuaGI9FcHmNrPcUxRTgR9kaWEwgEIRZL05GoRpcju49FaXLcp5BKlfBcFooyKSf64L+BsRcNIwQQhkZMxhcYLoUCxJOPWBtTF1KDI-UAlQZCDEQc40hkzrKYVoaAZJZsdGyUWZCYUVzXi3LEV00kGFGymQ+QoWZXN5lKg4r895kz0kzmWZyf55gfHNIIiCxxjMnReIZLslg9TLnfNeaoa5LhTSThmX0x6ehogfExTkM2T89IkrJW40mFCgh30eWoM5vzyUyGuXSgwWD8U1LwQyiw39cgxDJc875RgAA81KRXvCiTigwArGU-yYH-NQrIAAq2QkEkCFKAQezgVaCiIMXOQ3Rv6slAAAanfiNW1YYojRCoAQdONkOVGGtUEi11rFV2oiA6p1vkuUKtteYb+v8aCQg1VqggCgADueqmDRANfoRg9BjUNzNSBK1NqQ1NHtTEAN7KzYerZNmn1I182OudXKt1ZTFpBxoIaY1XyxTJPZasuRulTGyGyFZXpOigi6XoBtKSrrOXyrkU0WSntrZiopcG3NwQ77dobVZcttqKk0CqUPNFFi0yNIXYuwVgpXWP0xJ2Odbr11NDvp2Ll16yjf2HRfbiY7uVvAIkGwYTQRhNCdaAHpuCz3Pw+FsrQ+s+V7OKJOso4anmurZAAVRIFkNohzOTaR-T-Dlb8B1lHWcwTkByhadIuYMkNsln0FF+S2jlkLSTcofb+Gjtz6N-J5D+zYv7M7TLmD2mgfaZmIvtjWWj4L203NUB2nRXbcH8cE3gmD5gh0jqLdit1SngjTstrOt9THl1ydXWoJjQRN3bsg+i2KB6mNPtPVSi9emj0WDvpdRWd6cXqcPUep9qnX1XPfX2L9DKhg5vSP+wDcxgObN1uBnZtTLPQbw+kODEnWTIdQ8I9DpJQAAFoct6rdGWfQmGyghYUDhzTQQCO-OIx0xWbLyO2so6pmjl6fmTMY05poLGJztahRx0rXHYUgMM72iLoV8AL2YGwDga9uCbzQCgHeLDQSRFYA1f6pCaoyNIJLbh-5q47ZIGyF0VB1t-S5GI0752YFfDOyXF20UmIiD2xPHu8LduhQI9djbKCaqMGfoBChhDlRBIsMqXNnX0iEO7GD8w3ZIfPGB34x5cPQCPMR8j30BY0cFkx2UQhM6ZBBKJyNKHwRCH1XoCXZQQoglU5p7q385OgiELg3DuDIaWcWEIQaD4UgIL0BDHz94AuXCMCaNz8whDLVo4sIfV4QojBogAHz32zUzqXek-E5bl+YBXoAlePzVw-fLmukcE78QAKj1wBgBhvlcm9AFbw35gteEOALbg3RvVfq7AObrH9xWQAFIvf259074PrvQDu78U-OX3vHfq6pUri30O-EAEIMQJ-D0nh+Wfn6p8D2qiVYfFd59AFK8wRfLe+glWiPXifjfq-r9X2PvoVdl4d83h+au29p4p34lXDfXjBCb773vz8HcD9Z5n236ugi+-MBniwR8KE8m+2t37W2Ba0YBwyyyhEVyvB+xdnfCZZab7O9v9RNAXAACswGm0fgfouR3m+ENP7doJgUXsDhn00F-ptgvDyNgFfjdptusvkM-oDilIQm0B0F0K0EEggZ0IkK0Frl1r+IQpACQGgfIHTqPrgfgfrJgVgbXkHiLlILAJAHDlQTQWQeQYPr6FQQAKJo5sGMFME85+IAByygvBtu-BvBXm3BZQG+dA4Q6OW+Z+UBdYbWL+TQh+BAzenYnCJ+Mht2uSkhL4psEhz40h1+shOh0B4K++Shb+Khvuv+-+hhEBXwchehJyuk9cMgBsQBf2AsR2rwg8BYTS9grhBsUQUgCBTAbhDqUg9+ygCww6kQ4GxmTmHhUg92uQQYVEc4L2ABtqvhdwAwwQfEQ62wWgFme6No-hP8joKKJRGKD69cegPQSR6ibWrwJmwQSRjhe+XBQQdRwiaCmhwBbcd+j+lA1yrRQQ7RJhdYbyWRv4oGMWEGu69SoUuQGycx0QQceKswix+yz8rmza2xaYoBk2-202K8nA68PAWA28iChcrg84xg6Qw2VciShYGoLIdcJqjc6RWkcICIPqxIMoJi4kmk-YvxoWearq4oko0oywQJGkkkoJUWforgrIbSJILguS7wNAjcEKm43igKARiapkeJhgwmA8n0QoAAXl8FMEoE1CSeURFqGEQGQPDBAoQGuEnmmqyQoN0GoLSTMOJgya8AQJyWSXqPkKoFSV8DCfcU8UyUajyeyaKWqI7j6tyWyT0A2k2sUZeuJnqXZLKcKbxl0WUCqTIHWhKRSdSbIOiWpIVCCQyXIt9rBNQsLAcp5KCK6VIsLP2N+hYARmnB6XaV5Jon6ZsIGSIAcpKW4dSWoGnANrhGxAqRqbya0CKZycbuqSyZqSysgufqeJIpgqAC4CIKsjMSGuaZadWNaV8FTMbDbMfIUUbNQKoG4WoMoFgsfASQBqYsyUqemRyaqc3mMcoAqWMfrqJMkhmWqK9FmWIeYKEBEgfFOROKIeQS5jmWmR2eCjOTIK9BOUEN-C4CmVucqWuK9BWbmlWf6eYNxspozEZiRvVqQJAjOC+QwN2TxkTmoArDvvSkenfM+Tvg+kKmNvWa2VUFonVjvleV1p2H+SIKTKabMQRIhaQMhbeaAPecEgYUhQcofjGdKbTFrFhdplKF7EdmbD6gZpFr7qgUgT6mBQJkftnEhQFh9p+dWSOLWdBGAu+N8XKVVjoSephAcpRISLRuGcJQYXMFGc-ERXGRJdRDkg6QiQyYmZXKeQOXuUntenJaQEyWMTWnuXOb7klk5qJnqW2peupqslheQZRmeT0AxegaZZpUekMHBcxmKQUYzIpSaIVhik6TogRpetGUFWOJetJQGSJQZfYApbWR2ZFUkOCsPOpW8d4JpbJNpZqbpfOWUPFUZbmiZUOfuUng8bmvgFbrwFbiZgRjkAyMkh6dkDqWJjZQhiaQ5SGlZZCR1ZhHZV1SZk5QOSZYebamoBVcENVQIHVQubmr1ZhPqQhuNfNSNI1bueCWtdtUNTtb+LJOaQIJNd1dtUMB5T+t5cpr5dVCJrxR9PSZlRmI8TJVIVoPJXqklfdatFYOtJtBpVhQRmQO9QFR4MIj1J9NoQwMzDaP9RGSJcoMDZ9XQPVNNF9DID9FRP9KCWRVeLlWmflarj6m9YZX2UxvgKmWaLhdQE4N8YQBGj-NElRDEFtbavgKBtId0F8YoG8DQKAHfqqPYGtOCkxn0TcNOWVWZSrhOXvAfELYUizYunfEDSTbgv2XlRLeuYut-AjSrXMGrfjRrZdUEJNmuLYG-HklEEQLTQQPTQoIzdTdEArb+GzZ8Bzb9YoAAJAe1zJHo3l+X2xUbihECKzKWSFCUhAqFqDQzQ3wyIkWVhV0wHL1nwxKzswxXpDkVZSxaGxEyNkPp3xHKgV6rFz1EPAjpB0h38WwSEg-IwXOyxS+woUVrl00DB18WHjV0TCmSrXBBnLJ3LB-n10qyNmDhYVlYVYWXkWh0FAMnlp3yATT1SUaXlrfxHJj3+31ogx2SkA1h8kwl3JPGH5SDN6shW471BXdA26vD73cUBG8XJyhwhVw0GFBnPwP0aI+Tp24VSFBwbQcpJ0t1t3T2mQJkA0iXn0BjoEA7a4izb0cgX1anBzypgMv2I1SlxmgPyl9mKnq1VkFW-ilkk2VH1HVGxS-0eagAQMpjdDXKNJG0WCpnnmqn9C5ob1WnoMuJpJD0w2PXHwEZMBoOxkD1pJqVMSw09l41MMWn4NToiDFVHqlWHVcnOV5n4zLnLBuLvpKP0NXXMNsMCjXCKyDymQ60MCML61SPQoArfk6bqCmMAW3w4PblHK6UMrfydj2MGDyNMHk1bmU0W0016g21MBYiSB6oiDjUdmJruUyNiGGMC5Ek5wdnsU6NMGk17VlC+M8n+OeKW3W0Ro92s1gBQK2Dmj-RLRtk82gDxPGOFMjRRPRDXLmkQyxMZPBCMMNHgiQiDw+FElN1tO6MyAQypPkHaPjV+03XkkcMC6fFNxzhP0vUbIECCPSlHYJjpViO8OaUEb2MEVv4BW9ONPY1YOq1OOWOtPMZyPpPkHeEa0XNdY1OJP2MtEDPmDXMDMNNNNrgtOE2vPBBOhgLB0mizOCVll1NHrGMWODnNP9NdZjNME3nvyTPsNCMC53FTh8MiXK0MB7NWQHN6quCYnYnwymQYvZW43YMdME1q4WW6QRAGyJCVEaBYk4kH0Ub7ZHLMvEszia2-hAUES8tNDuMcRkAssktePvMZNUvgtj5J70tSjIpJOivcvIXnV3kMqyTyuMuFjsVj3ik1kcPh1JkWy3DTAPXNjFA0UfXTMCnmv7CGACrfwAkeIWveBWsBX2Qyiz2-hOvSDT39juu8X+vetCsgijhpght8vWuovhs8OusOs+sghfUBu2p3wevJuRtfwOwhkbPzO8OBs2s5uiN5vxuCu+s53UwpsjRpu8X90PAx11nRSPbElbOOsggP1VtRsesduZvBDlvpRNuxS9vpA1vTMDtswRv5uJu3EnnDtLrRvSlouztTuhuFwgunhztKoeuuFc2bOlttspYklIYkCGgkA0Cxr2DCj6DKCm75YBUIIuGuB21NRTjmNnPQuZmVU+3GvAgg0YuSMft6PItqJ105DB1MRRBaDB3lHonPvqCGSXRqoPFeoSAkBQcbIerYXcgjPw7YjrF359QHH6A4cAZuLX3IoC7o1KC-S3ZJ5kfGVJ6uXdC316pVBhBgc11R1ofQdyIrGCgcdd0HJr0e2bBQz6DUd9RGaQfB2vDyuXDggkBfmLmR3ScbJUqshyfRAKdfgWVBCacKfHXBbYaXSVYWCwduJoLHiIesjIfZqqfZoWpDDYdMZrEbGEfxalEvBk1gDmeqBONmgi1keHIUffQScXYVUTn0ACeSEHLMpBdRe0Q11qu5rTrid2CSdjYadMAGzydRBBLauUcY3hcnW-heXecEtuBuJlVm0i2MfCKIHoFMbJc4U4VRAY2zBGYPqqc6OTXN66cjQM5Hi+Ssj4BtcScyDKp-wla5pnU41sRWD-TCwAzRefk7jVZexelLchPPwWp-OLoAA6iCVgN0EIywWgVje3I0h3PZK+WgoAabdxRg38AA5OAFRPQJ0N0FsCd1YM9ywwuYdyFpd684d04llG4JCPIFlK8EfOsMD+kNdzYxRdbLD-D1dwygXV7Gj11oj1m1D+wPZhxKj9j+YLj44w-CT0emT1m6SE+5DzFLJwREfHkXt4D5TztYd3x6QAh198-Gvez2UKD4zDz1ILGhGj0GL0wC8RdyD56D98sCvj+dz1Z8xyz6z3L0QKdyyuD+4J2Mr0txgYz8RJL9L0YAXocl7Gr0EGT9Vq3cIqL+Lwcnr2hyrxgf9xk2T-r5dK0Acn2F78x+78D2TwQilJ2Cb3eFo3bwyCb1b0wWzwL-NYd5vgoDoOaDXR6SlM99OFoM968M98E7n6AM9xQDQIX0X1EIX89+MpX7GvIO8M93kUL-bCL9n1uuDX1FoO8CoIhzL4n08YBFn1YFoDlp393woGX-D9T7aiLyb6Lan+DaTKPttVP5Qir1KHb6CF3-ipNbHxz8MAn33wRmexhRn0yM98fyQJX+EEQO0PoJXy6BKBJBGpX2XC-47PQA3-90n3FUoOLqf-cM90W4uAr+NgeqDOEr65BKAZtD-nnzyCmwr+uQFPh-0b4ytKe3-AwseGoCHgZw--NQM90wGNxcglfUDJX2UCf8++ukEXuaHiBQQL+m-Mfr1y-Ye9++mfagQ9hywX8R+W-S6BP2YGJE1+s-AgdgMX6y9+BS3B3lLzUAX9MK6vIHgf24JN9FoIvOgaP23699RBFgJxLTjcBiQUUUgjfqoMujqCFBGrK8OiX0GkB6B+KJfpdxX4hoDQQoHQcilLoD9OBhg8fjYIO6oCggKg7gVMgB7eCLALfIfm31RpWCe+o9a3lxnkFYFg+V4BwU4OIa9EqBKRGUgYL8E79A+uaePjEPIKKC9QVApIJW2MF-M4hNiVgUUONi8C0edgwAmv18EMD30GgxdCLyAHhDlg24WXnINyE49EErQ3-u0MYHY8yeWgxwZOCSE9A2h7gkoXkNMFsRzBUwvwZ4NKFjEEh4wvQQPyAFcCx+1Q7IYEPMCLCx+yw2IfsPRxr9W+afFaIMNIiB8yeQwL2j0KiE9k1hug0ujP3F5RJf+MgtajkMeFU8+ha-VTlx3Q4zC+BFgf3j72fiqcshAvG3iJUuj6BYua-BEV4ljq78wRuEeXlHVsZqAIRnQyfk8RREwiYhvwv4bmlRLLYBQALMgECxmYNw5m1GV8gmkaZQt8q9yfbI0W2wvYMe77DsiancL9FPCCYW5sY1hZlVeW5bNhPbw4S7YnaQFNuGnCOxeNr0zg+3kR3uCtF1ERZaRJkVaKQtNRbcdUUqJQrxlNEoMNNOjRia+4TMHTbEaDCXDiY045oq2MkEKZ3x1GkNfJKaJ8jOj0agrJzN-CY7plCm8La8pyTcaTcI0tzVkKQFPbntW49sfWFoDfh5Ys0lqQ8qyGpG0id2DIhBLYn5J6IwY+Y4sYWIOhtl2OiXLujtjY488Qm3qXbmSL2Ei8gRA-EgXn2v638KANfOvsQM+Av84IuwhHtgGe70BEBWgGAeX0v5582xRfDumaAb7oi9qznA-gAAYxRWBS8uC03EbiyCKiIAA')">function execute_application(fun, args, succeed, fail) {
    return is_primitive_function(fun)
        ? succeed(apply_primitive_function(fun, args),
                  fail)
        : is_compound_function(fun) 
        ? function_body(fun)(
              extend_environment(
                  function_parameters(fun),
                  args,
                  function_environment(fun)),
              (body_result, fail2) => 
                 succeed(is_return_value(body_result) 
                         ? return_value_content(body_result)
                         : undefined,
                         fail2),
              fail)
        : error(fun, "unknown function type -- " +
                     "execute_application");
}
</pre></div></div></td></tr></table>
  </p></div>

  
      <div class='permalink'>
        <a name='h8' class='permalink'></a><h2>
    
    Evaluating amb expressions
  </h2></div>

  <div class='permalink'>
<a name='p28' class='permalink'></a><p>
    
    The <kbd>amb</kbd>
    
      <span style="color:green">special</span>
      <span style="color:blue">syntactic</span>
    
    form is the key element in the nondeterministic language.  Here we see the
    essence of the interpretation process and the reason for keeping track of
    the continuations.  The execution
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    for <kbd>amb</kbd> defines a loop
    
      <span style="color:green"><kbd>try-next</kbd></span>
      <span style="color:blue"><kbd>try_next</kbd></span>
    
    that cycles through the execution
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    for all the possible values of the <kbd>amb</kbd>
    expression.  Each execution
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    is called with a failure continuation that will try the next one.  When
    there are no more alternatives to try, the entire
    <kbd>amb</kbd> expression fails.
      
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_90_18_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (analyze-amb exp)
  (let ((cprocs (map analyze (amb-choices exp))))
    (lambda (env succeed fail)
      (define (try-next choices)
        (if (null? choices)
            (fail)
            ((car choices) env
             succeed
             (lambda ()
               (try-next (cdr choices))))))
      (try-next cprocs))))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_90_18_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=4&prgrm=PTAEGUEkGEAVQFLlAFgHQGZMChslAGYCuAdgMYAuAlgPYkDOhATjQLYQzxKpoCMaAJlzFy1OqCr0A+gBsqFAKZMAhjIAUZNgAc6CkhQCUoAN7ZQ50EwUUiTEhOkkirAEZKN23fqOgAPr7MLIItJKXoKJioSAHMPVh0SPUNzf0DgoNCXGhoZBWUSOISko1T04NCnGXVNeK9ki1KykOlSABMFAiiFVsK6gwBubABfbBFKWns5RRUZKQA3VSIFXsTvEyC0y2tbexqi-UGR0dJx8VCKZWjo7tlJCjVw1goAGlAKAAsFKQvoo1Mgqw2OwOKRaZRUJgPChPIwAMlhoE+yh6j2SAF4MW9Pt9LodhCcxPYKspWMs9n0TJtATsQT9rq1buEVklXgAiEgkhSsgbDY6iCagegAT1cOSkNAIUg5pOZa3+FmpwKRPQuVGqnlWhh5RzGhNArGUAGsvsp6PQqNESKT9FDIjFXgoAB5aKxmiZ-KnbYFyJms03my3Wiis17hO3RB3O13mujavmnInSf0Wq1JWXJeXmRWJnFXG4++7kzVs5OBpLcvG6gWl1P6MIirLq2qaj0Ar32ZVqVXqTvd9MGAdxqviGtB+aLL5Ol0KN10fuUttAjt5FXg9R9ovFAd4+N60LtMgyZQqQlQmELhXt2mXemM+6otmaBgXOsHo8nibcvwBJrNXO3gszxeUBWQWSJlBcXIpDfY9lEJL9UhGYd7Bgj86HrUV1FRVssyvXs1zUfC1SAwchwJAVULgiZxxkJYpCnaMJhIi8tiXREVy7Ai+2w7deV3AVQiPVxWmUeioxnGMCmwljs2vPMGUAh8QKElwRLE6dZxICteWQ0AVLUsEVFJaZ6GYzNZINLQHgbMUJSlTlXiIrDoS1Mj+XEfTRKyVohTMtJZKczjiJ4uN+LOaRszCC5FCDPzLzY84b3zO4gLZSLwjghQg20pDyPESKGIkpjpPMvCOO4lzeJ1PKcyfVp5AmVQ4vimlEvku9UpAuqGroVR1MYugEJ-X85IAlKlNZbrCT6jKYvLNyE1AKbGtmad6rITLmtYmkCykKwCE63gFr1ZbetmJ96AUABHJYbRK-yr12-bOoEY6BVOjlZlUaYOWoOZlnulrvTuPaOk6jBQt00JLpuvQyAByqZKvNqxqZCaYdu+GcrC+wDWNMJrsxhGnnoHDtuB30MbhrlQxc0nKxqwVCepqLMqDUySosB62MCniGfc+xOiYcJWbmu66bJgKONRemdMZ10KFFrKkg5iWkbYiqSbe8L6PiCghQJ2HyGJihSfV1rHCIKogNl3KBZBI8Rdm5Xxa183gQqK31wImWqvxe3MhkGgyENLbyZzOlkrRly2Ug4PDWx3S45DqRvN8wGgeXZEgucmFIcZ0JlC0LQ5A208M-D0ao-vGOQKLkuqDLz9tcFmr+qKucK6l7PNa1fnFuPaJ2801Xz1Knnyq4n3Kr9vAwGQxgCBYdgoDgRBkHQfgMH9xbziYJY1EdMnK8ybJcnyQ+jE2MoAH5QEdUAMTRN594UUBr-SAAuUAlBYSFHVjmfPI9gpwKEoN0V4Vh4ZUH+q0T+2Mcb6iNF8ZCahDKchMq8NODoSBzGPrJQCk1PBtCkMhEMH8RroOMkoegWCaA+RwXg-ue5pDkhIaggg+DkbSEjgpFKBBHzEJIAyMhLdCBtyodYGhahOEsUrk9MGAjQBHWYQKZCqd6G+VkZmeRINnpKNeqo8Q6i9BzAhHQWK2jPRsQUQdJREMdy6Txl8SKCxaJkjoIoOU1idopVZK4icIYlqeOKEYnMAT3FqDcUsLhCUeFJT4UyaJCg0rthoksRO8s0nJKkE+Lx9xkmxJpIFQp+d7ZwyDuaGI9FcHmNrPcUxRTgR9kaWEwgEIRZL05GoRpcju49FaXLcp5BKlfBcFooyKSf64L+BsRcNIwQQhkZMxhcYLoUCxJOPWBtTF1KDI-UAlQZCDEQc40hkzrKYVoaAZJZsdGyUWZCYUVzXi3LEV00kGFGymQ+QoWZXN5lKg4r895kz0kzmWZyf55gfHNIIiCxxjMnReIZLslg9TLnfNeaoa5LhTSThmX0x6ehogfExTkM2T89IkrJW40mFCgh30eWoM5vzyUyGuXSgwWD8U1LwQyiw39cgxDJc875RgAA81KRXvCiTigwArGU-yYH-NQrIAAq2QkEkCFKAQezgVaCiIMXOQ3Rv6slAAAanfiNW1YYojRCoAQdONkOVGGtUEi11rFV2oiA6p1vkuUKtteYb+v8aCQg1VqggCgADueqmDRANfoRg9BjUNzNSBK1NqQ1NHtTEAN7KzYerZNmn1I182OudXKt1ZTFpBxoIaY1XyxTJPZasuRulTGyGyFZXpOigi6XoBtKSrrOXyrkU0WSntrZiopcG3NwQ77dobVZcttqKk0CqUPNFFi0yNIXYuwVgpXWP0xJ2Odbr11NDvp2Ll16yjf2HRfbiY7uVvAIkGwYTQRhNCdaAHpuCz3Pw+FsrQ+s+V7OKJOso4anmurZAAVRIFkNohzOTaR-T-Dlb8B1lHWcwTkByhadIuYMkNsln0FF+S2jlkLSTcofb+Gjtz6N-J5D+zYv7M7TLmD2mgfaZmIvtjWWj4L203NUB2nRXbcH8cE3gmD5gh0jqLdit1SngjTstrOt9THl1ydXWoJjQRN3bsg+i2KB6mNPtPVSi9emj0WDvpdRWd6cXqcPUep9qnX1XPfX2L9DKhg5vSP+wDcxgObN1uBnZtTLPQbw+kODEnWTIdQ8I9DpJQAAFoct6rdGWfQmGyghYUDhzTQQCO-OIx0xWbLyO2so6pmjl6fmTMY05poLGJztahRx0rXHYUgMM72iLoV8AL2YGwDga9uCbzQCgHeLDQSRFYA1f6pCaoyNIJLbh-5q47ZIGyF0VB1t-S5GI0752YFfDOyXF20UmIiD2xPHu8LduhQI9djbKCaqMGfoBChhDlRBIsMqXNnX0iEO7GD8w3ZIfPGB34x5cPQCPMR8j30BY0cFkx2UQhM6ZBBKJyNKHwRCH1XoCXZQQoglU5p7q385OgiELg3DuDIaWcWEIQaD4UgIL0BDHz94AuXCMCaNz8whDLVo4sIfV4QojBogAHz32zUzqXek-E5bl+YBXoAlePzVw-fLmukcE78QAKj1wBgBhvlcm9AFbw35gteEOALbg3RvVfq7AObrH9xWQAFIvf259074PrvQDu78U-OX3vHfq6pUri30O-EAEIMQJ-D0nh+Wfn6p8D2qiVYfFd59AFK8wRfLe+glWiPXifjfq-r9X2PvoVdl4d83h+au29p4p34lXDfXjBCb773vz8HcD9Z5n236ugi+-MBniwR8KE8m+2t37W2Ba0YBwyyyhEVyvB+xdnfCZZab7O9v9RNAXAACswGm0fgfouR3m+ENP7doJgUXsDhn00F-ptgvDyNgFfjdptusvkM-oDilIQm0B0F0K0EEggZ0IkK0Frl1r+IQpACQGgfIHTqPrgfgfrJgVgbXkHiLlILAJAHDlQTQWQeQYPr6FQQAKJo5sGMFME85+IAByygvBtu-BvBXm3BZQG+dA4Q6OW+Z+UBdYbWL+TQh+BAzenYnCJ+Mht2uSkhL4psEhz40h1+shOh0B4K++Shb+Khvuv+-+hhEBXwchehJyuk9cMgBsQBf2AsR2rwg8BYTS9grhBsUQUgCBTAbhDqUg9+ygCww6kQ4GxmTmHhUg92uQQYVEc4L2ABtqvhdwAwwQfEQ62wWgFme6No-hP8joKKJRGKD69cegPQSR6ibWrwJmwQSRjhe+XBQQdRwiaCmhwBbcd+j+lA1yrRQQ7RJhdYbyWRv4oGMWEGu69SoUuQGycx0QQceKswix+yz8rmza2xaYoBk2-202K8nA68PAWA28iChcrg84xg6Qw2VciShYGoLIdcJqjc6RWkcICIPqxIMoJi4kmk-YvxoWearq4oko0oywQJGkkkoJUWforgrIbSJILguS7wNAjcEKm43igKARiapkeJhgwmA8n0QoAAXl8FMEoE1CSeURFqGEQGQPDBAoQGuEnmmqyQoN0GoLSTMOJgya8AQJyWSXqPkKoFSV8DCfcU8UyUajyeyaKWqI7j6tyWyT0A2k2sUZeuJnqXZLKcKbxl0WUCqTIHWhKRSdSbIOiWpIVCCQyXIt9rBNQsLAcp5KCK6VIsLP2N+hYARmnB6XaV5Jon6ZsIGSIAcpKW4dSWoGnANrhGxAqRqbya0CKZycbuqSyZqSysgufqeJIpgqAC4CIKsjMSGuaZadWNaV8FTMbDbMfIUUbNQKoG4WoMoFgsfASQBqYsyUqemRyaqc3mMcoAqWMfrqJMkhmWqK9FmWIeYKEBEgfFOROKIeQS5jmWmR2eCjOTIK9BOUEN-C4CmVucqWuK9BWbmlWf6eYNxspozEZiRvVqQJAjOC+QwN2TxkTmoArDvvSkenfM+Tvg+kKmNvWa2VUFonVjvleV1p2H+SIKTKabMQRIhaQMhbeaAPecEgYUhQcofjGdKbTFrFhdplKF7EdmbD6gZpFr7qgUgT6mBQJkftnEhQFh9p+dWSOLWdBGAu+N8XKVVjoSephAcpRISLRuGcJQYXMFGc-ERXGRJdRDkg6QiQyYmZXKeQOXuUntenJaQEyWMTWnuXOb7klk5qJnqW2peupqslheQZRmeT0AxegaZZpUekMHBcxmKQUYzIpSaIVhik6TogRpetGUFWOJetJQGSJQZfYApbWR2ZFUkOCsPOpW8d4JpbJNpZqbpfOWUPFUZbmiZUOfuUng8bmvgFbrwFbiZgRjkAyMkh6dkDqWJjZQhiaQ5SGlZZCR1ZhHZV1SZk5QOSZYebamoBVcENVQIHVQubmr1ZhPqQhuNfNSNI1bueCWtdtUNTtb+LJOaQIJNd1dtUMB5T+t5cpr5dVCJrxR9PSZlRmI8TJVIVoPJXqklfdatFYOtJtBpVhQRmQO9QFR4MIj1J9NoQwMzDaP9RGSJcoMDZ9XQPVNNF9DID9FRP9KCWRVeLlWmflarj6m9YZX2UxvgKmWaLhdQE4N8YQBGj-NElRDEFtbavgKBtId0F8YoG8DQKAHfqqPYGtOCkxn0TcNOWVWZSrhOXvAfELYUizYunfEDSTbgv2XlRLeuYut-AjSrXMGrfjRrZdUEJNmuLYG-HklEEQLTQQPTQoIzdTdEArb+GzZ8Bzb9YoAAJAe1zJHo3l+X2xUbihECKzKWSFCUhAqFqDQzQ3wyIkWVhV0wHL1nwxKzswxXpDkVZSxaGxEyNkPp3xHKgV6rFz1EPAjpB0h38WwSEg-IwXOyxS+woUVrl00DB18WHjV0TCmSrXBBnLJ3LB-n10qyNmDhYVlYVYWXkWh0FAMnlp3yATT1SUaXlrfxHJj3+31ogx2SkA1h8kwl3JPGH5SDN6shW471BXdA26vD73cUBG8XJyhwhVw0GFBnPwP0aI+Tp24VSFBwbQcpJ0t1t3T2mQJkA0iXn0BjoEA7a4izb0cgX1anBzypgMv2I1SlxmgPyl9mKnq1VkFW-ilkk2VH1HVGxS-0eagAQMpjdDXKNJG0WCpnnmqn9C5ob1WnoMuJpJD0w2PXHwEZMBoOxkD1pJqVMSw09l41MMWn4NToiDFVHqlWHVcnOV5n4zLnLBuLvpKP0NXXMNsMCjXCKyDymQ60MCML61SPQoArfk6bqCmMAW3w4PblHK6UMrfydj2MGDyNMHk1bmU0W0016g21MBYiSB6oiDjUdmJruUyNiGGMC5Ek5wdnsU6NMGk17VlC+M8n+OeKW3W0Ro92s1gBQK2Dmj-RLRtk82gDxPGOFMjRRPRDXLmkQyxMZPBCMMNHgiQiDw+FElN1tO6MyAQypPkHaPjV+03WLROhgLB0mifFNwZGvkJqNMWODl4P3L7aNHbYvYMqbmjWBGrZGFaEcJLPGP9ODOa2gDfyhBsLCIFnPa7ZO1AVtxpxHZePXrIokMHE2itHqJFnSKZGtHGMjPiK77fP3B-70PxmaKgxpro0xO+4mYdNR0RTZITjQs+SwtWzJCFN3zqOQ35IYsGyujYuXNdbfyuUQKFNjOLpVluPKqqplkgSkCGgkA0Cxqtz2z6xaBvx5ZZqWqHmsjTNkCzMC7zPfEIIuG8WuFc1iO8POkiUECCPSlHYJjpVyvNhbgoNSH2MEVv4BW9ONPY1YOq1OOWOtPMZyPpPkHeEa0WtdY1OJP2MtEDPmDWsDMNNNNrgtOE2uvBDCuisysLPUavl1NHrAtmtrPevnNOY0ujNinvyTPsNCPh1JkWy3DTAPWaveA0UfUcMZt0lNj7CGACrXOODdKz22p3wBX2QyiVtNBlvt0CWnj1u-jVu8XT39ilsgijhpits3p5tCMC4pU8PZslu-iNtfVdtVuDvSmQ0o0rTTsNsOwhnqtzj9uOM1uemiPru8PdvR1Gyx0bvpDtv5v90PAx11nRSPbEm8NkuNsP1Lttuzs2mPvHvHpLlcPXuxTvtKo1vpTft9t7sTs9t3G-vOYvsmhgfAfLuFzistswfPs1tBuCXgdhoqoRrphIYkCsvsv2DCj6DKCm75YBWSv+WuB21NRTjmORv5WVU+1pvAgg1ThePYMdO6XilqJ105DB1MRRBaDB3lHomUfqCGSXRqoPFeoSAkACcbIerYXcggvRbrF359TgtKelWJCVEC7o1KC-S3ZJ5uIadJ6UsYGccjhVBhA8c11R0yeCdyIrGCjWdd0HJr0e2bBQz6B6d9RGb8fB2vARAGyXDggkBfmLmR1+cbJUqsiBcC7RAhdfgWVBCxfBdRDHXBbYaXSVYWDCduJoLHjiesiSfZqRfZoWpDCKdMZrEbFqfxalEvBk1gC5eqBONmgi1GeHLIo6cY0XYVUTn0DOeSEHLModcDe0Q13nWLrTped2A+djYxdMBBfxdRBBJadGO6eze9cnW-heWNd6oUduJlVm0i0mfCKIHoFMaTfYVDYZAzcQ1GYPqRc6OTXN5JcjQM5Hi+Ssj4BRAY0yAMsRola5pnU41sRWD-TCwAyDefk7jVZexemQ8hPPwWp+uLoAA6iCVgN0EIywWgVjqPI0GPPZK+WgoA1bdxRg38AA5OAFRPQJ0N0FsNj1YFTywwuRjyFgT66xj04llG4JCPIFlK8EfOsFz+kETzYxRdbCL2L4T7s4cl7LL11hL1-BIDFFFp2DL0r+YCr44w-Nr0err6r6SBRwLzFAFwREfHkajxzwbztRj456QGJ4z8-GvXb2UDz4zM71ILGhGj0L70wC8fj9z56Mz8sCvj+U7wV90NuFz7r1j0QDjyynz+4J2FH5DxgRb8RAH0H0YAXgr1UNb8ELr9Vq3XcznwcmnzJ9H2ZwM7r+n5dK0Acn2A3zH2z2L-H49ClJ2Dn3eFo2XwyDn0X9wbb+7-NRj5vgoDoOaDXR6SlFT9OFoFT68FT8E8v6AFTxQDQOvxv1EOv1T+Mvv7GvIO8FT3kZ7-bN74v1uuDX1FoO8CoOJ8H+P08YBAv1YFoDlvf4-woDvx30xt7xz6i1p+4NUmKPm2pG9bU3vNlqQFBAP98Uk1YfntVH5j8xCE-ESjAIYBz8mQVPTAfv3CBEB2g+gffi6AlASQI0+-MuJQMdj0Az+bPdAbJSUDi5sB9wKnhDxcD4CbA9UGcPv1yCUAzatAlfnkFNj4DcgU-WgefzDZ28GBOrJgNQEPAzgWBagKnseHkG5B9+oGffsoDoEv9dI3vc0PECgiYC4BP-F7vRwyad8bE8-AwQ9hyyYCv+8Ay6H-wsEADo+PvP3lEzUEzh30dfVwZD3cGB81AmAzCjb2GCoD2eiCaAWXxMEIDn+IfQdIzANBCg3AYkFFEEOiHf98UcQkfgylkjol0hsAzIZdHAEE9IBuaJISkM+a9E3+9goob-xKHo8pBwQYwXUIaHkEyh21K-h-xv6o0YhT-UekEF16c9whTmSwTSAqGThiGvRfQSkRlIZDHBywWPqMLCEjCmCF-RaPoKSDUwzB0g1-tYK2HGxnBsvDoYATcEtCFhk1Nofbz8GXR5gTAvoYsKQHXDhhqw5XpELcHsCHhOw44R50SG05KhUwnoJ8LqHZC1huQq8PkOBELCrhvg8ghMNSGl03+7AhwT-yOG5oTh81KET-xhHLC-WXQqfj0JWhfDSI7fUAEMK9qvDBhh9f4ZMLSGACPB7AkIWtRQGUjDe7w-wZF1s6ydQRbTevtXwz4HJIupIsfiXxEqXR9Aw3NweKK8Sx0nhLgtsGHxRZS91ArfDAnKNhE8ZpRwo1YSyNZG5pUSy2Gsvm3yEscFWBhZWlgOfiEVayPhVwJiWxLwxTILHbKrjTY7OUCaauCyrpFi5rcNAWJHEgfQoz7Yjkfoh0d4P0xlVJqNmdiNnDID+jHRrHVWk0IYbujkx+uJPD6ORRJM4xYY5Cldxwo9lMxlRDQOxTHo7hbE-JPRGDArE1iqxB0NslZ3G5d0dslnZ3iE29Qo89R6I7AN705Fv9NBK-AgUQIoBH8T+Ggz4JQLghojxe2AKnvQDEFaBBBu-EgOOPqEb8O6ZoM-uqJ2qVdUBAABhjZYFLyYbY8UeLIIqIgAA')">function analyze_amb(exp) {
    const cfuns = map(analyze, amb_choices(exp));
    return (env, succeed, fail) => {
        function try_next(choices) {
            return is_null(choices)
                ? fail()
                : head(choices)(env,
                                succeed,
                                () => try_next(tail(choices)));
        }
        return try_next(cfuns);
    };
}
</pre></div></div></td></tr></table>
  </p></div>

  
      <div class='permalink'>
        <a name='h9' class='permalink'></a><h2>
    
    Driver loop
  </h2></div>

  
  <div class='permalink'>
<a name='p29' class='permalink'></a><p>
    
    The driver loop for the <kbd>amb</kbd> evaluator is
    complex, due to the mechanism that permits the user to try again in
    evaluating an expression.  The driver uses a
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    called
    
      <span style="color:green"><kbd>internal-loop</kbd>,</span>
      <span style="color:blue"><kbd>internal_loop</kbd>,
      </span>
    
    which takes as argument a
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    
      <span style="color:green">  
	<kbd>try-again</kbd>.
      </span>
      <span style="color:blue">
	<kbd>try_again</kbd>.
      </span>
    
    The intent is that calling
    <span style="color:green">  
      <kbd>try-again</kbd>
    </span>
    <span style="color:blue">
      <kbd>try_again</kbd>
    </span>
    should go on to the next untried alternative in the nondeterministic
    evaluation.
    <span style="color:green">  
      <kbd>Internal-loop</kbd>
    </span>
    <span style="color:blue">The function
    <kbd>internal_loop</kbd>
    </span>
    either calls
    
      <span style="color:green"><kbd>try-again</kbd></span>
      <span style="color:blue"><kbd>try_again</kbd></span>
    
    in response to the user typing
    
      <span style="color:green"><kbd>try-again</kbd></span>
      <span style="color:blue">
	<kbd>try_again</kbd>
      </span>
    
    at the driver loop, or else starts a new evaluation by calling
    <kbd>ambeval</kbd>.  
  </p></div>

  <div class='permalink'>
<a name='p30' class='permalink'></a><p>
    The failure continuation for this call to
    <kbd>ambeval</kbd>
    
    informs the user that there are no more values and re-invokes the driver
    loop.
  </p></div>

  <div class='permalink'>
<a name='p31' class='permalink'></a><p>
    The success continuation for the call to <kbd>ambeval</kbd>
    
    is more subtle.  We print the obtained value and then invoke the internal
    loop again with a
    
      <span style="color:green">  
	<kbd>try-again</kbd>
      </span>
      <span style="color:blue">
	<kbd>try_again</kbd>
      </span>
    
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    that will be able to try the next alternative.  This
    
      <span style="color:green">  
	<kbd>next-alternative</kbd>
      </span>
      <span style="color:blue">
	<kbd>next_alternative</kbd>
      </span>
    
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    is the second argument that was passed to the success continuation.
    Ordinarily, we think of this second argument as a failure continuation to
    be used if the current evaluation branch later fails.  In this case,
    however, we have completed a successful evaluation, so we can invoke the
    <QUOTE>failure</QUOTE> alternative branch in order to search for additional
    successful evaluations.
    
    
    
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_90_19_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define input-prompt ";;; Amb-Eval input:")
(define output-prompt ";;; Amb-Eval value:")

(define (driver-loop)
  (define (internal-loop try-again)
    (prompt-for-input input-prompt)
    (let ((input (read)))
      (if (eq? input 'try-again)
          (try-again)
          (begin
            (newline)
            (display ";;; Starting a new problem ")
            (ambeval input
                     the-global-environment
                     
                     (lambda (val next-alternative)
                       (announce-output output-prompt)
                       (user-print val)
                       (internal-loop next-alternative))
                    
                    (lambda ()
                      (announce-output
                       ";;; There are no more values of")
                      (user-print input)
                      (driver-loop)))))))
  (internal-loop
   (lambda ()
     (newline)
     (display ";;; There is no current problem")
     (driver-loop))))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_90_19_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=4&prgrm=PTAEGUEkGEAVQFLlAFgHQGZMChslAGYCuAdgMYAuAlgPYkDOhATjQLYQzxKpoCMaAJlzFy1OqCr0A+gBsqFAKZMAhjIAUZNgAc6CkhQCUoAN7ZQ50EwUUiTEhOkkirAEZKN23fqOgAPr7MLIItJKXoKJioSAHMPVh0SPUNzf0DgoNCXGhoZBWUSOISko1T04NCnGXVNeK9ki1KykOlSABMFAiiFVsK6gwBubABfbBFKWns5RRUZKQA3VSIFXsTvEyC0y2tbexqi-UGR0dJx8VCKZWjo7tlJCjVw1goAGlAKAAsFKQvoo1Mgqw2OwOKRaZRUJgPChPIwAMlhoE+yh6j2SAF4MW9Pt9LodhCcxPYKspWMs9n0TJtATsQT9rq1buEVklXgAiEgkhSsgbDY6iCagegAT1cOSkNAIUg5pOZa3+FmpwKRPQuVGqnlWhh5RzGhNArGUAGsvsp6PQqNESKT9FDIjFXgoAB5aKxmiZ-KnbYFyJms03my3Wiis17hO3RB3O13mujavmnInSf0Wq1JWXJeXmRWJnFXG4++7kzVs5OBpLcvG6gWl1P6MIirLq2qaj0Ar32ZVqVXqTvd9MGAdxqviGtB+aLL5Ol0KN10fuUttAjt5FXg9R9ovFAd4+N60LtMgyZQqQlQmELhXt2mXemM+6otmaBgXOsHo8nibcvwBJrNXO3gszxeUBWQWSJlBcXIpDfY9lEJL9UhGYd7Bgj86HrUV1FRVssyvXs1zUfC1SAwchwJAVULgiZxxkJYpCnaMJhIi8tiXREVy7Ai+2w7deV3AVQiPVxWmUeioxnGMCmwljs2vPMGUAh8QKElwRLE6dZxICteWQ0AVLUsEVFJaZ6GYzNZINLQHgbMUJSlTlXiIrDoS1Mj+XEfTRKyVohTMtJZKczjiJ4uN+LOaRszCC5FCDPzLzY84b3zO4gLZSLwjghQg20pDyPESKGIkpjpPMvCOO4lzeJ1PKcyfVp5AmVQ4vimlEvku9UpAuqGroVR1MYugEJ-X85IAlKlNZbrCT6jKYvLNyE1AKbGtmad6rITLmtYmkCykKwCE63gFr1ZbetmJ96AUABHJYbRK-yr12-bOoEY6BVOjlZlUaYOWoOZlnulrvTuPaOk6jBQt00JLpuvQyAByqZKvNqxqZCaYdu+GcrC+wDWNMJrsxhGnnoHDtuB30MbhrlQxc0nKxqwVCepqLMqDUySosB62MCniGfc+xOiYcJWbmu66bJgKONRemdMZ10KFFrKkg5iWkbYiqSbe8L6PiCghQJ2HyGJihSfV1rHCIKogNl3KBZBI8Rdm5Xxa183gQqK31wImWqvxe3MhkGgyENLbyZzOlkrRly2Ug4PDWx3S45DqRvN8wGgeXZEgucmFIcZ0JlC0LQ5A208M-D0ao-vGOQKLkuqDLz9tcFmr+qKucK6l7PNa1fnFuPaJ2801Xz1Knnyq4n3Kr9vAwGQxgCBYdgoDgRBkHQfgMH9xbziYJY1EdMnK8ybJcnyQ+jE2MoAH5QEdUAMTRN594UUBr-SAAuUAlBYSFHVjmfPI9gpwKEoN0V4Vh4ZUH+q0T+2Mcb6iNF8ZCahDKchMq8NODoSBzGPrJQCk1PBtCkMhEMH8RroOMkoegWCaA+RwXg-ue5pDkhIaggg+DkbSEjgpFKBBHzEJIAyMhLdCBtyodYGhahOEsUrk9MGAjQBHWYQKZCqd6G+VkZmeRINnpKNeqo8Q6i9BzAhHQWK2jPRsQUQdJREMdy6Txl8SKCxaJkjoIoOU1idopVZK4icIYlqeOKEYnMAT3FqDcUsLhCUeFJT4UyaJCg0rthoksRO8s0nJKkE+Lx9xkmxJpIFQp+d7ZwyDuaGI9FcHmNrPcUxRTgR9kaWEwgEIRZL05GoRpcju49FaXLcp5BKlfBcFooyKSf64L+BsRcNIwQQhkZMxhcYLoUCxJOPWBtTF1KDI-UAlQZCDEQc40hkzrKYVoaAZJZsdGyUWZCYUVzXi3LEV00kGFGymQ+QoWZXN5lKg4r895kz0kzmWZyf55gfHNIIiCxxjMnReIZLslg9TLnfNeaoa5LhTSThmX0x6ehogfExTkM2T89IkrJW40mFCgh30eWoM5vzyUyGuXSgwWD8U1LwQyiw39cgxDJc875RgAA81KRXvCiTigwArGU-yYH-NQrIAAq2QkEkCFKAQezgVaCiIMXOQ3Rv6slAAAanfiNW1YYojRCoAQdONkOVGGtUEi11rFV2oiA6p1vkuUKtteYb+v8aCQg1VqggCgADueqmDRANfoRg9BjUNzNSBK1NqQ1NHtTEAN7KzYerZNmn1I182OudXKt1ZTFpBxoIaY1XyxTJPZasuRulTGyGyFZXpOigi6XoBtKSrrOXyrkU0WSntrZiopcG3NwQ77dobVZcttqKk0CqUPNFFi0yNIXYuwVgpXWP0xJ2Odbr11NDvp2Ll16yjf2HRfbiY7uVvAIkGwYTQRhNCdaAHpuCz3Pw+FsrQ+s+V7OKJOso4anmurZAAVRIFkNohzOTaR-T-Dlb8B1lHWcwTkByhadIuYMkNsln0FF+S2jlkLSTcofb+Gjtz6N-J5D+zYv7M7TLmD2mgfaZmIvtjWWj4L203NUB2nRXbcH8cE3gmD5gh0jqLdit1SngjTstrOt9THl1ydXWoJjQRN3bsg+i2KB6mNPtPVSi9emj0WDvpdRWd6cXqcPUep9qnX1XPfX2L9DKhg5vSP+wDcxgObN1uBnZtTLPQbw+kODEnWTIdQ8I9DpJQAAFoct6rdGWfQmGyghYUDhzTQQCO-OIx0xWbLyO2so6pmjl6fmTMY05poLGJztahRx0rXHYUgMM72iLoV8AL2YGwDga9uCbzQCgHeLDQSRFYA1f6pCaoyNIJLbh-5q47ZIGyF0VB1t-S5GI0752YFfDOyXF20UmIiD2xPHu8LduhQI9djbKCaqMGfoBChhDlRBIsMqXNnX0iEO7GD8w3ZIfPGB34x5cPQCPMR8j30BY0cFkx2UQhM6ZBBKJyNKHwRCH1XoCXZQQoglU5p7q385OgiELg3DuDIaWcWEIQaD4UgIL0BDHz94AuXCMCaNz8whDLVo4sIfV4QojBogAHz32zUzqXek-E5bl+YBXoAlePzVw-fLmukcE78QAKj1wBgBhvlcm9AFbw35gteEOALbg3RvVfq7AObrH9xWQAFIvf259074PrvQDu78U-OX3vHfq6pUri30O-EAEIMQJ-D0nh+Wfn6p8D2qiVYfFd59AFK8wRfLe+glWiPXifjfq-r9X2PvoVdl4d83h+au29p4p34lXDfXjBCb773vz8HcD9Z5n236ugi+-MBniwR8KE8m+2t37W2Ba0YBwyyyhEVyvB+xdnfCZZab7O9v9RNAXAACswGm0fgfouR3m+ENP7doJgUXsDhn00F-ptgvDyNgFfjdptusvkM-oDilIQm0B0F0K0EEggZ0IkK0Frl1r+IQpACQGgfIHTqPrgfgfrJgVgbXkHiLlILAJAHDlQTQWQeQYPr6FQQAKJo5sGMFME85+IAByygvBtu-BvBXm3BZQG+dA4Q6OW+Z+UBdYbWL+TQh+BAzenYnCJ+Mht2uSkhL4psEhz40h1+shOh0B4K++Shb+Khvuv+-+hhEBXwchehJyuk9cMgBsQBf2AsR2rwg8BYTS9grhBsUQUgCBTAbhDqUg9+ygCww6kQ4GxmTmHhUg92uQQYVEc4L2ABtqvhdwAwwQfEQ62wWgFme6No-hP8joKKJRGKD69cegPQSR6ibWrwJmwQSRjhe+XBQQdRwiaCmhwBbcd+j+lA1yrRQQ7RJhdYbyWRv4oGMWEGu69SoUuQGycx0QQceKswix+yz8rmza2xaYoBk2-202K8nA68PAWA28iChcrg84xg6Qw2VciShYGoLIdcJqjc6RWkcICIPqxIMoJi4kmk-YvxoWearq4oko0oywQJGkkkoJUWforgrIbSJILguS7wNAjcEKm43igKARiapkeJhgwmA8n0QoAAXl8FMEoE1CSeURFqGEQGQPDBAoQGuEnmmqyQoN0GoLSTMOJgya8AQJyWSXqPkKoFSV8DCfcU8UyUajyeyaKWqI7j6tyWyT0A2k2sUZeuJnqXZLKcKbxl0WUCqTIHWhKRSdSbIOiWpIVCCQyXIt9rBNQsLAcp5KCK6VIsLP2N+hYARmnB6XaV5Jon6ZsIGSIAcpKW4dSWoGnANrhGxAqRqbya0CKZycbuqSyZqSysgufqeJIpgqAC4CIKsjMSGuaZadWNaV8FTMbDbMfIUUbNQKoG4WoMoFgsfASQBqYsyUqemRyaqc3mMcoAqWMfrqJMkhmWqK9FmWIeYKEBEgfFOROKIeQS5jmWmR2eCjOTIK9BOUEN-C4CmVucqWuK9BWbmlWf6eYNxspozEZiRvVqQJAjOC+QwN2TxkTmoArDvvSkenfM+Tvg+kKmNvWa2VUFonVjvleV1p2H+SIKTKabMQRIhaQMhbeaAPecEgYUhQcofjGdKbTFrFhdplKF7EdmbD6gZpFr7qgUgT6mBQJkftnEhQFh9p+dWSOLWdBGAu+N8XKVVjoSephAcpRISLRuGcJQYXMFGc-ERXGRJdRDkg6QiQyYmZXKeQOXuUntenJaQEyWMTWnuXOb7klk5qJnqW2peupqslheQZRmeT0AxegaZZpUekMHBcxmKQUYzIpSaIVhik6TogRpetGUFWOJetJQGSJQZfYApbWR2ZFUkOCsPOpW8d4JpbJNpZqbpfOWUPFUZbmiZUOfuUng8bmvgFbrwFbiZgRjkAyMkh6dkDqWJjZQhiaQ5SGlZZCR1ZhHZV1SZk5QOSZYebamoBVcENVQIHVQubmr1ZhPqQhuNfNSNI1bueCWtdtUNTtb+LJOaQIJNd1dtUMB5T+t5cpr5dVCJrxR9PSZlRmI8TJVIVoPJXqklfdatFYOtJtBpVhQRmQO9QFR4MIj1J9NoQwMzDaP9RGSJcoMDZ9XQPVNNF9DID9FRP9KCWRVeLlWmflarj6m9YZX2UxvgKmWaLhdQE4N8YQBGj-NElRDEFtbavgKBtId0F8YoG8DQKAHfqqPYGtOCkxn0TcNOWVWZSrhOXvAfELYUizYunfEDSTbgv2XlRLeuYut-AjSrXMGrfjRrZdUEJNmuLYG-HklEEQLTQQPTQoIzdTdEArb+GzZ8Bzb9YoAAJAe1zJHo3l+X2xUbihECKzKWSFCUhAqFqDQzQ3wyIkWVhV0wHL1nwxKzswxXpDkVZSxaGxEyNkPp3xHKgV6rFz1EPAjpB0h38WwSEg-IwXOyxS+woUVrl00DB18WHjV0TCmSrXBBnLJ3LB-n10qyNmDhYVlYVYWXkWh0FAMnlp3yATT1SUaXlrfxHJj3+31ogx2SkA1h8kwl3JPGH5SDN6shW471BXdA26vD73cUBG8XJyhwhVw0GFBnPwP0aI+Tp24VSFBwbQcpJ0t1t3T2mQJkA0iXn0BjoEA7a4izb0cgX1anBzypgMv2I1SlxmgPyl9mKnq1VkFW-ilkk2VH1HVGxS-0eagAQMpjdDXKNJG0WCpnnmqn9C5ob1WnoMuJpJD0w2PXHwEZMBoOxkD1pJqVMSw09l41MMWn4NToiDFVHqlWHVcnOV5n4zLnLBuLvpKP0NXXMNsMCjXCKyDymQ60MCML61SPQoArfk6bqCmMAW3w4PblHK6UMrfydj2MGDyNMHk1bmU0W0016g21MBYiSB6oiDjUdmJruUyNiGGMC5Ek5wdnsU6NMGk17VlC+M8n+OeKW3W0Ro92s1gBQK2Dmj-RLRtk82gDxPGOFMjRRPRDXLmkQyxMZPBCMMNHgiQiDw+FElN1tO6MyAQypPkHaPjV+03WLROhgLB0mifFNwZGvkJqNMWODl4P3L7aNHbYvYMqbmjWBGrZGFaEcJLPGP9ODOa2gDfyhBsLCIFnPa7ZO1AVtxpxHZePXrIokMHE2itHqJFnSKZGtHGMjPiK77fP3B-70PxmaKgxpro0xO+4mYdNR0RTZITjQs+SwtWzJCFN3zqOQ35IYsGyujYuXNdbfyuUQKFNjOLpVluPKqqplkgSkCGgkA0Cxqtz2z6xaBvx5ZZqWqHmsjTNkCzMC7zPfEIIuG8WuFc1iO8POkiUECCPSlHYJjpVyvNhbgoNSH2MEVv4BW9ONPY1YOq1OOWOtPMZyPpPkHeEa0WtdY1OJP2MtEDPmDWsDMNNNNrgtOE2uvBDCuisysLPUavl1NHrAtmtrPevnNOY0ujNinvyTPsNCMC53FTh8MiXK0MB6tWQGt6quCYnYnwymTpvZW43YMdME1q4WW6QRAGyJCVEaBYk4kH0Ub7ZHJNtFszhkuOPmmTU2bsTZxkDNvFtePusZOVthtj5J51tSjIpJPDtdvIXnV3kMqySzsNuFjsVj3ik1kcPh1JkWy3DTAPWaveA0UfUcPHt0lNj7CGACrXOODdKz22p3wBX2QygvtNCPvt0CWnhfu-hvu8XT39gPsgijhpgAc3qXspsQc8Nnv3u-g-tfWgevswfSmQ0o0rSoffsOwhnqtzhQeOPvuemiOEe8NgfR1Gyx1EfpBAdXv90PAx11nRSPbEm8Nks-sP04eAfoc2nce0fHpLlcOsexSCdKrvvpSieQcUdIfgd3HifOZ8cmgKeye4eFziv-tqe8fvtBuCWKdhoqoRrphIYkCsvsv2DCj6DKCm75YBWSv+WuB21NRTjmORv5WVU+2HvAgg3puSNRt6NJsChECXRMCHM2gujaCKyVqvBDFP5ky1s0BRThhqBxeUB-Ae0ULkW3MiLbZpeIe5p3ysgSo5c5bISd7Xo-tbNeH5cKre1LogQSoeFlc1QVf1dHkgjMq1fYDtdKesgADaXqPNyXDqrFPQtX7qIEbIPXIa1qFASXlaSTE32arIAAuqyDN8EE+n6gWtWrV+vUEAzkeL5KyHlmd+dxd5d1d7rpdZF3rCN8zR6gADpaTZrzcPexC1crcvcOf2whdKCgzZx3fgYfflHA-3Dg+g87gEZRBaBt3g8HLIkuA5bOe0SZQSAkBw8UDwKDANXB1Y+rZRcHJ1yuAo-21vzJI4+IKtCRD-RhdGZNkFz6BKAQ1GazuXDggkBfnmAw+Y-B0HL-dhdWDZyw-w-LzgYrsSCR2i8bJUpHLc+gBHe05qpncM2LBwT03TDra-TdC5Z5aeolbpDj2XRS8AYy9Ins-RCc9fgWWHeSCM4q-XdO-O-kJMEy+E96zfevfWrm-Pc-EnXBCW+c-HXBbYYm+28WBK8neq8ZRMAO2HJxrSF36pF683fS18+KwI9+9De+8gQ-eS-dFOduJoLHiXRqoPE58Z8rfYXcipNrEbF9TgupP4Domo9ONmgi1uLX3IoC7o0s+Y1-LN4R8jSC-hf3Ct0UAE-g+eYB9tsJTM92B9RGabu98Y0XYF+lbN9gCt9uJlVm0i0VUTlR+O-O+n8Xeu87Xsi82sARoU+9Z80ECfw-fZq5+sj5+z9NZXg0+3b09jYb9G+S8cKOFadAv1Z5jYH0k1IfmMWP6nc+WhyXmiKxVRJAk+kELKOYDO4G9-+U6L-rTwB4M8P+wQM6juG-5095Mx1IAA')">const input_prompt = "amb-evaluate input:";
const output_prompt =  "amb-evaluate value:";

function driver_loop() {
    function internal_loop(try_again) {
        const input = user_read(input_prompt);
        if (input === "try_again") {
            try_again();
        } else {
            display("Starting a new problem");
            ambeval(parse(input),
                the_global_environment,
                // ambeval success
                (val, next_alternative) => {
                    user_print(output_prompt, val);
                    return internal_loop(next_alternative);
                },
                // ambeval failure
                () => {
                    display("There are no more values of");
                    display(input);
                    return driver_loop();
                });
        }
    }
    return internal_loop(
               () => {
                   display("There is no current problem");
                   return driver_loop();
               });
}
</pre></div></div></td></tr></table>
  </p></div>

  <div class='permalink'>
<a name='p32' class='permalink'></a><p>
    The initial call to
    
      <span style="color:green"><kbd>internal-loop</kbd></span>
      <span style="color:blue"><kbd>internal_loop</kbd></span>
    
    uses a
    
      <span style="color:green"><kbd>try-again</kbd></span>
      <span style="color:blue"><kbd>try_again</kbd></span>
    
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    that complains that there is no current problem and restarts the driver loop.
    This is the behavior that will happen if the user types
    
      <span style="color:green"><kbd>try-again</kbd></span>
      <span style="color:blue">
	<kbd>try_again</kbd>
      </span>
    
    when there is no evaluation in progress.
  </p></div>

  
    <div class="permalink">
    <a name="ex_4.56" class="permalink"></a><EXERCISE><b><a class="exercise-number permalink" id="ex_4.56">Exercise 4.56 </a></b> 
  
    Implement a new
    
      <span style="color:green">special</span>
      <span style="color:blue">syntactic</span>
    
    form <kbd>ramb</kbd> that is like
    <kbd>amb</kbd> except that it searches alternatives in a
    random order, rather than from left to right.  Show how this can help with
    Alyssa's problem in exercise&nbsp;<REF NAME="ex:sentence-generate"><a class="superscript" id="4.3.3-ex-link-4.55" href="./4.3.2.html#ex_4.55">4.55</a></REF>.
    
  
      <div class="Solution">
      <div class="solution_btn"><button class="btn btn-secondary solution_btn" href="#no_solution_90_1_div" data-toggle="collapse">Add solution</button></div>
      <div class="solution_content collapse" id="no_solution_90_1_div">There is currently no solution available for this exercise. This textbook adaptation is a community effort. Do consider contributing by providing a solution for this exercise, using a Pull Request in <a address="https://github.com/source-academy/sicp" href="https://github.com/source-academy/sicp">Github</a>.</div>
      </div>
    
</EXERCISE></div>



  
    <div class="permalink">
    <a name="ex_4.57" class="permalink"></a><EXERCISE><b><a class="exercise-number permalink" id="ex_4.57">Exercise 4.57 </a></b> 
  
    
      <span style="color:green">
	Implement a new kind of assignment called
	<kbd>permanent-set!</kbd> that
      </span>
      <span style="color:blue">
	Implement assignment such that 
      </span>
    
    is not undone upon failure. For example, we can choose two distinct
    elements from a list and count the number of trials required to make a
    successful choice as follows:
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_90_20_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define count 0)

(let ((x (an-element-of '(a b c)))
      (y (an-element-of '(a b c))))
  (permanent-set! count (+ count 1))
  (require (not (eq? x y)))
  (list x y count))</pre><pre class='prettyprintoutput'>
;;; Starting a new problem
;;; Amb-Eval value:
(a b 2)

;;; Amb-Eval input:</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_90_20_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
let count = 0;

let x = an_element_of("a", "b", "c");
let y = an_element_of("a", "b", "c");
count = count + 1;
require(! x === y);
list(x, y, count);</pre><pre class='prettyprintoutput'>
Starting a $new$ problem
amb-evaluate value:
["a", ["b", [2, null]]]

amb-evaluate input:</pre></div></div></td></tr></table>
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_90_21_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
try-again</pre><pre class='prettyprintoutput'>
;;; Amb-Eval value:
(a c 3)</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_90_21_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
try_again</pre><pre class='prettyprintoutput'>
amb-evaluate value:
["a", ["c", [3, null]]]</pre></div></div></td></tr></table>
    <table width="100%">
        <colgroup><col width="48%"><col width="1%"><col width="51%"></colgroup>
        <tr>
          <td class="meta" style = "color:grey; text-align: center">Original</td>
          <td></td>
          <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
        </tr>
        <tr><td><span style="color:green">
	What values would have been displayed if we had used
	<kbd>set!</kbd> here rather than
	<kbd>permanent-set!</kbd>?
      </span>    </td>
          <td></td>
          <td><span style="color:blue">
	What values would have been displayed if we had used
	the original meaning of assignment rather than
	permanent assignment?
      </span></td></tr></table>
    
  
      <div class="Solution">
      <div class="solution_btn"><button class="btn btn-secondary solution_btn" href="#no_solution_90_2_div" data-toggle="collapse">Add solution</button></div>
      <div class="solution_content collapse" id="no_solution_90_2_div">There is currently no solution available for this exercise. This textbook adaptation is a community effort. Do consider contributing by providing a solution for this exercise, using a Pull Request in <a address="https://github.com/source-academy/sicp" href="https://github.com/source-academy/sicp">Github</a>.</div>
      </div>
    
</EXERCISE></div>


  <table width="100%">
        <colgroup><col width="48%"><col width="1%"><col width="51%"></colgroup>
        <tr>
          <td class="meta" style = "color:grey; text-align: center">Original</td>
          <td></td>
          <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
        </tr>
        <tr><td><span style="color:green">
      
    <div class="permalink">
    <a name="ex_4.58" class="permalink"></a><EXERCISE><b><a class="exercise-number permalink" id="ex_4.58">Exercise 4.58 </a></b> 
  
	
	Implement a new construct called <kbd>if-fail</kbd>
	that permits the user to catch the failure of an expression.
	<kbd>If-fail</kbd> takes two expressions. It evaluates
	the first expression as usual and returns as usual if the evaluation
	succeeds. If the evaluation fails, however, the value of the second
	expression is returned, as in the following example:
	<div class='snippet' id='javascript_90_22_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
</pre><pre class='prettyprintoutput'>
;;; Amb-Eval input:</pre></div></div>
	<div class='snippet' id='javascript_90_23_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(if-fail (let ((x (an-element-of '(1 3 5))))
           (require (even? x))
           x)
         'all-odd)</pre><pre class='prettyprintoutput'>
;;; Starting a new problem
;;; Amb-Eval value:
all-odd

;;; Amb-Eval input:</pre></div></div>
	<div class='snippet' id='javascript_90_24_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(if-fail (let ((x (an-element-of '(1 3 5 8))))
           (require (even? x))
           x)
         'all-odd)</pre><pre class='prettyprintoutput'>
;;; Starting a new problem
;;; Amb-Eval value:
8</pre></div></div>
      
      <div class="Solution">
      <div class="solution_btn"><button class="btn btn-secondary solution_btn" href="#no_solution_90_3_div" data-toggle="collapse">Add solution</button></div>
      <div class="solution_content collapse" id="no_solution_90_3_div">There is currently no solution available for this exercise. This textbook adaptation is a community effort. Do consider contributing by providing a solution for this exercise, using a Pull Request in <a address="https://github.com/source-academy/sicp" href="https://github.com/source-academy/sicp">Github</a>.</div>
      </div>
    
</EXERCISE></div>

    </span>    </td>
          <td></td>
          <td><span style="color:blue">
      
    <div class="permalink">
    <a name="ex_4.59" class="permalink"></a><EXERCISE><b><a class="exercise-number permalink" id="ex_4.59">Exercise 4.59 </a></b> 
  
	
	We shall horribly abuse the syntax for conditional statements, by
	implementing a construct of the following form: 
	<kbd class='snippet'>if (evaluation_succeeds_take) { $statement$ } else { $alternative$ }</kbd>
	The construct permits the user to catch the failure of a
	$\textit{statement}$. It evaluates the
	$\textit{statement}$ as usual and returns
	as usual if the evaluation succeeds. If the evaluation fails,
	however, the $\textit{alternative}$
	is evaluated, as in the following example:
	<div class='snippet' id='javascript_90_25_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
</pre><pre class='prettyprintoutput'>
amb-evaluate input:</pre></div></div>
	<div class='snippet' id='javascript_90_26_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
if (evaluation_succeeds_take) {
    const x = an_element_of(list(1, 3, 5));
    require(is_even(x));
} else {
    "all odd";
}</pre><pre class='prettyprintoutput'>
Starting a $new$ problem
amb-evaluate value:
"all odd"

amb-evaluate input:</pre></div></div>
	<div class='snippet' id='javascript_90_27_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
if (evaluation_succeeds_take) {
    const x = an_element_of(list(1, 3, 5, 8));
    require(is_even(x));
    x;
} else {
    "all odd";
}</pre><pre class='prettyprintoutput'>
Starting a $new$ problem
amb-evaluate value:
8</pre></div></div>
      
      <div class="Solution">
      <div class="solution_btn"><button class="btn btn-secondary solution_btn" href="#no_solution_90_4_div" data-toggle="collapse">Add solution</button></div>
      <div class="solution_content collapse" id="no_solution_90_4_div">There is currently no solution available for this exercise. This textbook adaptation is a community effort. Do consider contributing by providing a solution for this exercise, using a Pull Request in <a address="https://github.com/source-academy/sicp" href="https://github.com/source-academy/sicp">Github</a>.</div>
      </div>
    
</EXERCISE></div>

    </span></td></tr></table>

  
    <div class="permalink">
    <a name="ex_4.60" class="permalink"></a><EXERCISE><b><a class="exercise-number permalink" id="ex_4.60">Exercise 4.60 </a></b> 
  
    
    With
    
      <span style="color:green">
	<kbd>permanent-set!</kbd>
      </span>
      <span style="color:blue">
	the new kind of assignment
      </span>
    
    as described in exercise&nbsp;<REF NAME="ex:permanent-set"><a class="superscript" id="4.3.3-ex-link-4.57" href="./4.3.3.html#ex_4.57">4.57</a></REF> and
    
      <span style="color:green">
	<kbd>if-fail</kbd>
      </span>
      <span style="color:blue">
	the construct
	<kbd class='snippet'>if (evaluation_succeeds_take) { $\ldots$ } else { $\ldots$ }</kbd>
      </span>
    
    as in exercise&nbsp;<REF NAME="ex:if-fail"><a class="superscript" id="4.3.3-ex-link-4.59" href="./4.3.3.html#ex_4.59">4.59</a></REF>, what will be the result of
    evaluating
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_90_28_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(let ((pairs '()))
  (if-fail (let ((p (prime-sum-pair '(1 3 5 8) '(20 35 110))))
             (permanent-set! pairs (cons p pairs))
             (amb))
           pairs))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_90_28_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
let pairs = null;      
if (evaluation_succeeds_take) {
    const p = prime_sum_pair(list(1, 3, 5, 8), list(20, 35, 110));
    pairs = pair(p, pairs); // using permanent assignment
    amb();
} else {
    pairs;
}</pre></div></div></td></tr></table>
  
      <div class="Solution">
      <div class="solution_btn"><button class="btn btn-secondary solution_btn" href="#no_solution_90_5_div" data-toggle="collapse">Add solution</button></div>
      <div class="solution_content collapse" id="no_solution_90_5_div">There is currently no solution available for this exercise. This textbook adaptation is a community effort. Do consider contributing by providing a solution for this exercise, using a Pull Request in <a address="https://github.com/source-academy/sicp" href="https://github.com/source-academy/sicp">Github</a>.</div>
      </div>
    
</EXERCISE></div>


  
    <div class="permalink">
    <a name="ex_4.61" class="permalink"></a><EXERCISE><b><a class="exercise-number permalink" id="ex_4.61">Exercise 4.61 </a></b> 
  
    
    
    If we had not realized that <kbd>require</kbd> could be
    implemented as an ordinary
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    that uses <kbd>amb</kbd>, to be defined by the user as
    part of a nondeterministic program, we would have had to implement it
    as a 
    
      <span style="color:green">special</span>
      <span style="color:blue">syntactic</span>
    
    form. This would require syntax
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_90_29_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (require? exp) (tagged-list? exp 'require))

(define (require-predicate exp) (cadr exp))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_90_29_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
function is_require(component) {
    return is_tagged_list(component, "require");
}
function require_predicate(component) {
    return head(tail(component));
}</pre></div></div></td></tr></table>
    and a new clause in the dispatch in <kbd>analyze</kbd>
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_90_30_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
((require? exp) (analyze-require exp))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_90_30_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
: is_require(component)
? analyze_require(component)</pre></div></div></td></tr></table>
    as well the
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    
      <span style="color:green">
	<kbd>analyze-require</kbd>
      </span>
      <span style="color:blue">
	<kbd>analyze_require</kbd>
      </span>
    
    that handles <kbd>require</kbd>
    expressions.  Complete the following definition of
    
      <span style="color:green">
	<kbd>analyze-require</kbd>.
      </span>
      <span style="color:blue">
	<kbd>analyze_require</kbd>.
      </span>
    
    <kbd class='snippet'>function analyze_require(component) {
    const pfun = analyze(require_predicate(component));
    return (env, succeed, fail) =>
        pfun(env,
             (pred_value, fail2) =>
                 $\langle ?? \rangle$
                 ? $\langle ?? \rangle$
                 : succeed("ok", fail2),
             fail);
}</kbd>
  
      <div class="Solution">
      <div class="solution_btn"><button class="btn btn-secondary solution_btn" href="#no_solution_90_6_div" data-toggle="collapse">Add solution</button></div>
      <div class="solution_content collapse" id="no_solution_90_6_div">There is currently no solution available for this exercise. This textbook adaptation is a community effort. Do consider contributing by providing a solution for this exercise, using a Pull Request in <a address="https://github.com/source-academy/sicp" href="https://github.com/source-academy/sicp">Github</a>.</div>
      </div>
    
</EXERCISE></div>

  

  
  
    
    
    
    
    
    
    
<hr>

    <div class='footnote'>
      <a class='footnote-number' id='footnote-1' href='#footnote-link-1' >[1] </a>
    <FOOTNOTE>
    We chose to
    implement the lazy evaluator in
    section&nbsp;<REF NAME="sec:lazy-evaluation"><a class="superscript" id="4.3.3-sec-link-4.2" href="./4.2.html">4.2</a></REF> as a modification of the
    ordinary metacircular evaluator of
    section&nbsp;<REF NAME="sec:core-of-evaluator"><a class="superscript" id="4.3.3-sec-link-4.1.1" href="./4.1.1.html">4.1.1</a></REF>.  In contrast, we will
    base the <kbd>amb</kbd> evaluator on the analyzing
    evaluator of section&nbsp;<REF NAME="sec:separating-analysis"><a class="superscript" id="4.3.3-sec-link-4.1.7" href="./4.1.7.html">4.1.7</a></REF>, because
    the execution
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    in that evaluator provide a convenient framework for implementing
    backtracking.
    </FOOTNOTE></div>
    
    
    <div class='footnote'><span style="color:green">
      <a class='footnote-number' id='footnote-2' href='#footnote-link-2' style="color:green">[2] </a>
    <FOOTNOTE>
    We
	assume that the evaluator supports <kbd>let</kbd>
	(see exercise&nbsp;<REF NAME="ex:implement-analyze-let"><a class="superscript" id="4.3.3-ex-link-4.28" href="./4.1.7.html#ex_4.28">4.28</a></REF>),
	which we have used in our nondeterministic programs.
    </FOOTNOTE></span></div>
    
    
    <div class='footnote'><span style="color:blue">
      <a class='footnote-number' id='footnote-3' href='#footnote-link-3' style="color:blue">[3] </a>
    <FOOTNOTE>
    To avoid confusion, we shall
	refrain from declaring <kbd>amb</kbd> as a
	name in our nondeterministic programs.
    </FOOTNOTE></span></div>
    
    
    <div class='footnote'>
      <a class='footnote-number' id='footnote-4' href='#footnote-link-4' >[4] </a>
    <FOOTNOTE>
    We
    didn't worry about undoing
    
      <span style="color:green">definitions,</span>
      <span style="color:blue">declarations,</span>
    
    
      <span style="color:green">
	since we can
	
	assume that internal
	
	  <span style="color:green">definitions</span>
	  <span style="color:blue">declarations</span>
	
	are scanned out
	(section&nbsp;<REF NAME="sec:internal-definitions"><a class="superscript" id="4.3.3-sec-link-4.1.6" href="./4.1.6.html">4.1.6</a></REF>).
      </span>
      <span style="color:blue">
	since we
	
	assume that names are not used prior to the evaluation of their
	declaration, see exercise&nbsp;<REF NAME="ex:internal-defs"><a class="superscript" id="4.3.3-ex-link-4.20" href="./4.1.6.html#ex_4.20">4.20</a></REF>.
	
	  <span style="color:green">definitions</span>
	  <span style="color:blue">declarations</span>
	
	are scanned out
	(section&nbsp;<REF NAME="sec:internal-definitions"><a class="superscript" id="4.3.3-sec-link-4.1.6" href="./4.1.6.html">4.1.6</a></REF>).
      </span>
    
    </FOOTNOTE></div>
    
    
</div></div>

    <div class='nav'>
  
        <a class='btn btn-secondary btn-nav' href='./4.3.2.html'>&lt; Previous</a>
    
    <div style='flex-grow: 1;'></div>
  
        <a class='btn btn-secondary btn-nav' id='92' href='./4.4.html'>Next &gt;</a>
      </div>
    <div class='chapter_sign'>
      4.3.3&nbsp;&nbsp;
    Implementing the
    
      <span style="color:green">Amb</span>
      <span style="color:blue">amb</span>
    
    Evaluator
  
    </div>
    <script> var chapter_id = 91; </script>
    <script> var chapter_path = "chapters/4.3.3.html"; </script>
    <div class='next-page'></div>
    </div>
    </div> <!-- /.container -->
    </body></html>