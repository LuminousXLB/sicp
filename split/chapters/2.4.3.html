<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <!-- Global site tag (gtag.js) - Google Analytics - START -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-156801664-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-156801664-1');
    </script>
    <!-- Global site tag (gtag.js) - Google Analytics - END -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="description" content="2.4.3  Data-Directed Programming and Additivity" />
    <title>
      2.4.3  Data-Directed Programming and Additivity
    </title>
    
  <meta name="csrf-param" content="authenticity_token" />
  <meta name="csrf-token" content="EMTEijVc2kiiKUH4nYH0lQG3pLPfMowQ/Stg//t6DCo0e5pWMQwamnTvIdmVZqY/MqSx2IYYE+2bpNV6UNSMwQ==" />

    <!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
    -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata&display?swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Droid+Sans|Droid+Serif" rel="stylesheet">
    <link rel="stylesheet" media="all" href="../assets/stylesheet.css" />

   <link rel="shortcut icon" type="image/x-icon" href="../assets/favicon.ico" />

<!--    <link rel="shortcut icon" type="image/png" href="../images/lambda.png" /> -->

    <!-- for support of progressive web app, see github README, DISABLED!
    <link rel="manifest" href="../static/manifest.json">
    -->

    <script src="https://code.jquery.com/jquery-3.2.1.min.js" 
		     	  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
	          crossorigin="anonymous">
    </script> 

    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>

    <!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script> -->
    <script type="text/javascript" 
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-AMS-MML_HTMLorMML-full">
    </script>
   <!--  <script type="text/javascript" 
      src="../MathJax/MathJax.js?config=TeX-AMS-MML_HTMLorMML-full">
    </script> -->
  
    <script src="../assets/application.js"></script>
  
    <!-- Rendering inline LaTeX -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          processEscapes: true,
          jax: ["input/TeX","output/HTML-CSS"]
        }
      });
    </script>
    <!--<script src="/mathjax/MathJax.js?config=TeX-AMS_HTML-full.js" type="text/javascript"></script>-->
    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js" type="text/javascript"></script>
    <![endif]-->
  </head>
  <body>

    
    <!-- support for progressive web app, see README, DISABLED
    <script>
      if ('serviceWorker' in navigator && !navigator.serviceWorker.controller) {
          navigator.serviceWorker.register("../sw.js").then(function(reg) {
              console.log("Service worker has been registered for scope: " + reg.scope);
          });
      }
    </script>
    -->

     <nav class="navbar navbar-expand-sm navbar-dark bg-dark fixed-top justify-content-between">
       <button id="btn" class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#nav-sidebar" aria-controls="nav-sidebar" aria-expanded="false" aria-label="Toggle navigation" title="navigation">
         <span class="navbar-toggler-icon"></span>
       </button>
       <span class="navbar-brand-short"><a title="Go back to front page" href="../index.html" class="gray">SICP &mdash; Scheme/JS</a></span>
       <span class="navbar-brand-long" ><a title="Go back to front page" href="../index.html" class="gray">Structure and Interpretation of Computer Programs &mdash; Comparison Edition</a></span>

       <!-- edit the search engine by visiting: 
	    https://cse.google.com/cse/setup/basic?cx=015760785273492757659:nc_tznrzlsg 
	       -->
       <form class="form-inline ml-auto" id="xxx">
         <div id="search-box">
	         <script>
	           (function() {
	               var cx = "015760785273492757659:nc_tznrzlsg";
	               var gcse = document.createElement("script");
	               gcse.type = "text/javascript";
	               gcse.async = true;
	               gcse.src = "https://cse.google.com/cse.js?cx=" + cx;
	               var s = document.getElementsByTagName("script")[0];
	               s.parentNode.insertBefore(gcse, s);
	           })();
	           window.onload = function()
	           { 
	               var searchBox =  document.getElementById("gsc-i-id1");
	               searchBox.placeholder= "search web edition";
	               searchBox.title= "search web edition";
	           }
	         </script>
	         <gcse:search></gcse:search>
         </div>
       </form>
       <span class="navbar-brand-short">
         &nbsp;
         &nbsp;
         <a href="https://source-academy.github.io/source/" title="Go to the Source language(s) definition(s)" class="gray">S</a>
       </span>
       <span class="navbar-brand-long">
         &nbsp;
         &nbsp;
         <a href="https://source-academy.github.io/source/" title="Go to the Source language(s) definition(s)" class="gray">Source</a>
       </span>
     </nav>
     
     <div class="container scroll">

            
        <div class="collapse" id="nav-sidebar" role="tablist" aria-multiselectable="true">
        <!-- insert a dummy entry, to give one extra line of space -->
        <a class="navbar-brand" href="index.html">&nbsp;</a>
    
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-1">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-1" aria-expanded="false" aria-controls="sidebar-collapse-1">
                <a href="./foreword.html">  Foreword</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-2">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-2" aria-expanded="false" aria-controls="sidebar-collapse-2">
                <a href="./prefaces.html">  Prefaces</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-3">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-3" aria-expanded="false" aria-controls="sidebar-collapse-3">
                <a href="./acknowledgements.html">  Acknowledgments from Second Edition of SICP, 1996</a>
              </span>
            </h5>
          </div>
        </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-4">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-4" aria-expanded="true" aria-controls="sidebar-collapse-4">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-4" aria-expanded="true" aria-controls="sidebar-collapse-4">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./1.html">1  Building Abstractions with <span style="color:green"> Procedures </span> <span style="color:blue"> Functions </span></a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-4" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-5">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-5" aria-expanded="true" aria-controls="sidebar-collapse-5">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-5" aria-expanded="true" aria-controls="sidebar-collapse-5">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./1.1.html">1.1  The Elements of Programming</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-5" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-6">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-6" aria-expanded="false" aria-controls="sidebar-collapse-6">
                <a href="./1.1.1.html"> 1.1.1  Expressions</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-7">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-7" aria-expanded="false" aria-controls="sidebar-collapse-7">
                <a href="./1.1.2.html"> 1.1.2  Naming and the Environment</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-8">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-8" aria-expanded="false" aria-controls="sidebar-collapse-8">
                <a href="./1.1.3.html"> 1.1.3  Evaluating <span style="color:green"> Combinations </span> <span style="color:blue"> Operator Combinations </span></a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-9">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-9" aria-expanded="false" aria-controls="sidebar-collapse-9">
                <a href="./1.1.4.html"> 1.1.4  Compound <span style="color:green"> Procedures </span> <span style="color:blue"> Functions </span></a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-10">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-10" aria-expanded="false" aria-controls="sidebar-collapse-10">
                <a href="./1.1.5.html"> 1.1.5  The Substitution Model for <span style="color:green"> Procedure </span> <span style="color:blue"> Function </span> Application</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-11">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-11" aria-expanded="false" aria-controls="sidebar-collapse-11">
                <a href="./1.1.6.html"> 1.1.6  Conditional Expressions and Predicates</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-12">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-12" aria-expanded="false" aria-controls="sidebar-collapse-12">
                <a href="./1.1.7.html"> 1.1.7  Example: Square Roots by Newton s Method</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-13">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-13" aria-expanded="false" aria-controls="sidebar-collapse-13">
                <a href="./1.1.8.html"> 1.1.8  <span style="color:green"> Procedures </span> <span style="color:blue"> Functions </span> as Black-Box Abstractions</a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-14">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-14" aria-expanded="true" aria-controls="sidebar-collapse-14">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-14" aria-expanded="true" aria-controls="sidebar-collapse-14">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./1.2.html">1.2  <span style="color:green"> Procedures </span> <span style="color:blue"> Functions </span> and the Processes They Generate</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-14" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-15">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-15" aria-expanded="false" aria-controls="sidebar-collapse-15">
                <a href="./1.2.1.html"> 1.2.1  Linear Recursion and Iteration</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-16">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-16" aria-expanded="false" aria-controls="sidebar-collapse-16">
                <a href="./1.2.2.html"> 1.2.2  Tree Recursion</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-17">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-17" aria-expanded="false" aria-controls="sidebar-collapse-17">
                <a href="./1.2.3.html"> 1.2.3  Orders of Growth</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-18">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-18" aria-expanded="false" aria-controls="sidebar-collapse-18">
                <a href="./1.2.4.html"> 1.2.4  Exponentiation</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-19">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-19" aria-expanded="false" aria-controls="sidebar-collapse-19">
                <a href="./1.2.5.html"> 1.2.5  Greatest Common Divisors</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-20">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-20" aria-expanded="false" aria-controls="sidebar-collapse-20">
                <a href="./1.2.6.html"> 1.2.6  Example: Testing for Primality</a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-21">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-21" aria-expanded="true" aria-controls="sidebar-collapse-21">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-21" aria-expanded="true" aria-controls="sidebar-collapse-21">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./1.3.html">1.3  Formulating Abstractions with Higher-Order <span style="color:green"> Procedures </span> <span style="color:blue"> Functions </span></a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-21" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-22">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-22" aria-expanded="false" aria-controls="sidebar-collapse-22">
                <a href="./1.3.1.html"> 1.3.1  <span style="color:green"> Procedures </span> <span style="color:blue"> Functions </span> as Arguments</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-23">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-23" aria-expanded="false" aria-controls="sidebar-collapse-23">
                <a href="./1.3.2.html"> 1.3.2  <span style="color:green"> Constructing Procedures using Lambda </span> <span style="color:blue"> Constructing Functions using Lambda Expressions </span></a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-24">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-24" aria-expanded="false" aria-controls="sidebar-collapse-24">
                <a href="./1.3.3.html"> 1.3.3  <span style="color:green"> Procedures </span> <span style="color:blue"> Functions </span> as General Methods</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-25">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-25" aria-expanded="false" aria-controls="sidebar-collapse-25">
                <a href="./1.3.4.html"> 1.3.4  <span style="color:green"> Procedures </span> <span style="color:blue"> Functions </span> as Returned Values</a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-26">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-26" aria-expanded="true" aria-controls="sidebar-collapse-26">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-26" aria-expanded="true" aria-controls="sidebar-collapse-26">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./2.html">2  Building Abstractions with Data</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-26" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-27">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-27" aria-expanded="true" aria-controls="sidebar-collapse-27">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-27" aria-expanded="true" aria-controls="sidebar-collapse-27">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./2.1.html">2.1  Introduction to Data Abstraction</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-27" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-28">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-28" aria-expanded="false" aria-controls="sidebar-collapse-28">
                <a href="./2.1.1.html"> 2.1.1  Example: Arithmetic Operations for Rational Numbers</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-29">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-29" aria-expanded="false" aria-controls="sidebar-collapse-29">
                <a href="./2.1.2.html"> 2.1.2  Abstraction Barriers</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-30">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-30" aria-expanded="false" aria-controls="sidebar-collapse-30">
                <a href="./2.1.3.html"> 2.1.3  What Is Meant by Data?</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-31">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-31" aria-expanded="false" aria-controls="sidebar-collapse-31">
                <a href="./2.1.4.html"> 2.1.4  Extended Exercise: Interval Arithmetic</a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-32">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-32" aria-expanded="true" aria-controls="sidebar-collapse-32">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-32" aria-expanded="true" aria-controls="sidebar-collapse-32">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./2.2.html">2.2  Hierarchical Data and the Closure Property</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-32" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-33">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-33" aria-expanded="false" aria-controls="sidebar-collapse-33">
                <a href="./2.2.1.html"> 2.2.1  Representing Sequences</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-34">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-34" aria-expanded="false" aria-controls="sidebar-collapse-34">
                <a href="./2.2.2.html"> 2.2.2  Hierarchical Structures</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-35">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-35" aria-expanded="false" aria-controls="sidebar-collapse-35">
                <a href="./2.2.3.html"> 2.2.3  Sequences as Conventional Interfaces</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-36">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-36" aria-expanded="false" aria-controls="sidebar-collapse-36">
                <a href="./2.2.4.html"> 2.2.4  Example: A Picture Language</a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-37">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-37" aria-expanded="true" aria-controls="sidebar-collapse-37">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-37" aria-expanded="true" aria-controls="sidebar-collapse-37">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./2.3.html">2.3  Symbolic Data</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-37" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-38">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-38" aria-expanded="false" aria-controls="sidebar-collapse-38">
                <a href="./2.3.1.html"> 2.3.1  <span style="color:green"> Quotation </span> <span style="color:blue"> Strings </span></a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-39">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-39" aria-expanded="false" aria-controls="sidebar-collapse-39">
                <a href="./2.3.2.html"> 2.3.2  Example: Symbolic Differentiation</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-40">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-40" aria-expanded="false" aria-controls="sidebar-collapse-40">
                <a href="./2.3.3.html"> 2.3.3  Example: Representing Sets</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-41">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-41" aria-expanded="false" aria-controls="sidebar-collapse-41">
                <a href="./2.3.4.html"> 2.3.4  Example: Huffman Encoding Trees</a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-42">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-42" aria-expanded="true" aria-controls="sidebar-collapse-42">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-42" aria-expanded="true" aria-controls="sidebar-collapse-42">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./2.4.html">2.4  Multiple Representations for Abstract Data</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-42" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-43">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-43" aria-expanded="false" aria-controls="sidebar-collapse-43">
                <a href="./2.4.1.html"> 2.4.1  Representations for Complex Numbers</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-44">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-44" aria-expanded="false" aria-controls="sidebar-collapse-44">
                <a href="./2.4.2.html"> 2.4.2  Tagged data</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-45">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-45" aria-expanded="false" aria-controls="sidebar-collapse-45">
                <a href="./2.4.3.html"> 2.4.3  Data-Directed Programming and Additivity</a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-46">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-46" aria-expanded="true" aria-controls="sidebar-collapse-46">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-46" aria-expanded="true" aria-controls="sidebar-collapse-46">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./2.5.html">2.5  Systems with Generic Operations</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-46" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-47">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-47" aria-expanded="false" aria-controls="sidebar-collapse-47">
                <a href="./2.5.1.html"> 2.5.1  Generic Arithmetic Operations</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-48">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-48" aria-expanded="false" aria-controls="sidebar-collapse-48">
                <a href="./2.5.2.html"> 2.5.2  Combining Data of Different Types</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-49">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-49" aria-expanded="false" aria-controls="sidebar-collapse-49">
                <a href="./2.5.3.html"> 2.5.3  Example: Symbolic Algebra</a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-50">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-50" aria-expanded="true" aria-controls="sidebar-collapse-50">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-50" aria-expanded="true" aria-controls="sidebar-collapse-50">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./3.html">3  Modularity, Objects, and State</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-50" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-51">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-51" aria-expanded="true" aria-controls="sidebar-collapse-51">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-51" aria-expanded="true" aria-controls="sidebar-collapse-51">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./3.1.html">3.1  Assignment and Local State</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-51" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-52">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-52" aria-expanded="false" aria-controls="sidebar-collapse-52">
                <a href="./3.1.1.html"> 3.1.1  Local State Variables</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-53">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-53" aria-expanded="false" aria-controls="sidebar-collapse-53">
                <a href="./3.1.2.html"> 3.1.2  The Benefits of Introducing Assignment</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-54">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-54" aria-expanded="false" aria-controls="sidebar-collapse-54">
                <a href="./3.1.3.html"> 3.1.3  The Costs of Introducing Assignment</a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-55">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-55" aria-expanded="true" aria-controls="sidebar-collapse-55">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-55" aria-expanded="true" aria-controls="sidebar-collapse-55">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./3.2.html">3.2  The Environment Model of Evaluation</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-55" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-56">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-56" aria-expanded="false" aria-controls="sidebar-collapse-56">
                <a href="./3.2.1.html"> 3.2.1  The Rules for Evaluation</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-57">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-57" aria-expanded="false" aria-controls="sidebar-collapse-57">
                <a href="./3.2.2.html"> 3.2.2  Applying Simple <span style="color:green"> Procedures </span> <span style="color:blue"> Functions </span></a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-58">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-58" aria-expanded="false" aria-controls="sidebar-collapse-58">
                <a href="./3.2.3.html"> 3.2.3  Frames as the Repository of Local State</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-59">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-59" aria-expanded="false" aria-controls="sidebar-collapse-59">
                <a href="./3.2.4.html"> 3.2.4  Internal <span style="color:green"> Definitions </span> <span style="color:blue"> Declarations </span></a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-60">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-60" aria-expanded="true" aria-controls="sidebar-collapse-60">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-60" aria-expanded="true" aria-controls="sidebar-collapse-60">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./3.3.html">3.3  Modeling with Mutable Data</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-60" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-61">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-61" aria-expanded="false" aria-controls="sidebar-collapse-61">
                <a href="./3.3.1.html"> 3.3.1  Mutable List Structure</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-62">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-62" aria-expanded="false" aria-controls="sidebar-collapse-62">
                <a href="./3.3.2.html"> 3.3.2  Representing Queues</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-63">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-63" aria-expanded="false" aria-controls="sidebar-collapse-63">
                <a href="./3.3.3.html"> 3.3.3  Representing Tables</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-64">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-64" aria-expanded="false" aria-controls="sidebar-collapse-64">
                <a href="./3.3.4.html"> 3.3.4  A Simulator for Digital Circuits</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-65">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-65" aria-expanded="false" aria-controls="sidebar-collapse-65">
                <a href="./3.3.5.html"> 3.3.5  Propagation of Constraints</a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-66">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-66" aria-expanded="true" aria-controls="sidebar-collapse-66">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-66" aria-expanded="true" aria-controls="sidebar-collapse-66">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./3.4.html">3.4  Concurrency: Time Is of the Essence</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-66" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-67">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-67" aria-expanded="false" aria-controls="sidebar-collapse-67">
                <a href="./3.4.1.html"> 3.4.1  The Nature of Time in Concurrent Systems</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-68">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-68" aria-expanded="false" aria-controls="sidebar-collapse-68">
                <a href="./3.4.2.html"> 3.4.2  Mechanisms for Controlling Concurrency</a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-69">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-69" aria-expanded="true" aria-controls="sidebar-collapse-69">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-69" aria-expanded="true" aria-controls="sidebar-collapse-69">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./3.5.html">3.5  Streams</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-69" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-70">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-70" aria-expanded="false" aria-controls="sidebar-collapse-70">
                <a href="./3.5.1.html"> 3.5.1  Streams Are Delayed Lists</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-71">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-71" aria-expanded="false" aria-controls="sidebar-collapse-71">
                <a href="./3.5.2.html"> 3.5.2  Infinite Streams</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-72">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-72" aria-expanded="false" aria-controls="sidebar-collapse-72">
                <a href="./3.5.3.html"> 3.5.3  Exploiting the Stream Paradigm</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-73">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-73" aria-expanded="false" aria-controls="sidebar-collapse-73">
                <a href="./3.5.4.html"> 3.5.4  Streams and Delayed Evaluation</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-74">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-74" aria-expanded="false" aria-controls="sidebar-collapse-74">
                <a href="./3.5.5.html"> 3.5.5  Modularity of Functional Programs and Modularity of Objects</a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-75">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-75" aria-expanded="true" aria-controls="sidebar-collapse-75">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-75" aria-expanded="true" aria-controls="sidebar-collapse-75">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./4.html">4  Metalinguistic Abstraction</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-75" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-76">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-76" aria-expanded="true" aria-controls="sidebar-collapse-76">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-76" aria-expanded="true" aria-controls="sidebar-collapse-76">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./4.1.html">4.1  The Metacircular Evaluator</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-76" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-77">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-77" aria-expanded="false" aria-controls="sidebar-collapse-77">
                <a href="./4.1.1.html"> 4.1.1  The Core of the Evaluator</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-78">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-78" aria-expanded="false" aria-controls="sidebar-collapse-78">
                <a href="./4.1.2.html"> 4.1.2  Representing <span style="color:green"> Expressions </span> <span style="color:blue"> Statements and Expressions </span></a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-79">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-79" aria-expanded="false" aria-controls="sidebar-collapse-79">
                <a href="./4.1.3.html"> 4.1.3  Evaluator Data Structures</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-80">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-80" aria-expanded="false" aria-controls="sidebar-collapse-80">
                <a href="./4.1.4.html"> 4.1.4  Running the Evaluator as a Program</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-81">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-81" aria-expanded="false" aria-controls="sidebar-collapse-81">
                <a href="./4.1.5.html"> 4.1.5  Data as Programs</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-82">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-82" aria-expanded="false" aria-controls="sidebar-collapse-82">
                <a href="./4.1.6.html"> 4.1.6  Internal <span style="color:green"> Definitions </span> <span style="color:blue"> Declarations </span></a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-83">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-83" aria-expanded="false" aria-controls="sidebar-collapse-83">
                <a href="./4.1.7.html"> 4.1.7  Separating Syntactic Analysis from Execution</a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-84">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-84" aria-expanded="true" aria-controls="sidebar-collapse-84">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-84" aria-expanded="true" aria-controls="sidebar-collapse-84">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./4.2.html">4.2  <span style="color:green"> Variations on a Scheme: </span> Lazy Evaluation</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-84" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-85">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-85" aria-expanded="false" aria-controls="sidebar-collapse-85">
                <a href="./4.2.1.html"> 4.2.1  Normal Order and Applicative Order</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-86">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-86" aria-expanded="false" aria-controls="sidebar-collapse-86">
                <a href="./4.2.2.html"> 4.2.2  An Interpreter with Lazy Evaluation</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-87">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-87" aria-expanded="false" aria-controls="sidebar-collapse-87">
                <a href="./4.2.3.html"> 4.2.3  Streams as Lazy Lists</a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-88">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-88" aria-expanded="true" aria-controls="sidebar-collapse-88">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-88" aria-expanded="true" aria-controls="sidebar-collapse-88">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./4.3.html">4.3  <span style="color:green"> Variations on a Scheme: </span> Nondeterministic Computing</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-88" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-89">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-89" aria-expanded="false" aria-controls="sidebar-collapse-89">
                <a href="./4.3.1.html"> 4.3.1  <span style="color:green"> Amb and Search </span> <span style="color:blue"> Search and amb </span></a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-90">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-90" aria-expanded="false" aria-controls="sidebar-collapse-90">
                <a href="./4.3.2.html"> 4.3.2  Examples of Nondeterministic Programs</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-91">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-91" aria-expanded="false" aria-controls="sidebar-collapse-91">
                <a href="./4.3.3.html"> 4.3.3  Implementing the <span style="color:green"> Amb </span> <span style="color:blue"> amb </span> Evaluator</a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-92">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-92" aria-expanded="true" aria-controls="sidebar-collapse-92">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-92" aria-expanded="true" aria-controls="sidebar-collapse-92">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./4.4.html">4.4  Logic Programming</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-92" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-93">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-93" aria-expanded="false" aria-controls="sidebar-collapse-93">
                <a href="./4.4.1.html"> 4.4.1  Deductive Information Retrieval</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-94">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-94" aria-expanded="false" aria-controls="sidebar-collapse-94">
                <a href="./4.4.2.html"> 4.4.2  How the Query System Works</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-95">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-95" aria-expanded="false" aria-controls="sidebar-collapse-95">
                <a href="./4.4.3.html"> 4.4.3  Is Logic Programming Mathematical Logic?</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-96">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-96" aria-expanded="false" aria-controls="sidebar-collapse-96">
                <a href="./4.4.4.html"> 4.4.4  Implementing the Query System</a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-97">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-97" aria-expanded="true" aria-controls="sidebar-collapse-97">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-97" aria-expanded="true" aria-controls="sidebar-collapse-97">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./5.html">5  Computing with Register Machines</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-97" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-98">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-98" aria-expanded="true" aria-controls="sidebar-collapse-98">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-98" aria-expanded="true" aria-controls="sidebar-collapse-98">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./5.1.html">5.1  Designing Register Machines</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-98" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-99">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-99" aria-expanded="false" aria-controls="sidebar-collapse-99">
                <a href="./5.1.1.html"> 5.1.1  A Language for Describing Register Machines</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-100">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-100" aria-expanded="false" aria-controls="sidebar-collapse-100">
                <a href="./5.1.2.html"> 5.1.2  Abstraction in Machine Design</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-101">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-101" aria-expanded="false" aria-controls="sidebar-collapse-101">
                <a href="./5.1.3.html"> 5.1.3  Subroutines</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-102">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-102" aria-expanded="false" aria-controls="sidebar-collapse-102">
                <a href="./5.1.4.html"> 5.1.4  Using a Stack to Implement Recursion</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-103">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-103" aria-expanded="false" aria-controls="sidebar-collapse-103">
                <a href="./5.1.5.html"> 5.1.5  Instruction Summary</a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-104">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-104" aria-expanded="true" aria-controls="sidebar-collapse-104">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-104" aria-expanded="true" aria-controls="sidebar-collapse-104">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./5.2.html">5.2  A Register-Machine Simulator</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-104" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-105">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-105" aria-expanded="false" aria-controls="sidebar-collapse-105">
                <a href="./5.2.1.html"> 5.2.1  The Machine Model</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-106">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-106" aria-expanded="false" aria-controls="sidebar-collapse-106">
                <a href="./5.2.2.html"> 5.2.2  The Assembler</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-107">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-107" aria-expanded="false" aria-controls="sidebar-collapse-107">
                <a href="./5.2.3.html"> 5.2.3  Generating Execution <span style="color:green"> Procedures </span> <span style="color:blue"> Functions </span> for Instructions</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-108">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-108" aria-expanded="false" aria-controls="sidebar-collapse-108">
                <a href="./5.2.4.html"> 5.2.4  Monitoring Machine Performance</a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-109">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-109" aria-expanded="true" aria-controls="sidebar-collapse-109">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-109" aria-expanded="true" aria-controls="sidebar-collapse-109">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./5.3.html">5.3  Storage Allocation and Garbage Collection</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-109" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-110">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-110" aria-expanded="false" aria-controls="sidebar-collapse-110">
                <a href="./5.3.1.html"> 5.3.1  Memory as Vectors</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-111">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-111" aria-expanded="false" aria-controls="sidebar-collapse-111">
                <a href="./5.3.2.html"> 5.3.2  Maintaining the Illusion of Infinite Memory</a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-112">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-112" aria-expanded="true" aria-controls="sidebar-collapse-112">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-112" aria-expanded="true" aria-controls="sidebar-collapse-112">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./5.4.html">5.4  The Explicit-Control Evaluator</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-112" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-113">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-113" aria-expanded="false" aria-controls="sidebar-collapse-113">
                <a href="./5.4.1.html"> 5.4.1  The Core of the Explicit-Control Evaluator</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-114">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-114" aria-expanded="false" aria-controls="sidebar-collapse-114">
                <a href="./5.4.2.html"> 5.4.2  Sequence Evaluation and Tail Recursion</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-115">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-115" aria-expanded="false" aria-controls="sidebar-collapse-115">
                <a href="./5.4.3.html"> 5.4.3  Conditionals, Assignments, and <span style="color:green"> Definitions </span> <span style="color:blue"> Declarations and Blocks </span></a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-116">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-116" aria-expanded="false" aria-controls="sidebar-collapse-116">
                <a href="./5.4.4.html"> 5.4.4  Running the Evaluator</a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-117">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-117" aria-expanded="true" aria-controls="sidebar-collapse-117">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-117" aria-expanded="true" aria-controls="sidebar-collapse-117">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./5.5.html">5.5  Compilation</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-117" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-118">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-118" aria-expanded="false" aria-controls="sidebar-collapse-118">
                <a href="./5.5.1.html"> 5.5.1  Structure of the Compiler</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-119">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-119" aria-expanded="false" aria-controls="sidebar-collapse-119">
                <a href="./5.5.2.html"> 5.5.2  Compiling <span style="color:blue"> Statements and </span> Expressions</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-120">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-120" aria-expanded="false" aria-controls="sidebar-collapse-120">
                <a href="./5.5.3.html"> 5.5.3  Compiling <span style="color:green"> Combinations </span> <span style="color:blue"> Applications </span></a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-121">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-121" aria-expanded="false" aria-controls="sidebar-collapse-121">
                <a href="./5.5.4.html"> 5.5.4  Combining Instruction Sequences</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-122">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-122" aria-expanded="false" aria-controls="sidebar-collapse-122">
                <a href="./5.5.5.html"> 5.5.5  An Example of Compiled Code</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-123">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-123" aria-expanded="false" aria-controls="sidebar-collapse-123">
                <a href="./5.5.6.html"> 5.5.6  Lexical Addressing</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-124">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-124" aria-expanded="false" aria-controls="sidebar-collapse-124">
                <a href="./5.5.7.html"> 5.5.7  Interfacing Compiled Code to the Evaluator</a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
                </div>
              </div>
            </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-125">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-125" aria-expanded="false" aria-controls="sidebar-collapse-125">
                <a href="./references.html">  References</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-126">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-126" aria-expanded="false" aria-controls="sidebar-collapse-126">
                <a href="./making-of.html">  Making of the JavaScript Adaptation</a>
              </span>
            </h5>
          </div>
        </div>
        </div>
<div id='permalink-msg'>
<div class='screen'>
  <div class='alert alert-success'>
    <strong>Permalink copied!</strong>
  </div>
</div>
</div>
<div class='chapter-content'>

      <div class='chapter-title'>
        <div class='permalink'>
        <a name='top' class='permalink'> 
    2.4.3  Data-Directed Programming and Additivity
        </a>
        </div>
      </div>
      <div class='chapter-text'>
        <div class='SECTION'><SECTION>
    

  
  
  

  <div class='permalink'>
<a name='p1' class='permalink'></a><p>
    
    The general strategy of checking the type of a datum and calling an
    appropriate
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    is called
    
    
    <EM>dispatching on type</EM>.  This is a powerful strategy for obtaining
    modularity in system design.  On the other hand, implementing the dispatch
    as in section&nbsp;<REF NAME="sec:manifest-types"><a class="superscript" id="2.4.3-sec-link-2.4.2" href="./2.4.2.html">2.4.2</a></REF> has two significant
    weaknesses.  One weakness is that the generic interface
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    
      <span style="color:green">(<kbd>real-part</kbd>,</span>
      <span style="color:blue">(<kbd>real_part</kbd>,</span>
    
    
      <span style="color:green"><kbd>imag-part</kbd>,</span>
      <span style="color:blue"><kbd>imag_part</kbd>,</span>
    
    <kbd>magnitude</kbd>, and
    <kbd>angle</kbd>) must know about all the different
    representations.  For instance, suppose we wanted to incorporate a new
    representation for complex numbers into our complex-number system.  We
    would need to identify this new representation with a type, and then add a
    clause to each of the generic interface
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    to check for the new type and apply the appropriate selector for that
    representation.
  </p></div>
  <div class='permalink'>
<a name='p2' class='permalink'></a><p>
    Another weakness of the technique is that even though the individual
    representations can be designed separately, we must guarantee that no two
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    in the entire system have the same name.  This is why Ben and Alyssa had
    to change the names of their original
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    from section&nbsp;<REF NAME="sec:representations-complex-numbers"><a class="superscript" id="2.4.3-sec-link-2.4.1" href="./2.4.1.html">2.4.1</a></REF>.
  </p></div>
  <div class='permalink'>
<a name='p3' class='permalink'></a><p>
    The issue underlying both of these weaknesses is that the technique for
    implementing generic interfaces is not <EM>additive</EM>.  The person
    implementing the generic selector
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    must modify those
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    each time a new representation is installed, and the people
    interfacing the individual representations must modify their
    code to avoid name conflicts.  In each of these cases, the changes
    that must be made to the code are straightforward, but they must be
    made nonetheless, and this is a source of inconvenience and error.
    This is not much of a problem for the complex-number system as it
    stands, but suppose there were not two but hundreds of different
    representations for complex numbers.  And suppose that there were many
    generic selectors to be maintained in the abstract-data interface.
    Suppose, in fact, that no one programmer knew all the interface
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    or all the representations.  The problem is real and must
    be addressed in such programs as large-scale data-base-management
    systems.
  </p></div>
  <div class='permalink'>
<a name='p4' class='permalink'></a><p>
    What we need is a means for modularizing the system design even
    further.  This is provided by the programming technique known as <EM>
    data-directed programming</EM>.  To understand how data-directed
    programming works, begin with the observation that whenever we deal
    with a set of generic operations that are common to a set of
    different types we are, in effect, dealing with a two-dimensional
    table that contains the possible operations on one axis and the
    possible types on the other axis.  The entries in the table are the
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    that implement each operation for each type of argument presented.
    In the complex-number system developed in the previous section, the
    correspondence between operation name, data type, and  actual
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    was spread out among the various conditional clauses in the generic
    interface
    
      <span style="color:green">procedures.</span>
      <span style="color:blue">functions.</span>
    
    But the same information could have been organized in a table, as shown in
    
      <span style="color:green">
	figure&nbsp;<REF NAME="fig:operator-table_scheme"><a class="superscript" id="2.4.3-fig-link-2.31" href="./2.4.3.html#fig_2.31">2.31</a></REF>.
      </span>
      <span style="color:blue">
	figure&nbsp;<REF NAME="fig:operator-table"><a class="superscript" id="2.4.3-fig-link-2.32" href="./2.4.3.html#fig_2.32">2.32</a></REF>.
      </span>
    
  </p></div>
  <div class='permalink'>
<a name='p5' class='permalink'></a><p>
    
    Data-directed programming is the technique of designing programs to work
    with such a table directly.  Previously, we implemented the mechanism that
    interfaces the complex-arithmetic code with the two representation packages
    as a set of
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    that each perform an explicit dispatch on type.  Here we will implement the
    interface as a single
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    that looks up the combination of the operation name and argument type in
    the table to find the correct
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    to apply, and then applies it to the contents of the argument.  If we do
    this, then to add a new representation package to the system we need not
    change any existing
    
      <span style="color:green">procedures;</span>
      <span style="color:blue">functions;</span>
    
    we need only add new entries to the table.
  </p></div>
  <div class='permalink'>
<a name='p6' class='permalink'></a><p>
    <table width="100%">
        <colgroup><col width="48%"><col width="1%"><col width="51%"></colgroup>
        <tr>
          <td class="meta" style = "color:grey; text-align: center">Original</td>
          <td></td>
          <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
        </tr>
        <tr><td><span style="color:green">
        
    <FIGURE>
      <img class="scale_factor_" id="fig_2.31" src="../img_original/ch2-Z-G-63.svg">
      <div class="chapter-text-CAPTION">
      <b><a class="caption" href="./2.4.3.html#fig_2.31">Figure 2.31 </a></b>Table of operations for the complex-number system.</div>
    </FIGURE>
  
      </span>    </td>
          <td></td>
          <td><span style="color:blue">
        
    <FIGURE>
      <img class="scale_factor_" id="fig_2.32" src="../img_javascript/ch2-Z-G-63.svg">
      <div class="chapter-text-CAPTION">
      <b><a class="caption" href="./2.4.3.html#fig_2.32">Figure 2.32 </a></b>Table of operations for the complex-number system.</div>
    </FIGURE>
  
      </span></td></tr></table>
    To implement this plan, assume that we have two
    
      <span style="color:green">procedures,</span>
      <span style="color:blue">functions,</span>
    
    <kbd>put</kbd> and <kbd>get</kbd>, for
    manipulating the operation-and-type table:
    
    <UL>
      
      <LI>
	
	  <span style="color:green">
	    <kbd>(put </kbd>
	    $\langle \textit{op} \rangle\ \langle \textit{type}
	    \rangle \ \langle \textit{item} \rangle$
	    
	    <kbd>)</kbd>
	  </span>
	  <span style="color:blue">
	    <kbd>put(</kbd>$\textit{op}$<kbd>,</kbd> $\textit{type}$<kbd>,</kbd> $\textit{item}$<kbd>)</kbd>
	  </span>
	
	<br>
	installs the
	
	  <span style="color:green">
	    $\langle \textit{item} \rangle$
	  </span>
	  <span style="color:blue">
	    $\textit{item}$
	  </span>
	
	in the table, indexed by the
	
	  <span style="color:green">
	    $\langle \textit{op} \rangle$ and the
	    $\langle \textit{type} \rangle$.
	  </span>
	  <span style="color:blue">
	    $\textit{op}$ and the
	    $\textit{type}$.
	  </span>
	
	
      </LI>
      <LI>
	
	  <span style="color:green">
	    <kbd>(get </kbd>
	    $\langle \textit{op} \rangle\ \langle
	    \textit{type}$
	    <kbd>)</kbd>
	  </span>
	  <span style="color:blue">
	    <kbd>get(</kbd>$\textit{op}$<kbd>,</kbd> $\textit{type}$<kbd>)</kbd>
	  </span>
	
	<br>
	looks up the
	
	  <span style="color:green">
	    $\langle \textit{op} \rangle$,
	    $\langle \textit{type} \rangle$
	  </span>
	  <span style="color:blue">
	    $\textit{op}$,
	    $\textit{type}$
	  </span>
	
	entry in the table and returns the item found there.
	If no item is found,
	<kbd>get</kbd> returns
	
	  <span style="color:green">false.</span>
	  <span style="color:blue">
	    a unique primitive value that is referred to by the name
	    <kbd>undefined</kbd>.<a class='superscript' id='footnote-link-1' href='#footnote-1'style="color:blue">[1]</a>
	  </span>
	
      </LI>
    </UL>
    For now, we can assume that <kbd>put</kbd> and
    <kbd>get</kbd> are included in our language.  In
    chapter&nbsp;3 (section&nbsp;<REF NAME="sec:tables"><a class="superscript" id="2.4.3-sec-link-3.3.3" href="./3.3.3.html">3.3.3</a></REF>) we will see
    how to implement these and other operations for manipulating tables.
  </p></div>
  <div class='permalink'>
<a name='p7' class='permalink'></a><p>
    Here is how data-directed programming can be used in the complex-number
    system.  Ben, who developed the rectangular representation, implements his
    code just as he did originally.  He defines a collection of
    
      <span style="color:green">procedures,</span>
      <span style="color:blue">functions</span>
    
    or a
    
    <EM>package</EM>, and interfaces these to the rest of the system by adding
    entries to the table that tell the system how to operate on rectangular
    numbers. This is accomplished by calling the following
    
      <span style="color:green">procedure:</span>
      <span style="color:blue">function:</span>
    
    
    
    
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_44_1_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (install-rectangular-package)
  ;; internal procedures
  (define (real-part z) (car z))
  (define (imag-part z) (cdr z))
  (define (make-from-real-imag x y) (cons x y))
  (define (magnitude z)
    (sqrt (+ (square (real-part z))
             (square (imag-part z)))))
  (define (angle z)
    (atan (imag-part z) (real-part z)))
  (define (make-from-mag-ang r a)
    (cons (* r (cos a)) (* r (sin a))))

  ;; interface to the rest of the system
  (define (tag x) (attach-tag 'rectangular x))
  (put 'real-part '(rectangular) real-part)
  (put 'imag-part '(rectangular) imag-part)
  (put 'magnitude '(rectangular) magnitude)
  (put 'angle '(rectangular) angle)
  (put 'make-from-real-imag 'rectangular
       (lambda (x y) (tag (make-from-real-imag x y))))
  (put 'make-from-mag-ang 'rectangular
       (lambda (r a) (tag (make-from-mag-ang r a))))
  'done)</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_44_1_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=3&prgrm=PTAEGUEkGEAVQFLlAJgHQBY0GYBQuRQB7ABwFMAnAQwBcBLIgOwH0aqAjAGzIBpQSArjVBVGAE1ABzMjQJgAZhSIBbUAGMAFlRI1KobKAAUAZzJr6TfThwBKfPIGNzDRiOPGiawwGsyATz4KMyIKMWMbUABvXFBY0CCaAQpXOmNmRgFOTkMgtRCwuziiooB+UEcxMnk6RjIxGOLigC5QMgBHASps3wDQDTIqMUN+wZzg0PCbQsbGspGh3Pzwhpmilqp3Tx9-PjY6bMWJqYBuXABfe0dnS2UqX1YObkMI6KK8xmNhTk8uh64yUAAXlAnFSNEMACIAFRsf5QiE2U5FBxOCyub5EbwCEjbPzMACMfB6zBQLxWxXen1AxgE7Fh3CBbg8XmJhNAe2y3zUv3pZBO5KKdHkRhpdMeAMBkvK4iqNTqZNWRQSSVcFVltTESJmZ1anFMUQFM0pwkOEmBG2ZuJJuyo+xMtN5-MVcSFRlNQKlauqGoVzuKyuS0sq3rqWudOrIeoBrz9SpkKvZtoO4zEiMNjQuq0zcWzsRR1xSH0o4NZRP81tAADcugI+QbVsbqQ7xYyLVtS4m7VyeeKnTNXfaxf8PcCvXLU-W-aYaA8uz9OH9uDx07HYiRbRRDKDPla2eu6JviSg+NXOLWpsvV6uOVv54u+X2M7r9THnY33ebNizy8fO9lRY6aaxgOH6ejKIYTq+cQAJCrNOs7-s2-zLrBV6rPum4YVav6nuel5oVeN4Ab2-KobEEZRpOV7wTeponjWfJhoqubFCxLH5mioBiKk640JohjKL6jQBq4qiSsCEIYliJAQiuMxlFJ2JyY0LRiVKEI1KYFA0LJBGgGUmnFspMwtJQSibsofAQgAqow3iMEQADurikJQtAuKAAC0nmJv8CJMSxIlcTxtCaKcFy4I2rnUGi96Mrc9y8s8pyNtIwjAtF7lMPekKKTJaaNoI6XEOQMUuDlGlFtp-mXKiHm0GwmgPJIhg0H45DNXw7y6IwNDhFR8TxoGWFtR1bCSF1TA9X1aYXBxHmjWQzWGGItACIJA1BakzBYatiSCcZcwDEMe3rdMiqmRQ5krWtlmgBC7CDImkjSBIp2qN57LtUt401XNVycd1ZC9cYN37UJg2JIG227bd52rGUN7vfDJmtFdIRg+tVmPRI42vVxt1eT5QMg39tUFtSHRUEEhgAB4Q0FtOgFCoC0+F5OcZpbBZMwuRsIwkiZNTO1UGo3hUNIzwDYQNS6MkXSgPNTDGOSSuuEEvzrtphgAF4vJDCbzLriKgOxAMeXQtySCL2t61EBuBjeevHKbqvmzcdxLYoKi8wMC6WxLdN8H4+tBVhtPBybZt1R7kiMHQiSVMbA1xlDom0BozDGG02vZ50NMawuWvgnrEQANTGXBVM0wH1vF8bj6u8i7uuKIkhPHbUGpwmtw0JntCiIYtc2yXNiBH7I8NwFbsx+n9ze8ozBW8wbc5HwVAQ93w0bjkzOgL3md5KDG+BHvB9ZzUhgb0BOb4EUMu9ZQ8iiwCNBEOy-SDVSRDCn3ALGH4T4ZBlAzwpuNOmm84hBQaqLTO4CIR8zbkLCgEI+D02nkUIqkJC4j1QSCME2CzD80FpwamCJx6a2pjQG+a4hCQmHsXPB25wQIKIUg0hKCx6gAYVQmh-A6EQitvHROZAmEENYeYdhZCuFCITgISofCsEQjbtwMRO4JHEOQeQkQAtuCKIEQlL2ShF44NrngjRUiUH4UaEHUAIcgQAD5noCU9swBevtfi11sSHRuSjDFuOMUvCWK8BbmMQQLLR1jihrxEBEQETjwH+PccvVeFB15TD4UFCEYgmCiPZrgLmXQFzhJIcLdcYsJZkGSkAA')">function install_rectangular_package() {
    // internal functions
    function real_part(z) { return head(z); }
    function imag_part(z) { return tail(z); }
    function make_from_real_imag(x, y) { return pair(x, y); }
    function magnitude(z) {
        return math_sqrt(square(real_part(z)) +
                   square(imag_part(z)));
    }
    function angle(z) {
        return math_atan(imag_part(z), real_part(z));
    }
    function make_from_mag_ang(r, a) {
        return pair(r * math_cos(a), r * math_sin(a));
    }

    // interface to the rest of the system
    function tag(x) {
        return attach_tag("rectangular", x);
    }
    put("real_part", list("rectangular"), real_part);
    put("imag_part", list("rectangular"), imag_part);
    put("magnitude", list("rectangular"), magnitude);
    put("angle", list("rectangular"), angle);
    put("make_from_real_imag", "rectangular",
        (x, y) => tag(make_from_real_imag(x, y)));
    put("make_from_mag_ang", "rectangular",
        (r, a) => tag(make_from_mag_ang(r, a)));
    return "done";
}

install_rectangular_package();
</pre></div></div></td></tr></table>
    Notice that the internal
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    here are the same
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    from section&nbsp;<REF NAME="sec:representations-complex-numbers"><a class="superscript" id="2.4.3-sec-link-2.4.1" href="./2.4.1.html">2.4.1</a></REF> that
    Ben wrote when he was working in isolation.  No changes are necessary in
    order to interface them to the rest of the system.  Moreover, since these
    
      <span style="color:green">procedure definitions</span>
      <span style="color:blue">function declarations</span>
    
    are internal to the installation
    
      <span style="color:green">procedure,</span>
      <span style="color:blue">function,</span>
    
    Ben needn't worry about name conflicts with other
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    outside the rectangular package.  To interface these to the rest of the
    system, Ben installs his
    
      <span style="color:green"><kbd>real-part</kbd></span>
      <span style="color:blue"><kbd>real_part</kbd></span>
    
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    under the operation name
    
      <span style="color:green"><kbd>real-part</kbd></span>
      <span style="color:blue"><kbd>real_part</kbd></span>
    
    and the type
    
      <span style="color:green">
      <kbd>(rectangular)</kbd>,</span>
      <span style="color:blue"><kbd>list("rectangular")</kbd>,
      </span>
    
    and similarly for the other selectors.<a class='superscript' id='footnote-link-2' href='#footnote-2'>[2]</a>  The interface also defines the
    constructors to be used by the external system.<a class='superscript' id='footnote-link-3' href='#footnote-3'>[3]</a> These are identical to Ben's internally defined
    constructors, except that they attach the tag.
    
    
  </p></div>
  <div class='permalink'>
<a name='p8' class='permalink'></a><p>
    Alyssa's polar package is analogous:
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_44_2_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (install-polar-package)
  ;; internal procedures
  (define (magnitude z) (car z))
  (define (angle z) (cdr z))
  (define (make-from-mag-ang r a) (cons r a))
  (define (real-part z)
    (* (magnitude z) (cos (angle z))))
  (define (imag-part z)
    (* (magnitude z) (sin (angle z))))
  (define (make-from-real-imag x y)
    (cons (sqrt (+ (square x) (square y)))
          (atan y x)))

  ;; interface to the rest of the system
  (define (tag x) (attach-tag 'polar x))
  (put 'real-part '(polar) real-part)
  (put 'imag-part '(polar) imag-part)
  (put 'magnitude '(polar) magnitude)
  (put 'angle '(polar) angle)
  (put 'make-from-real-imag 'polar
       (lambda (x y) (tag (make-from-real-imag x y))))
  (put 'make-from-mag-ang 'polar
       (lambda (r a) (tag (make-from-mag-ang r a))))
  'done)</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_44_2_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=4&prgrm=PTAEGUEkGEAVQFLlAJgHQBY0GYBQuRQB7ABwFMAnAQwBcBLIgOwH0aqAjAGzIBpQSArjVBVGAE1ABzMjQJgAZhSIBbUAGMAFlRI1KobKAAUAZzJr6TfThwBKfPIGNzDRiOPGiawwGsyATz4KMyIKMWMbUABvXFBY0CCaAQpXOmNmRgFOTkMgtRCwuziiooB+UEcxMnk6RjIxGOLigC5QMgBHASps3wDQDTIqMUN+wZzg0PCbQsbGspGh3Pzwhpmilqp3Tx9-PjY6bMWJqYBuXABfe0dnS2UqX1YObkMI6KK8xmNhTk8uh64yUAAXlAnFSNEMACIAFRsf5QiE2U5FBxOCyub5EbwCEjbPzMACMfB6zBQLxWxXen1AxgE7Fh3CBbg8XmJhNAe2y3zUv3pZBO5KKdHkRhpdMeAMBkvK4iqNTqZNWRQSSVcFVltTESJmZ1anFMUQFM0pwkOEmBG2ZuJJuyo+xMtN5-MVcSFRlNQKlauqGoVzuKyuS0sq3rqWudOrIeoBrz9SpkKvZtoO4zEiMNjQuq0zcWzsRR1xSH0o4NZRP81tAADcugI+QbVsbqQ7xYyLVtS4m7VyeeKnTNXfaxf8PcCvXLU-W-aYaA8uz9OH9uDx07HYiRbRRDKDPla2eu6JviSg+NXOLWpsvV6uOVv54u+X2M7r9THnY33ebNizy8fO9lRY6aaxgOH6ejKIYTq+cQAJCrNOs7-s2-zLrBV6rPum4YVav6nuel5oVeN4Ab2-KobEEZRpOV7wTeponjWfJhoqubFCxLH5mioBiKk640JohjKL6jQBq4qiSsCEIYliJAQiuMxlFJ2JyY0LRiVKEI1KYFA0LJBGgGUmnFspMwtJQSibsofAQgAqow3iMEQADurikJQtAuKAAC0nmJv8CJMSxIlcTxtCaKcFy4I2rnUGi96Mrc9y8s8pyNtIwjAtF7lMPekKKTJaaNoI6XEOQMUuDlGlFtp-mXKiHm0GwmgPJIhg0H45DNXw7y6IwNDhFR8TxoGWFtR1bCSF1TA9X1aYXBxHmjWQzWGGItACIJA1BakzBYatiSCcZcwDEMe3rdMiqmRQ5krWtlmgBC7CDImkjSBIp2qN57LtUt401XNVycd1ZC9cYN37UJg2JIG227bd52rGUN7vfDJmtFdIRg+tVmPRI42vVxt1eT5QMg39tUFtSHRUEEhgAB4Q0FtOgFCoC0+F5OcZpbBZDtRCcNTO1UGo3hUNIzwDYQNS6MkXSgPNTDGOS8uiaLjB0IklSGAAXi8kMJvM2uIqA7EA-VjCSE8OtRHrgY3jrxzG0rps3HcS2KCozC3JIzCiC1FB8FQutBVh-siEbJt1ZYQS-Ou2mGwNcRBV7asa2Q8cs7cNAaMweSg77luPo7yLOykXuC3HVtQYnQ0q5IKcCJrVsZ7Q2fGDUhj52nOtATmTuRyr9zu8ozDRwudBe3TfB+BD1dQ64WGZ63bRx8YVM0-ToAANSU50NPTzY+F6YvPtsIwhi9PTPfkfgRSS71lDyELAI0EQ7L9INVJEMKWcAsYfifGQZQfcKbjTpkHGuIgaCNWzqAiEJA+bUwhHwemDsWJFUhKPcuOk+DbnBHAhBFAESBAGAuWONAr78CEJCceossFIJBGCSE8D+aEIPqAGh3syEUPQRCZO6sG5kHobgphBCiGgD4anbhVCISdyEYw-BLCxGdykXghKbslDD0wRw+hCjEF8BXJPUA08gQAD5noCVdswIeI8SHMA4YY-eKjIRqKsRoz2tDfY6OYXogxodA6mPMS46xZdfY5ADlMChQUIRiCYII9muAuZdFIQQwWwtRZp0REAA')">function install_polar_package() {
    // internal functions
    function magnitude(z) { return head(z); }
    function angle(z) { return tail(z); }
    function make_from_mag_ang(r, a) { return pair(r, a); }
    function real_part(z) {
       return magnitude(z) * math_cos(angle(z));
    }
    function imag_part(z) {
       return magnitude(z) * math_sin(angle(z));
    }
    function make_from_real_imag(x, y) {
       return pair(math_sqrt(square(x) + square(y)),
                   math_atan(y, x));
    }

    // interface to the rest of the system
    function tag(x) { return attach_tag("polar", x); }
    put("real_part", list("polar"), real_part);
    put("imag_part", list("polar"), imag_part);
    put("magnitude", list("polar"), magnitude);
    put("angle", list("polar"), angle);
    put("make_from_real_imag", "polar", 
        (x, y) => tag(make_from_real_imag(x, y)));
    put("make_from_mag_ang", "polar",
        (r, a) => tag(make_from_mag_ang(r, a)));
    return "done";
}
</pre></div></div></td></tr></table>
    
  </p></div>
  <div class='permalink'>
<a name='p9' class='permalink'></a><p>
    Even though Ben and Alyssa both still use their original
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    defined with the same names as each other's (e.g.,
    
      <span style="color:green"><kbd>real-part</kbd>),</span>
      <span style="color:blue"><kbd>real_part</kbd>),</span>
    
    these definitions are now internal to different
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    (see section&nbsp;<REF NAME="sec:block-structure"><a class="superscript" id="2.4.3-sec-link-1.1.8" href="./1.1.8.html">1.1.8</a></REF>), so there is no name
    conflict.
  </p></div>
  <div class='permalink'>
<a name='p10' class='permalink'></a><p>
    The complex-arithmetic selectors access the table by means of a general
    <QUOTE>operation</QUOTE>
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    called
    
      <span style="color:green"><kbd>apply-generic</kbd>,</span>
      <span style="color:blue"><kbd>apply_generic</kbd>,
      </span>
    
    which applies a generic operation to some arguments.
    
      <span style="color:green"><kbd>Apply-generic</kbd></span>
      <span style="color:blue">
	The function
	<kbd>apply_generic</kbd>
      </span>
    
    looks in the table under the name of the operation and the types of the
    arguments and applies the resulting
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    if one is present:<a class='superscript' id='footnote-link-4' href='#footnote-4'>[4]</a>
    
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_44_3_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (apply-generic op . args)
  (let ((type-tags (map type-tag args)))
    (let ((proc (get op type-tags)))
      (if proc
        (apply proc (map contents args))
        (error
          "No method for these types -- APPLY-GENERIC"
          (list op type-tags))))))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_44_3_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
function apply_generic(op, args) {
    const type_tags = map(type_tag, args);
    const fun = get(op, type_tags);
    return fun !== undefined
        ? apply(fun, map(contents, args))
        : error(list(op, type_tags),
                "No method for these types in apply_generic");
}</pre></div></div></td></tr></table>
    Using
    
      <span style="color:green"><kbd>apply-generic</kbd>,</span>
      <span style="color:blue"><kbd>apply_generic</kbd>,
      </span>
    
    we can define our generic selectors as follows:
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_44_4_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (real-part z) (apply-generic 'real-part z))
          
(define (imag-part z) (apply-generic 'imag-part z))
          
(define (magnitude z) (apply-generic 'magnitude z))
          
(define (angle z) (apply-generic 'angle z))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_44_4_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=4&prgrm=PTAEGUEkGEAVQFLlAJgHQBY0GYBQuRRIA7CAewFcAnAYwFMAaUAWzIGcAXUAMwuJo4BLMsTagAFgEMAbnVCSeggB50AJqGIVmAIzpVQZbvKoBzLXWIc2aAmAAUAFXFze-ISNAAbQZ1A-QHM4GxJ4AnqB0SvQADu7ETBxkAeL+bEncklRoAJS2oE4ufALCpJLR0WEA+oLElXyqemE1JpUAVjKSbDRUgrHynp5kAO5iFGKJeWUV4ZLE4SaCsqSuxR6uAUmSAxGedMwWVgZGgXKZZvuWoHnevmdsTJ1+x87hQ3pybHTRmZIcp6bmSxsXArOLycphOyuB6mNjZUAAb1woBRoCodA41FKENC1Vq9UaoWabQ6XR6sShfBhJjhAG5cABffCgkrg6aVEwWPSCGh2MjRalwxHI1E0ES+DihaJ0SocSQ00AAXhYZTskulsvlguy9NRoDFoi462VnI4fIFASlMrlNJ1IpR6MxVGWfFAAEJFcqCdwamp7XrQAB+NmQ6Eq6J2A1-IHa3IB1EALgiVCoZCodhuZv5CStmttDH98fjACIAHJJfaBMjqbhp5J0T6W6ViGoh3Gc4jcmjFu1MvL8vS-Eqa7S7JjRChcWbqU15bip5j6qSxPSgbCgOyfVakbA4HC5EFFMGdNK8gDWdFCTHRYqoqiFSL1jqxfjYlU0AzsN7T97jRdRwber6qiFvGSZ0AAjhQWx2BeV4SHQkiqHYzhIV+dC3r+2R-v+AEIWh353nCoFFkmJ5kOel4JJIgieOhmFwr2zJHqyzCSBeI67HY8KPqK4pcIMNBbJxcjKpmdjFgAVHKo50JJPa6qiLIeIMZBnhQEZwZUACMTBaSgPEkfq-GgGwFDaDJuxKvIbCnrBl46dRtEZhRwmWXQ2GKfGghGJu5nuUqnqgEBnaqIZuGos+zrBcQDQ+qFXkBgyOyNrxEUGr4hHqMq5GUbiKBOXRZkWZIsmeUZeo+RuWWBV6sV0PFajhRFAZRaQIVqIl-7JXQnipRVRZtQENF0VldotaATLdf6U1KSxHg1J8VBmlpumgPpTDSFsFAecK-4ZVwxUBTltkUfZuJrXKzmCW5pW7OV-5VX5JWybVMVxcBzURZ8HCatdrmeCJBYTbh3yCOm4mreONHphtoBbZ4O3YcDIMTVddE3YD7nYeNRY9X1chpbhB1ohhP7Wbl52VAVw3OUdd0ebjEVPTVnp1R9oVfaiACQ-4-X9RX+QzBa86j-5g+mEtUzTCNIyjYsg+jz3Y+Vosovj-UK-zStZZt20eV1eNGbN6v+sppCqD43wcDQ4h2MwXNPhiL6LmzoDFqp6nRMWA0BsGnsab7epJq7QXFotegcD7CtBn4oiR0HAbgSmab20wxYAKrEGexDDKQA5UEOHgALTF8NskKTN-pDZbbDW7b9J9iTBdF7Ux0qhx7ncfSJOmtZLdxCJEkB97dokxOXDKgPw5d+H8fLZXh5uKyvxyrbeZqrmNpMFGBwPtXzvRVL6rWlqxmWHvTHm02p8mHYqi-FoXNDT4lRSw-mIO77waochH9P77ZOqZ0z-2YOnbQSFhomE5OoUBoBS43zzJXJk19d5Anvo-B2e1IqH1IK-d+mCcL-mDErUBRDSLJmARgz+4DIE2hgaAOBCC0FWGQcxZeHg2BQUyHQOwShn64NAEoUAkkhGN3YduOOnAtiAxvHKYgZhPCZDfpIGgZ55S8K5oQGofxnRbB4PNUQZtDGk2Et8ZadgABePFSZOlIL-KxOpJrGI4XgtiLRzFmmsYiWxL4lbWNpM4vU182IcXnGQZglR0TCUEO4vhTBQg2KGlLJQCSnEmwMa4lUJhiCCExA0Rx2D4xDTYoESoXCLFcOguidCZjMheOwqAAA1IneMVSeF2FifKFRFjrEPVRBk6+swTBcW8UTJ2diVRlN+LMTp7iekNOvIhQGnjHFMyCXNLJoSZThMifM4ZX4HiOxwZMqW+hRGlPEJUMUbA7CSGyNeERUyrlsBqHc-ppt-TaIvlQDI9ANj1lJr4QwgK2ChE4HsFxkibR8OOQ6QRq9VFXJhcWORwyKBKKoMWJg-DEoZInhJaJKz6nYq8D4M0qKMLyMUZkHsSy6nLXWQS8O8zPGkvEpSgQ6LMV0r8Ky+pTLJwSXcbk-JdB2XksJVS7ltKHnZNFRQBogqKXDN2BKzgUquUKIxbKh4Cj7qJWZdsyouyonLOqO40lnLqU6qxfLAM8TQCJKVAAPigfbdiOyFxmpiXE1JTqcaGqFcWY1pr9kKKtWi7VPL7V6kOfIeEio3UwtDd68Nd8qBHI+b46KxZVAiHFeI3Ai05QDDNVqmlVAVFqI0d3CRYIS0yLfmQTF1b1Gcm4kU0A3zdHEH0ebYEwSTEiryYq3hYyc32MQshAJGyURDP1eOpJgj-HpKhWCVNETKjpvjfcnxySYa7rXUOrJRKFmFPGfCyZI6xWFIub8K5Ny7mLrWXi9drIukePqRekiJT5QKoKd4+9ZTXnEGfSMpd6zBnDs9Sa71Z7P2OudZeydoApaXPKRBSp3Can8OaaZHDvDEkPNaQGDDMywPwX4VB-Aeoe16D+XIRIgL0TAueB8cFfxmDvo8DCvDCJUOIvXii6ILbaU4uPaiZlZ62VMA5aJnlcqZMCqDRSz9Cz1UUoU7qvl3TPHKuFf+0dDRNMSW01iuVN6x0GeLKq8VcnJXFnM7yuzNnN2RIQ5a9OzmmBGSQ4m5N8oPVhPg+axD-riNudg2G7pwyrU+b85mhNrr3Xue3bFhRR7s1DTzQW4sRahmqFUNciJFRIhWLWpYgyXa-0ha3Z5oLpHlO9O0vCJppjiW9IMrG5m-KWttd01+rr5UUEmOKiV5gZWlAVaYFVgR17ouhd9Y1sWzWvGtfgR189c2eu4XU6syxG2y77e-XNq+w6MUTamzN0Ac2auCLSzu0jVnAMbfvTk4z47uukbsxVgbv2zviOvpbaQV3djTcO7N6rRNateq3U9sWL3x0bbAEjqx32xYA6O-IF9gPGT1tYot+rYW-VpKKUNU0hm6seZJ-KSN0ro2yv80DmD1P0stAOUlvdaUKcYip3DvZGWTDxbExZo9BWTFrZ-Scl8Uwqgdi7FKhlUcHMar6SzrJJ3elfSGnL9sXIei8hZXpklquGnna2UZ29Yz7S65xByA3PJDMfbFaZ9X+OF0Qel1e2X9uFeG4knZt3I38Ak2YLiMUk3wfvi0LofQyp-RpYa3fbSaAAAMTAsAAFY7S4BJqxjFk8rh6iQsVyP13w9g8iDHnQehdu4Ur+X6Pmha9UFz1rs0BfPAcB1EAA')">function real_part(z) {
   return apply_generic("real_part", list(z));
}
function imag_part(z) {
   return apply_generic("imag_part", list(z));
}
function magnitude(z) {
   return apply_generic("magnitude", list(z));
}
function angle(z) {
   return apply_generic("angle", list(z));
}
</pre></div></div></td></tr></table>
    
    Observe that these do not change at all if a new representation is
    added to the system.
  </p></div>
  <div class='permalink'>
<a name='p11' class='permalink'></a><p>
    We can also extract from the table the constructors to be used by the
    programs external to the packages in making complex numbers from real and
    imaginary parts and from magnitudes and angles. As in
    section&nbsp;<REF NAME="sec:manifest-types"><a class="superscript" id="2.4.3-sec-link-2.4.2" href="./2.4.2.html">2.4.2</a></REF>, we construct rectangular
    numbers whenever we have real and imaginary parts, and polar numbers
    whenever we have magnitudes and angles:
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_44_5_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (make-from-real-imag x y)
  ((get 'make-from-real-imag 'rectangular) x y))

          
(define (make-from-mag-ang r a)
  ((get 'make-from-mag-ang 'polar) r a))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_44_5_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=4&prgrm=PTAEGUEkGEAVQFLlAJgHQBY0GYBQuRRIA7CAewFcAnAYwFMAaUAWzIGcAXUAMwuJo4BLMsTagAFgEMAbnVCSeggB50AJqGIVmAIzpVQZbvKoBzLXWIc2aAmAAUAFXFze-ISNAAbQZ1A-QHM4GxJ4AnqB0SvQADu7ETBxkAeL+bEncklRoAJS2oE4ufALCpJLR0WEA+oLElXyqemE1JpUAVjKSbDRUgrHynp5kAO5iFGKJeWUV4ZLE4SaCsqSuxR6uAUmSAxGedMwWVgZGgXKZZvuWoHnevmdsTJ1+x87hQ3pybHTRmZIcp6bmSxsXArOLycphOyuB6mNjZUAAb1woBRoCodA41FKENC1Vq9UaoWabQ6XR6sShfBhJjhAG5cABffCgkrg6aVEwWPSCGh2MjRalwxHI1E0ES+DihaJ0SocSQ00AAXhYZTskulsvlguy9NRoDFoi462VnI4fIFASlMrlNJ1IpR6MxVGWfFAAEJFcqCdwamp7XrQAB+NmQ6Eq6J2A1-IHa3IB1EALgiVCoZCodhuZv5CStmttDH98fjACIAHJJfaBMjqbhp5J0T6W6ViGoh3Gc4jcmjFu1MkFFMHoraVb5UM0AL3hSNRjqxbY5XJ6vOLQ88I8yHGLTEzdknvf7blZgmY8vXY93U-ts+d847XbsxePp9Hm+3Pgn2X3LI8J5MxEEmINBewozhic5TFUd5Lg+v7-oBdBbl474Xl+A6srMJi7MB04OmBN4Qe2i48g+GG7IhO57vSfaEPyei-CUmraLsTDRBQXCzOopp5NwqbMPqUixHooDYKAdifKspDYDgOC5AeEnyGwaS8gA1nQoRMOiYpUKoQo4bhTqkD4lSaAMdiaWmOlxkWqLBt6vqqIW8ZJnQACOFBbHYqnqRIdCSKodjOH5Zl0Fplmfo5RbBoF-nmdpcIRU5ClKZ5akJJIgieMFoVwvuclgieqmMVhl56gaviDDQw5ykxcjKjuxYAFTVbsDU9rqqLfqQgxkMpFARl5lQAIxMANKAlUWZVcGwFDaM1tVJWQKlqUNaUZRmi1VZINWfu18aCEYYkzXNSqeqAdmdqo43Wfpc7nWou0BgyOyNnp12TWiIUWUqC1LbiKCrZl02zVtuw7Qler7aJsXqJ6XrEA0PoXVd116tepB3aoD3WU9dCeC94NFmjATpZl0N2ijKJMtj-pUx1aEeDUnzngNw2gKNTDSFsFB0MjpXilNR0g-NnTJSzAPrZVa5zWD1mQ4dwM1SdcMI-ZvNFp8HCamtFWbTVBYUyj3yCOmO5i6ARvpuzoCc543OfvrBuO3K2sbVLQufuTRY43jcivdZ73Q99IuLSlf3i0D0ueyjcuB7DZ3w3QiNqGrACQ1ka1rgOC3ruBp4710W3YhdWzbdsO-n+fO1nCug2DeeU89vsE-GGdV1lFkc1zPNY17CW05T-qdaAqg+N8HA0OIdjMGrN03nxcfFt1vXRMWzd6sGS99WviYsEroCPqIeibtv69+IfY4nzveipumzBMMWACqxDKcQwykLRVD0R4AC03-EzVbUab+iJiPNgY8J5UXwO9D+X9ajHWVAVa0Qs7B2neqab6MC4hFToA+TeK9UH83NmxDB0pP5YLmg+RmR9AF5XQhwOUE88xqlzDaJgUYDi6WAXhUghd1RIJMGwkQ0YrCoUPB4PhTDVC-C0MjImRlC5SMxNPZuUVfL+UUTI5uzkUxpjsBou++9tB+WJiYTk6h9GgF-k2fhgCmRD3YUCPR0jp4gVAgZPwbB1zGycUoqy11gxt30X46y2ib4+K0PfIx6gbRmOHs4yxf8HFWFscyempA2BuUyDgpQsjuGgCUKABq+TIG0IZoaLYa5NJymIGYTwmR1w0GUvKHByNCA1D+M6LYPA0nAj1EPVcZ4PyIg+u46KF5aSgH7t0sRhlfyDOwiMucbdJwTKmUPRBlQeJkGYJUAZT4TB2CUEwUIU5Fk3kLkc0AJzVmDzSSqP8AEKBAUnK4+MRMTyBEqBk88GT3LomCsOF8KFQAAGpL56l+Vkuw+z5l7ijpM25Mz5A1Kwi8v2bi5wfPEJUX4sxoVzKBZODSvk1yEplqiNZdyNlbJ2XMjCZkHgzzOTw9K6Z9BFKxZUMUbA7CSGyBpQpKpPlsBqLy8lA9-RtMsHoDI9ANj1g+r4QwCq2ChE4HsRF8kbSHKZUTX4DDsXapXCFaptTMiIRyQ9KZrEzTGsBRuciyFjUCAwhQOpVAezEvtWOeFNrKEEodW+TgD4qmuvdZ6vwAafUPT9cWWCjyGiOuDc601brzX8vuXBJ53d-SxtIghINtrQ01LTR6jN+bfVsRgpIQqNLdkkuqL+RCKaw3mvLgGQ5xz4SKgAHwmKnjWmUda9m-k7Vcj2Maq1xsHZs3ilQ6U1ObcWs1Hr216gZfIbtfbtXUrnQug5VBGXiuZfvVQIgEIlMZnKAY9aXUlvdQ0ppnIUH0lKYZcpN7ohkAfd8RpzSUGvNAFKjpxAumdV6XTJF8b4ILKJmMlZCK+l3PzbBvJyydSIcg-JXd2z52nnpYezdwyiaF0I3ym5SGkUDLJYBjFc95RZuefCDlvxsXct5SinBlEgGUfkjCmj6KT3QezcBFjwrRUoe43qSlUGZ3DobfssdJzaOzxZd4zl3yzSQv+Tk0FoBtM4JOfy8FqJOW4uIHYbyOT4V9j1MBmVkg5WJAVeiJVzwPhqr+MwTVYJtW6YRCe-VjnDXygfF+8NTBLWYZRLG6jgakLJvC+mr1pKNyVttfx+L9UktlqYJl6Nuap3CcTYWsL37kuZoTTmvUebONJttTliNFbJ22pwzskd8pm2NaYAlJTW7+1tfrcORTlyjPperbWvd+HF332671sj-Wd1yamy0AjR74VE2LGezsxYSlDz8qoLl2yKiRF3KzccY1APvOW7hjrBzL5xfPOOQa8IQUfW9ROMaa7o5RonC9vT+XPtgzsXcoGR3mAnaUGdpgF3cnuMG3duwD2G2Ev+3-R7QPvvXUB2d+Ef8cew9Edht14PIfQ9ALDq7eTBv7qRxXYrXH-ssYeTB2HWPrKSf+29yTY0idghHtIUnuwofPZh5d1613Ju4dp5fBnuOgOVdZ19y+nO8fIswlx3ne2qU3fawp0do2rpE1NBNodc67tLpNa2stfXIHrN13h1bNSN18tecbjEpvZ3S+myYLr5WbcLZKe9ZguIxQQ+F8ZLQuh9DKn9Aj-XoXBpoAAAxMCwAAVjtLgAODY3VcFj3qA7QvTsh+L0oSPOg9Ds+sqXsPkOK-R6zzj1zeedRAA')">function make_from_real_imag(x, y) {
   return get("make_from_real_imag", "rectangular")(x, y);
}
function make_from_mag_ang(r, a) {
   return get("make_from_mag_ang", "polar")(r, a);
}
</pre></div></div></td></tr></table>
  </p></div>

  
    <div class="permalink">
    <a name="ex_2.77" class="permalink"></a><EXERCISE><b><a class="exercise-number permalink" id="ex_2.77">Exercise 2.77 </a></b> 
  
    Section&nbsp;<REF NAME="sec:symbolic-differentiation"><a class="superscript" id="2.4.3-sec-link-2.3.2" href="./2.3.2.html">2.3.2</a></REF> described a
    program that performs symbolic differentiation:
    
    
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_44_6_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (deriv exp var)
  (cond ((number? exp) 0)
        ((variable? exp) (if (same-variable? exp var) 1 0))
        ((sum? exp)
          (make-sum (deriv (addend exp) var)
                    (deriv (augend exp) var)))
        ((product? exp)
          (make-sum
            (make-product (multiplier exp)
                          (deriv (multiplicand exp) var))
            (make-product (deriv (multiplier exp) var)
                          (multiplicand exp))))
        ;; more rules can be added here
        (else (error "unknown expression type -- DERIV" exp))))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_44_6_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHQBY0GYBQuAzAVwDsBjAFwEsB7E0KgZwH0A3AQwCcr2AjAGwCmACgAeASlABvXKDmhOgikU70mzRhW4kA5mPEBuXAF98xctToMWjdgFtBbLjwEjWARgA0oVikkz5BSUVNRYObj4hYQ9JADJY2UCk6ycI12i-UHifd1AAXgKfFCNTQlJKWlCNIjt9aUS5RWVVFIAHdipOOuyAC0F2ABM6grzQACIAajGSs3LLejt2AGtHRhrhdi9QdkyA+SaQ0H4mCmFJse9Ny78ZsotK0EWV5lbOGgGiSmE7LbtdhqCzXox00ZwAVBdHr8biZZvcrIMBoISENGP4AQcWn1BsIKB1+MI0YZYXcKgiiDpkaj0YFMfRsUM8VQCUyCUTiaVzGSqq93p9ThJ6rTgi11O1Ot1YqAGcNCmMIbcufNHkR+NRWsdBF00UL9iL6f1GfjCeIOXDuSq1VQNVQyOwUSbdY19dLDbjjayTabFXMHkjuKxhIJRK1vOEXEIaXqgSkSDVeFqgyHxADkqAAPygAAMqeSAC4UuHIiJg60U2nkpnhOpbA5UhGSyGw85i6aM6BcgWcxWkgWa+tS+We0lM09Vut-VRA4iqUmy820pHvLnh8PJ9OKbPBwuG6aVxW+yxeR8voP9z3R8tx7Uxy83ifTnZVerNV1t6Bz6uv+vvs-rcc7Qdd9Py-UD5CLVxTU8ECwPkW9j35YQfyfK0bUTYDYMwzCIKXD8sNglCX1te0hkHPcsJAR4aEUBRVUERhQEA0AE22AYkQGV1FBg3tQC1N43ybbivzGUglhIGgAHd6FLRRGEYB4KAAT1aQRQAAWjU0B1zGM1cB-EFTnlSEDPBSExlEMzFJ07wTPObxzMhDAoPGCzDCAA')">function deriv(exp, variable) {
    return is_number(exp)
           ? 0
           : is_variable(exp)
             ? (is_same_variable(exp, variable)) ? 1 : 0
             : is_sum(exp)
               ? make_sum(deriv(addend(exp), variable), 
                          deriv(augend(exp), variable))
               : is_product(exp)
                 ? make_sum(make_product(multiplier(exp), 
                                deriv(multiplicand(exp), 
                                      variable)),
                            make_product(deriv(multiplier(exp), 
                                               variable), 
                                multiplicand(exp)))
                 // more rules can be added here
                 : error(exp,
                         "unknown expression type -- deriv");
}
</pre></div></div></td></tr></table>
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_44_7_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(deriv '(* (* x y) (+ x 4)) 'x)</pre><pre class='prettyprintoutput'>
(+ (* (* x y) (+ 1 0))
(* (+ (* x 0) (* 1 y))
(+  x 4)))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_44_7_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHQBY0GYBQuAzAVwDsBjAFwEsB7E0KgZwH0A3AQwCcr2AjAGwCmACgAeASlABvXKDmhOgikU70mzRhW4kA5mPEBuXAF98xctToMWjdgFtBbLjwEjWARgA0oVikkz5BSUVNRYObj4hYQ9JADJY2UCk6ycI12i-UHifd1AAXgKfFCNTQlJKWlCNIjt9aUS5RWVVFIAHdipOOuyAC0F2ABM6grzQACIAajGSs3LLejt2AGtHRhrhdi9QdkyA+SaQ0H4mCmFJse9Ny78ZsotK0EWV5lbOGgGiSmE7LbtdhqCzXox00ZwAVBdHr8biZZvcrIMBoISENGP4AQcWn1BsIKB1+MI0YZYXcKgiiDpkaj0YFMfRsUM8VQCUyCUTiaVzGSqq93p9ThJ6rTgi11O1Ot1YqAGcNCmMIbcufNHkR+NRWsdBF00UL9iL6f1GfjCeIOXDuSq1VQNVQyOwUSbdY19dLDbjjayTabFXMHkjuKxhIJRK1vOEXEIaXqgSkSDVeFqgyHxADkqAAPygAAMqeSAC4UuHIiJg60U2nkpnhOpbA5UhGSyGw85i6aM6BcgWcxWkgWa+tS+We0lM09Vut-VRA4iqUmy820pHvLnh8PJ9OKbPBwuG6aVxW+yxeR8voP9z3R8tx7Uxy83ifTnZVerNV1t6Bz6uv+vvs-rcc7Qdd9Py-UD5CLVxTU8ECwPkW9j35YQfyfK0bUTYDYMwzCIKXD8sNglCX1te0hkHPcsJAR4aEUBRVUERhQEA0AE22AYkQGV1FBg3tQC1N43ybbivzGUglhIGgAHd6FLRRGEYB4KAAT1aQRQAAWjU0B1zGM1cB-EFTnlSEDPBSExlEMzFJ07wTPObxzMhDAoPGCzDCAA')">deriv(list("*", list("*", "x", "y"), list("+", "x", 4)), "x");
</pre><pre class='prettyprintoutput'>
list("+", list("*", list("*", x, y), list("+", 1, 0)),
          list("*", list("+", list("*", x, 0), list("*", 1, y)),
                    list("+",  x, 4)))</pre></div></div></td></tr></table>
    We can regard this program as performing a dispatch on the type of the
    expression to be differentiated.  In this situation the
    <QUOTE>type tag</QUOTE> of the datum is the algebraic operator symbol
    (such as +) and the operation being performed is
    <kbd>deriv</kbd>.  We can transform this program into
    data-directed style by rewriting the basic derivative
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    as
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_44_8_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (deriv exp var)
  (cond ((number? exp) 0)
        ((variable? exp) (if (same-variable? exp var) 1 0))
        (else ((get 'deriv (operator exp)) (operands exp)
                                           var))))

(define (operator exp) (car exp))

(define (operands exp) (cdr exp))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_44_8_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
function deriv(exp, variable) {
    return is_number(exp)
           ? 0
           : is_variable(exp)
             ? (is_same_variable(exp, variable) ? 1 : 0)
             : get("deriv", 
                   operator(exp))(operands(exp), variable);
}
function operator(exp) {
   return head(exp);
}
function operands(exp) {
   return tail(exp);
}</pre></div></div></td></tr></table>
    
    <OL type="a">
      <LI>
	Explain what was done above. Why can't we assimilate the
	predicates
	
	  <span style="color:green"><kbd>number?</kbd></span>
	  <span style="color:blue"><kbd>is_number</kbd>
	</span>
	and
	
	  <span style="color:green"><kbd>variable?</kbd></span>
	  <span style="color:blue"><kbd>is_variable</kbd>
	  </span>
	
	into the data-directed dispatch?
      </LI>
      <LI>
	Write the
	
	  <span style="color:green">procedures</span>
	  <span style="color:blue">functions</span>
	
	for derivatives of sums and products, and the auxiliary code required
	to install them in the table used by the program above.
      </LI>
      <LI>
	Choose any additional differentiation rule that you like, such as the
	one for exponents
	(exercise&nbsp;<REF NAME="ex:deriv-exponentiation"><a class="superscript" id="2.4.3-ex-link-2.60" href="./2.3.2.html#ex_2.60">2.60</a></REF>), and install it
	in this data-directed system.
      </LI>
      <LI>
	In this simple algebraic manipulator the type of an expression is the
	algebraic operator that binds it together.  Suppose, however, we
	indexed the
	
	  <span style="color:green">procedures</span>
	  <span style="color:blue">functions</span>
	
	in the opposite way, so that the dispatch line
	in <kbd>deriv</kbd> looked like
	<table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_44_9_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
((get (operator exp) 'deriv) (operands exp) var)</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_44_9_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
get(operator(exp), "deriv")(operands(exp), variable);</pre></div></div></td></tr></table>
	What corresponding changes to the derivative system are required?
      </LI>
    </OL>
    
    
  
      <div class="Solution">
      <div class="solution_btn"><button class="btn btn-secondary solution_btn" href="#solution_44_1_div" data-toggle="collapse">Solution</button></div>
      <div class="solution_content collapse" id="solution_44_1_div"><SOLUTION>
    
      <OL type="a">
        <LI>
          <EM>Explain what was done above.
          Why can't we assimilate the predicates
	  
	    <span style="color:green"><kbd>number?</kbd></span>
	    <span style="color:blue"><kbd>is_number</kbd>
	    </span>
	  
	  and
	  
	    <span style="color:green"><kbd>same-variable?</kbd></span>
	    <span style="color:blue"><kbd>is_same_variable</kbd>
	    </span>
	   into the data-directed dispatch?</EM>
	  <p></p>
	  The operator symbols come very handy as <QUOTE>type</QUOTE> keys in
	  the operator table. For numbers and variables, there aren't such
	  obvious keys, although we could introduce names for those types of
	  expressions, as well, if we change the way expressions are
	  represented as lists.
        </LI>
	<LI>
          <EM>Write the
          
	    <span style="color:green">procedures</span>
	    <span style="color:blue">functions</span>
	  
          for derivatives of sums and products, and the auxiliary code required
	  to install them in the table used by the program above.</EM>
	  <p></p>
	  <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_44_10_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (deriv-sum exp var) 
  (make-sum (deriv (addend exp) var)
            (deriv (augend exp) var)))
 
(define (deriv-product exp var) 
  (make-sum (make-product (multiplier exp)
                          (deriv (multiplicand exp) var))
            (make-product (deriv (multiplier exp) var)
                          (multiplicand exp))))
 
(define (install-deriv)
  (put 'deriv '+ deriv-sum)
  (put 'deriv '* deriv-product)
  'done)</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_44_10_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=4&prgrm=PTAEGUEkGEAVQFLlAJgHQBY0GYBQuAzAVwDsBjAFwEsB7E0KgZwH0A3AQwCcr2AjAGwCmACgAeASlABvXKDmhOgikU70mzRhW4kA5mPEBuXAF98xctToMWjdgFtBbLjwEjWARgA0oVikkz5BSUVNRYObj4hYQ9JADJY2UCk6ycI12i-UHifd1AAXgKfFCNTQlJKWnoAE0FuVmFBUQAHb3CXIX9EuUVlVRSSIjteWobm8S7kuQB+UAAGCcmALhS2yJFGpvHJ5JnhdVsHVPb15tbnNckZ3OXZre3A5Z0lYQAiGrqX7wX7pJom2vYFBonFGm3Ewj+AJIVUYoPEZzSHRKZQslVAkM4gOBcOkXR6IVAAAtBOwqnDkeYKlYMexobCNp15Pi+hR2FR+OSTGZypZ6HZ2ABrRyMQbCdheUDsTIBJnBPr8JgUV4Aak+kolUsMXJ+chRVL5gscTU4NCqREowjsErs0omzPoCs0rwAVGqrd4bVrTDrQHreZKqjVoRD-pi6YzZb16MTSSGoTCvd9kn60ewiE9gzTw7jAvaiSSyaz2XGwwnEz6U1Y7ER+NQmgqRlmEznIwSY2Sm4xyzrK3ya3WFWRaR3Q8Ouy3unLowXhEWOZ3xIncCB0aPecxWa5vE0iBRJdDQE8KMuwAQTXZQGRCewmhRaqBsKBhIxBPqHzgcONe5LGIwaGRhCFABPbxFDIYFmxlSco36GsOTAiCuyTQIZlIGoCCoEhBCqZD5GWQQAEciHYDlgO8dthAohDODLO4dRmKjX0QuifmWdhf3-QDBBA0A52Eaiy2Rb9+SFDc1mECM5HAkhNFAfh-xIsTXHyOTFRdTchFdLVAkpf15JoAUiCaLigOYCVgOYW1tmk2SRV4DTBBU9i-wAiyJT4+Sh34JSOm0yYqAIJ87Ic-JCjQwQMKwqpJPuPNwsi7CjG2YxQEEfgXwne4bL3ASnI41zuMs7w+OCi4-J+AKn1ygo8lAeLMOwmKfTi6EIoaqokp1FK0oyqCfSCGC+IE8r7m9SYxrkCbQF0tFMJfTglTc7wLJQM5+CIQQmvkbLQFK5Tauczilt4tkOU8xSHMXTrkkq58iHstZQtq+qoq25IXwoMTi3O7yHM8XCfSaNkQUdRbColIGqBBFa1o2xd-v6-qPIU36ypGwJuvSxy+usuhZOqn8XJMoqTuLPbfOu+5buqsLWoS6LMrkABIbYPq+jlycEf6WcR7ZIZBfnidWnwSLhhHecRkr7suq7cB5ybUqxxmdTZoamJo2HNsp5LkKmqaZqsKomCBigr0tN6BoJC8atAF59MMpoXgBpIZntoznYeUBrcKF45tqCgnYl0AZj9haPaSfDOBNEE7G8F4AFUSAFEgaAAd3oGl-QAWizk7XBeEaprzI3GBNq8hJ2zPKh8xzapExwHIkowdqPFSq7oGvXjdx2tR2nc91q9uSE732ZP9gujG-d4qFYDRRU7BFjn8JmmbtKcvcNOe7GEaf6lJIMR3jLtF4ucWg9AXexXTQRM1HcMT9cWXTAN6pahn5hjVNc0lQXkXEU2zKeZ65b0tJvT+ZoLTVlrFQesVBGx3wTGfc+8hL5QIHFQIct8j7wnDkHVYj8cHII3qJcB38d5v3qGgmBDYQS4KITqBcSD6GI3wR0JhyCqGwMwYfUsXYn7fjmqyfg3lL4xX7q8XeaoXiqm8LvLeI1xFvAoVI10siKEfxNBAigI08xvDoIIF4yJBEkRERQpu+BL6gxdGqKxLxVG21EFIoCBdvC2JkQ4tU2B4YeK1CuAA2rbGRJ55B+L8XYtUoTwneDCY46JLxnHeAGMIgAuqkr4K4fiRPcX4iUfjZiJLgqk5JBSUlpOCSEsJqjymBCyZ8apSRIn2JiRE-JoAkn8CKeksA2xGkRNyfEtU7TOltMKWUjJkxalxNiaAPx2ASkdLSSMlJoBkkrP+uMuQ7SVmpKAA')">function deriv_sum(operands, variable) {		
    return make_sum(deriv(addend(operands), variable),
                    deriv(augend(operands), variable));
}
function deriv_product(operands, variable) {
    return make_sum(make_product(multiplier(operands),
                        deriv(multiplicand(operands),
                              variable)),
                    make_product(deriv(multiplier(
                                             operands),
                                       variable),
                        multiplicand(operands)));
}
function install_deriv() {
    put("deriv", "+", deriv_sum);
    put("deriv", "*", deriv_product);
    return "done";
}
install_deriv();
</pre></div></div></td></tr></table>
	  
	  
	</LI>
        <LI>
	  <EM>
            Choose any additional differentiation rule that you like, such as
            the one for exponents
	    (exercise&nbsp;<REF NAME="ex:deriv-exponentiation"><a class="superscript" id="2.4.3-ex-link-2.60" href="./2.3.2.html#ex_2.60">2.60</a></REF>), and
	    install it in this data-directed system.
	  </EM>
	  <p></p>
	  
	  
	  <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_44_11_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (deriv-exponentiation expr var)
  (let ((base (base expr))
        (exponent (exponent expr)))
    (make-product exponent
                  (make-product (make-exponentiation base (make-sum exponent -1))
                                (deriv base var)))))
 
(define (install-exponentiation-extension)
  (put 'deriv '** deriv-exponentiation)
  'done)</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_44_11_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=4&prgrm=PTAEGUEkGEAVQFLlAJgHQBY0GYBQuAzAVwDsBjAFwEsB7E0KgZwH0A3AQwCcr2AjAGwCmACgAeASlABvXKDmhOgikU70mzRhW4kA5mPEBuXAF98xctToMWjdgFtBbLjwEjWARgA0oVikkz5BSUVNRYObj4hYQ9JADJY2UCk6ycI12i-UHifd1AAXgKfFCNTQlJKWnoAE0FuVmFBUQAHb3CXIX9EuUVlVRSSIjteWobm8S7kuQB+UAAGCcmALhS2yJFGpvHJ5JnhdVsHVPb15tbnNckZ3OXZre3A5Z0lYQAiGrqX7wX7pJom2vYFBonFGm3Ewj+AJIVUYoPEZzSHRKZQslVAkM4gOBcOkXR6IVAAAtBOwqnDkeYKlYMexobCNp15Pi+hR2FR+OSTGZypZ6HZ2ABrRyMQbCdheUDsTIBJnBPr8JgUV4Aak+kolUsMXJ+chRVL5gscTU4NCqREowjsErs0omzPoCs0rwAVGqrd4bVrTDrQHreZKqjVoRD-pi6YzZb16MTSSGoTCvd9kn60ewiE9gzTw7jAvaiSSyaz2XGwwnEz6U1Y7ER+NQmgqRlmEznIwSY2Sm4xyzrK3ya3WFWRaR3Q8Ouy3unLowXhEWOZ3xIne6B+ULmBs6IISNRAZVhLx2IxBN4GROglHQI6lS9na7vAejyexhSeWiHyIF2e8+2S2PE5T-Q3EgtyVT8ZUnC8fznX9wyXEB0VHXlmFZVxvCaIgKElaFQCeChcHgggTTsUAyEJdgmgoWpQGwUBhCPfVqJwHBxmXQ9GBoMhhCFABPbxFDIYFm3A88CXUAZ+A5fjBK7JNAhmUgagIKhgKqWT5GWQQAEciHYDkeO8H8fykzgyzuHUZiMwQBJMmSfVAZY2I4rjBF40BoOMstkWXVdHBQqIIzkASSE0S8ON05C1nyS9FRdPzBFdLVAgAtF+BoGgBSIJpnO45gJR45hbW2IKQpFXg4qixzOPyiVoNSod+Ai1xFyMbYqAIWjSvKgo8lABTBCUlSAvuPM+oGwQqhayZjFAQR+CPM8iroEKPIqxh2KqlyCu8aDOouRKdTa2iVu63roX65TxqGn0RrOsaJrU+Rptm+bhOuqc3LZSSrME-afm9KaJn+uRkqsZSj04JVqu8fKUDOfgiEEK75GKzDdtcVb1uy3Lts+4Q6vCuLmtkw66KIMrIpO0aLqqJHkiPCgIuLfGGrizwHp1Jo2RBK8sYlTmqBBGG4YRxc2bsuzarClm9t+pInrmwQFsmFGgmsqoMacoWPuLNGOll1r2uEY7CipwalYASG2enGY5XXj1wS3xe2fmQRdrHYZ8XSRbFp3xZ2snCaJx25Hll72aSa33O+kzhcRya-tkoHQCTkHqiYTmKFIy1aZEvpiJOl5UvSzKXnD+QZiLjKmjLuRlnzwoXjB2oKFL33QBmJuIZr9SZs4E0QTsbwXgAVRIAUSBoAB3egaX9ABaOePtcF5ZaTvMqnTwFSK8lXZ8qRqhCinyD5ELUVdwqK97oE-Xkrkuz6WzD0Mwnqr5IG-G+C5uV6MZd3ioVg65mibm3DwXkMEYQImOP4c25sJgqwfFFd8ECuzxxIo-GazQopARAig2WeZj7GlNOaJUGwfZ2UISaM0Fpj44NAbuOg+5DwekNBoUUZDQBz3cKLB2bd5D-3qA+KBMsXyolBsFVkEkgFNBATuJCjRKLBT3ENZ+rwBFqhvHeUAAjpGyLAZUfB703ibheMiMGkiGp0LkfvBRW5GDKN-gIvGMVNEaNEGqDA8JQAvHcYYIAA')">function deriv_exponentiation(operands, variable) {		
    const bas = base(operands);
    const exp = exponent(operands);
    return make_product(exp,
               make_product(make_exponentiation(bas, make_sum(exp, -1)),
	                    deriv(bas, variable)));
}
function install_exponentiation_extension() {
    put("deriv", "**", deriv_exponentiation);
    return "done";
}
install_exponentiation_extension();
</pre></div></div></td></tr></table>

        </LI>
        <LI>
	  <EM>
            In this simple algebraic manipulator the type of an expression is
            the algebraic operator that binds it together.  Suppose, however,
	    we indexed the
            
	      <span style="color:green">procedures</span>
	      <span style="color:blue">functions</span>
	    
            in the opposite way, so that the dispatch line in
	    <kbd>deriv</kbd> looked like
            <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_44_12_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
((get (operator exp) 'deriv) (operands exp) var)</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_44_12_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
get(operator(exp), "deriv")(operands(exp), variable);</pre></div></div></td></tr></table>
            What corresponding changes to the derivative system are required?
	  </EM>
	  <p></p>
	  We would need to change the order of arguments in the installation
	  procedure for the differentiation library:
	  <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_44_13_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(put '+ 'deriv deriv-sum )
(put '* 'deriv deriv-product)	    
(put '** 'deriv deriv-exponentiation)</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_44_13_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
put("+", "deriv", deriv_sum);
put("*", "deriv", deriv_product);
put("**", "deriv", deriv_exponentiation);</pre></div></div></td></tr></table>
        </LI>
      </OL>
    </SOLUTION></div></div>
</EXERCISE></div>

  
    <div class="permalink">
    <a name="ex_2.78" class="permalink"></a><EXERCISE><b><a class="exercise-number permalink" id="ex_2.78">Exercise 2.78 </a></b> 
  
    
    
    Insatiable Enterprises, Inc., is a highly decentralized conglomerate company
    consisting of a large number of independent divisions located all over the
    world.  The company's computer facilities have just been
    interconnected by means of a clever network-interfacing scheme that makes
    the entire network appear to any user to be a single computer.
    Insatiable's president,  in her first attempt to exploit the ability
    of the network to extract administrative information from division files,
    is dismayed to discover that, although all the division files have been
    implemented as data structures in
    
      <span style="color:green">
	Scheme,
      </span>
      <span style="color:blue">
	JavaScript,
      </span>
    
    the particular data structure used varies from division to division.  A
    meeting of division managers is hastily called to search for a strategy to
    integrate the files that will satisfy headquarters' needs while
    preserving the existing autonomy of the divisions.
    <p></p>
    Show how such a strategy can be implemented with data-directed programming.
    As an example, suppose that each division's personnel records consist
    of a single file, which contains a set of records keyed on
    employees' names.  The structure of the set varies from division to
    division.  Furthermore, each employee's record is itself a set
    (structured differently from division to division) that contains
    information keyed under identifiers such as
    <kbd>address</kbd> and
    <kbd>salary</kbd>.  In particular:
    <OL type="a">
      <LI>
        Implement for headquarters a
	
	  <span style="color:green"><kbd>get-record</kbd></span>
	  <span style="color:blue"><kbd>get_record</kbd>
	</span>
        
	  <span style="color:green">procedure</span>
	  <span style="color:blue">function</span>
	
        that retrieves a specified employee's record from a specified
	personnel file.  The
        
	  <span style="color:green">procedure</span>
	  <span style="color:blue">function</span>
	
        should be applicable to any division's file. Explain how the
	individual divisions' files should be structured.  In particular,
	what type information must be supplied?
      </LI>
      <LI>
        Implement for headquarters a
	
	  <span style="color:green"><kbd>get-salary</kbd></span>
	  <span style="color:blue"><kbd>get_salary</kbd>
	</span>
        
	  <span style="color:green">procedure</span>
	  <span style="color:blue">function</span>
	
        that returns the salary information from a given employee's
	record from any division's personnel file.  How should the record
	be structured in order to make this operation work?
      </LI>
      <LI>
        Implement for headquarters a
	
	  <span style="color:green"><kbd>find-employee-record</kbd></span>
	  <span style="color:blue"><kbd>find_employee_record</kbd>
	  </span>
	
        
	  <span style="color:green">procedure.</span>
	  <span style="color:blue">function.</span>
	
        This should search all the divisions' files for the record of a
	given employee and return the record.  Assume that this
        
	  <span style="color:green">procedure</span>
	  <span style="color:blue">function</span>
	
        takes as arguments an employee's name and a list of all the
	divisions' files.
      </LI>
      <LI>
        When Insatiable takes over a new company, what changes must be made in
	order to incorporate the new personnel information into the central
	system?
      </LI>
    </OL>
    
  
      <div class="Solution">
      <div class="solution_btn"><button class="btn btn-secondary solution_btn" href="#solution_44_2_div" data-toggle="collapse">Solution</button></div>
      <div class="solution_content collapse" id="solution_44_2_div"><SOLUTION>
    
      <OL type="a">
        <LI>
          <EM>Implement for headquarters a
	  
	    <span style="color:green"><kbd>get-record</kbd></span>
	    <span style="color:blue"><kbd>get_record</kbd>
	    </span>
	  
          
	    <span style="color:green">procedure</span>
	    <span style="color:blue">function</span>
	  
          that retrieves a specified employee's record from a specified
	  personnel file.  The
          
	    <span style="color:green">procedure</span>
	    <span style="color:blue">function</span>
	  
          should be applicable to any division's file. Explain how the
	  individual divisions' files should be structured.  In
          particular, what type information must be supplied?</EM>
	  <p></p>
	  We are tagging each division's file with a unique identifier for the
	  division, using the tagging functions in
	  section&nbsp;<REF NAME="sec:manifest-types"><a class="superscript" id="2.4.3-sec-link-2.4.2" href="./2.4.2.html">2.4.2</a></REF>. We assume that each
	  division provides an implementation of the
	  <kbd>get_record</kbd> function and installs
	  it in the company-wide operations table.
	  <div class='snippet' id='javascript_44_14_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
function make_insatiable_file(division, file) {
    return pair(division, file);
}
function insatiable_file_division(insatiable_file) {
    return head(insatiable_file);
}
function insatiable_file_content(insatiable_file) {
    return tail(insatiable_file);
}
function get_record(employee_name, insatiable_file) {
    const the_division 
        = insatiable_file_division(insatiable_file);
    const division_record = get("get_record", the_division)
                            (employee_name, 
                             insatiable_file_content(
                                 insatiable_file);
    return record !== undefined      
           ? attach_tag(the_division, division_record)
           : undefined;
}</pre></div></div>
        </LI>
        <LI>
          <EM>Implement for headquarters a
	  
	    <span style="color:green"><kbd>get-salary</kbd></span>
	    <span style="color:blue"><kbd>get_salary</kbd>
	    </span>
	  
          
	    <span style="color:green">procedure</span>
	    <span style="color:blue">function</span>
	  
          that returns the salary information from a given employee's
	  record from any division's personnel file.  How should the
	  record be structured in order to make this operation work?</EM>
	  <p></p>
	  Every division needs to implement functions such as
	  <kbd>get_salary</kbd> and install them
	  in Insatiable's operations table. Then, Insatiable's function
	  <kbd>get_salary</kbd> can look like this:
	  <div class='snippet' id='javascript_44_15_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
function make_insatiable_record(division, record) {
    return pair(division, record);
}
function insatiable_record_division(insatiable_record) {
    return head(insatiable_record);
}
function insatiable_record_content(insatiable_record) {
    return tail(insatiable_record);
}
function get_salary(insatiable_record) {
    const the_division = 
        insatiable_record_division(insatiable_record);
    return get("get_salary", the_division)
           (insatiable_record_content);
}</pre></div></div>
	  Note that we rely on the fact that any employee record that gets
	  returned by <kbd>get_record</kbd> is tagged
	  with its division, which is used in the generic function
	  <kbd>get_salary</kbd> to retrieve the
	  correct implementation from the operation table.
        </LI>
        <LI>
          <EM>
	    Implement for headquarters a
	    
	      <span style="color:green"><kbd>find-employee-record</kbd>
	    </span><span style="color:blue"><kbd>find_employee_record</kbd></span>
            
	      <span style="color:green">procedure.</span>
	      <span style="color:blue">function.</span>
	    
            This should search all the divisions' files for the record of
	    a given employee and return the record.  Assume that this
            <span style="color:green">procedure</span>
	    <span style="color:blue">function</span>
	    
            takes as arguments an employee's name and a list of all the
	    divisions' files.
	  </EM>
	  <div class='snippet' id='javascript_44_16_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
function find_employee_record(employee_name, 
                              personnel_files) {
    if (is_null(personell_files)) {
        return undefined;
    } else {
        const insatiable_record 
            = get_record(employee_name,
                         head(personell_files));
        return insatiable_record !== undefined
               ? insatiable_record
               : find_employee_record(employee_name, 
                              tail(personell_files));
    }
}</pre></div></div>
        </LI>
        <LI>
          <EM>
	    When Insatiable takes over a new company, what changes must be made
	    in order to incorporate the new personnel information into the
            central
	    system?
	  </EM>
	  <p></p>
	  We would need to do the following, for each newly acquired company:
	  <UL>
	    <LI>
	      Decide a name to be used as tag for any data item related
	      to the new division.
	    </LI>
	    <LI>
	      Write all division-specific functions such as
	      <kbd>get_salary</kbd>
	      and install them in the company-wide operations table using the
	      division tag.
	    </LI>
	    <LI>
	      Add the employee files to the list of
	      <kbd>personell_files</kbd>.
	      Note that this is a <QUOTE>destructive</QUOTE>
	      operation—similar to the extension of operations
	      tables—in that the data structure is permanently  and
	      irrevocably modified;
	      section&nbsp;<REF NAME="sec:mutable-data"><a class="superscript" id="2.4.3-sec-link-3.3" href="./3.3.html">3.3</a></REF> explains this
	      concept in detail.
	    </LI>
	  </UL>
        </LI>
      </OL>
    </SOLUTION></div></div>
</EXERCISE></div>

  
  

  
      <div class='permalink'>
        <a name='h1' class='permalink'></a><h2>
    
    Message passing
  </h2></div>

  

  <div class='permalink'>
<a name='p12' class='permalink'></a><p>
    The key idea of data-directed programming is to handle generic operations
    in programs by dealing explicitly with operation-and-type tables, such as
    the table in
    
      <span style="color:green">
	figure&nbsp;<REF NAME="fig:operator-table_scheme"><a class="superscript" id="2.4.3-fig-link-2.31" href="./2.4.3.html#fig_2.31">2.31</a></REF>.
      </span>
      <span style="color:blue">
	figure&nbsp;<REF NAME="fig:operator-table"><a class="superscript" id="2.4.3-fig-link-2.32" href="./2.4.3.html#fig_2.32">2.32</a></REF>.
      </span>
    
    The style of programming we used in
    section&nbsp;<REF NAME="sec:manifest-types"><a class="superscript" id="2.4.3-sec-link-2.4.2" href="./2.4.2.html">2.4.2</a></REF> organized the required
    dispatching on type by having each operation take care of its own
    dispatching.  In effect, this decomposes the operation-and-type table into
    rows, with each generic operation
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    representing a row of the table.
  </p></div>
  <div class='permalink'>
<a name='p13' class='permalink'></a><p>
    An alternative implementation strategy is to decompose the table into
    columns and, instead of using <QUOTE>intelligent operations</QUOTE> that
    dispatch on data types, to work with <QUOTE>intelligent data
    objects</QUOTE> that dispatch on operation names.  We can do this by
    arranging things so that a data object, such as a rectangular number, is
    represented as a
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    that takes as input the required operation name and performs the operation
    indicated.  In such a discipline,
    
      <span style="color:green"><kbd>make-from-real-imag</kbd></span>
      <span style="color:blue"><kbd>make_from_real_imag</kbd>
      </span>
    
    could be written as
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_44_17_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (make-from-real-imag x y)
  (define (dispatch op)
    (cond ((eq? op 'real-part) x)
          ((eq? op 'imag-part) y)
          ((eq? op 'magnitude)
            (sqrt (+ (square x) (square y))))
          ((eq? op 'angle) (atan y x))
          (else
            (error "Unknown op -- MAKE-FROM-REAL-IMAG" op))))
  dispatch)</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_44_17_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=3&prgrm=PTAEGUEkGEAVQFLlAJgHQBY0GYBQuAzAVwDsBjAFwEsB7E0AZwEciBDAJwFMAKADwEpQAb1ygxoLhSLt6vUACpQvANy4AvvmLlqdUAFtWAa04B9Auxp6TXVgBsTVAwHM+AGlABPQSPGgtlWnoAEyoGAAdWCjIAC24aMO9RX3FJaXp40ABebNAAIht7CPYKXKTk5IB+JTLy8QAuUAzszLzHVicTIpKa2vEqjx7e0AamnNznEiopIM5Sodqqgwpok2Zi7mY2Lj5BAGpGFg4eL35B+ZGwrLHWEidbWbP50EXIlcib7g93AUfz0E52BZ2HEwq5fk9yrkAKokQwkGgAd3SlwAtCj9EZTOZLNZOHYHM5cvxVL4NL5UjJQCFwpEYqoyeJCKQAroDMYzBYrM4TDcXOx3KxEr5-DpgqEIlFYvEhbUKciri18njChxuhCquwFBjliYyDQGNxBeCxBcFa1uV05hDnhItUsVgwqCRDadrcNGpdmnkJlMiDMrW6NcbkqavblefcA26baxg+UGgCgSCwdGntDYfCkR7QGiMezsVYCgT2kSSeIGWI5VTxbTovSakztIFQKwwmFbB4TE5OCQAVQyMmW+wnDLK5wpJTonigobh-wQcT1I2WfQi11uAAvUdV1vtzvd3vsfvcJX4y3uWyhCib-iLjQi5ttDrrrfCMo7tsdrs9vsD3JPzpVVyC8rxvO9l1FDEnEmaYeFfHwxwnehdy-A9fxPH1YOA0BLwYa8t3Ah9dAjODt3HNIW0-fcfyPP8SOw3D8NvesiOQoIgl1Sx204XhNwARncDcUFHCRyMpNksU5XF8Sfbg4zHM9VX4vZRMU9YhP4FM3QAl8+JUnSlI0wjmUghgiAAI04vRuN4jcBNADS33JMT6AkjkcSLWT5NUlV1L0nMfMA9ThK060DL8wR0XC-DhOMptWSIew9Ws+5bPsxyEMQii3ILExuV5OTo0wv04P8xRipmTcQu8kjlNAfZaqMliTObEIADcrJs-jBOEpyUhcvNJJxfLbkKt0KtKwQwAmqrNJq257jq9FGti+sQA9AFIkCEwKFYcz7ncMIiAoFsSCCUBuwoXB1oLUAYlbCgAVAbBQA2TgV2enAcFOViWwYBgaAHYwvlEvV2CCBgRKrUITBIRLbG4LgwYh115iqUgZgIJ1OCCY0E0OBHgfcKdWBnEmZyRmhwch284yqcnEfeqmUbjBpWH+wHuCJ0BdqoBHKep5il1+tzdv2ngRL1Eg8JwwH8TF+4shw0DcnkBXOHkUsal+2waBoQwiDCLnOE7ezgZMXrMuSKWZbM8z1aV9mAaBk2THs3mEd1sh5b2+4hd6KgCFeu2Ha9DHOCx3sghE3oq3DyOcbLco1H+WwGE4Pr5htk6BfOlonc582UHcD2Ngs9X-aeQPXtzs14+x6PM+tOOzojhuk6GFPODTjOrYhKtS9zxcIQrZJR9H36nXT9ZzbN13i9ANq7CITgY-EbPGHL32M-zjmXdNkvWD57gvZ98XK-Kauy-t7e69bhPG772p04oHaj89uX7HV0LUzECIqGBIxY2B9QD-2BEXdwS9bAr1vD-X+yRS6ny-tvW8w9ahdx7k3XoG9a672dsAi2h9j4hxQWg+YV9cE5HrlHNeABIXoL837EK3uLME9D4G+DAdwLhEDF7L1XnAjh5RS4kPPkLdhYgMHpywU8Rhg8mbg0gfwshndHjj21i1XQ1IJQxG4HoNeWVxJmlyLrfWhsoxPCqKYg2YRvIND0MYqeAI1SpiqE44o3kTR5GoTjDa7Atq6FzOrXIHdR5Vm0bWesG94ibVFG-cWStRbb24IuDel0lYxP8XE9WJ5rHmNSXQGWR0TotEyQEkg8TFr-mls4rWv1Ii7RiG-FwFAPBhFMLtJw7gpaPRIBQSGTcqxcNae05p3S6C9P6XFD6IyOntG4EESIRB9GDIGjDLhiypD6ONPTacCylnbKeAmQEVN9lbPcLkcypMebtG7OdTZyyczolmc0rW95NH0B6T2fpZzllQzWQwQCADfmHLRjc4+DzQVDGOUmSFFyrnnU6XcqkBynl3Qmd8hgbyIKPmlrtWw9gka7VuIlDggEyCGHaBLJuv01yGW8KJJCoAGZbmUKACeHzQDRRvMIRlFFS6svZRo+KrlMTuULMqYsLheDuC8LyoZR9gQys8MSIVwpOUzXgo8Ks9pVhMHWJsI4jM1JMT2J48QhrtjcoIiojlIrTp3FIjIwxoqdTvGdNazSgUXwXzVeIEWYrcojT5AKAxfLKRcM1OVV4nEDSCncFG7UDonQultTUdaTpHrsAIKwMgGcKA0B5lOUSMsaBB2WBnBgHg8KcD0MKmZ8yBDOvDchCgjSVidJPES3kpL2DYQEKEmoxSu2SvPMrPCI7KA9tsBwIkCbR2qhUcO-8FogIgQnUqKdJKZ19q9dFJdx0MLtBgiVBiKtu3btnV6iaB7rzhgWrMddd6L1OF7XOh1fsO7LpylJTyhILkvrfYIsQbgVVZAAHw3JcD+jykrZLKpOLeo9+YpLBuwpu4lr6d3AUeIjUNEGoN6MDah9oPJRr8hbKgjuVZchBDoLMesuAp74sJe9TDvbyWUu7Ck1Qk88V2EKDQHdnGqUpKbhmvpAISB2D8B8hg9bIKaoZVWFlqq7UfUaspgaAq1MKebDBrkpGCoUcFPKgakbQ1svU5BOl6kDE6uPb6Sqr5o06j1HGh9YFB3qvtZ651DnoJOada55NzpNNpp8x9Az0l7DwdlfZ8ziqiM6jWNeS1PAm37HS58WB5qxC6vdZ8b4vqNDprAJmgEOa8080LRWktJ0y1FsrdWx6dbIuQU7U2oQLaWxttzR2+ZuQwhCdncVqzQ7D2nl8iUJ9J5hvYa9bZigSGV2kbHUAobI3d3uH3V+ybE0z0bvm1e9wN69t3vorNzbC2BQPpW9Fv9JYLnHb7e4XDCHBCZEg52h7cHnCgcQ+d5DQ1DMdF5Ohl7OHeh4cowRn7xHhpGfI6G31NG6O9hCUuJj-GCWdC2yJ7ji5cAbz0J2ZKNlYbLPMk9FoNRfsyX+3xNAAAGdwWAACsROcGcDMrYEpoAaikw4uT1KeiydcVSpTvQ1P+SeNJ51SXcNpcAiJ9yrgvPlvKCAA')">function make_from_real_imag(x, y) {
    function dispatch(op) {
        return op === "real_part"
            ? x
            : op === "imag_part"
              ? y
              : op === "magnitude"
                ? math_sqrt(square(x) + square(y))
                : op === "angle"
                  ? math_atan(y, x)
                  : error(op,
                          "Unknown op -- make_from_real_imag");
    }
    return dispatch;
}
</pre></div></div></td></tr></table>
    The corresponding
    
      <span style="color:green"><kbd>apply-generic</kbd></span>
      <span style="color:blue"><kbd>apply_generic</kbd>
      </span>
    
    
      <span style="color:green">procedure,</span>
      <span style="color:blue">function,</span>
    
    which applies a generic operation to an argument, now simply feeds the
    operation's name to the data object and lets the object do the
    work:<a class='superscript' id='footnote-link-5' href='#footnote-5'>[5]</a>
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_44_18_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (apply-generic op arg) (arg op))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_44_18_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=3&prgrm=PTAEGUEkGEAVQFLlAJgHQBY0GYBQuAzAVwDsBjAFwEsB7E0AZwEciBDAJwFMAKADwEpQAb1ygxoLhSLt6vUACpQvANy4AvvmLlqdUAFtWAa04B9Auxp6TXVgBsTVAwHM+AGlABPQSPGgtlWnoAEyoGAAdWCjIAC24aMO9RX3FJaXp40ABebNAAIht7CPYKXKTk5IB+JTLy8QAuUAzszLzHVicTIpKa2vEqjx7e0AamnNznEiopIM5Sodqqgwpok2Zi7mY2Lj5BAGpGFg4eL35B+ZGwrLHWEidbWbP50EXIlcib7g93AUfz0E52BZ2HEwq5fk9yrkAKokQwkGgAd3SlwAtCj9EZTOZLNZOHYHM5cvxVL4NL5UjJQCFwpEYqoyeJCKQAroDMYzBYrM4TDcXOx3KxEr5-DpgqEIlFYvEhbUKciri18njChxuhCquwFBjliYyDQGNxBeCxBcFa1uV05hDnhItUsVgwqCRDadrcNGpdmnkJlMiDMrW6NcbkqavblefcA26baxg+UGgCgSCwdGntDYfCkR7QGiMezsVYCgT2kSSeIGWI5VTxbTovSakztIFQKwwmFbB4TE5OCQAVQyMmW+wnDLK5wpJTonigobh-wQcT1I2WfQi11uAAvUdV1vtzvd3vsfvcJX4y3uWyhCib-iLjQi5ttDrrrfCMo7tsdrs9vsD3JPzpVVyC8rxvO9l1FDEnEmaYeFfHwxwnehdy-A9fxPH1YOA0BLwYa8t3Ah9dAjODt3HNIW0-fcfyPP8SOw3D8NvesiOQoIgl1Sx204XhNwARncDcUFHCRyMpNksU5XF8Sfbg4zHM9VX4vZRMU9YhP4FM3QAl8+JUnSlI0wjmUghgiAAI04vRuN4jcBNADS33JMT6AkjkcSLWT5NUlV1L0nMfMA9ThK060DL8wR0XC-DhOMptWSIew9Ws+5bPsxyEMQii3ILExuV5OTo0wv04P8xRipmTcQu8kjlNAfZaqMliTObEIADcrJs-jBOEpyUhcvNJJxfLbkKt0KtKwQwAmqrNJq257jq9FGti+sQA9AFIkCEwKFYcz7ncMIiAoFsSCCUBuwoXB1oLUAYlbCgAVAbBQA2TgV2enAcFOViWwYBgaAHYwvlEvV2CCBgRKrUITBIRLbG4LgwYh115iqUgZgIJ1OCCY0E0OBHgfcKdWBnEmZyRmhwch284yqcnEfeqmUbjBpWH+wHuCJ0BdqoBHKep5il1+tzdv2ngRL1Eg8JwwH8TF+4shw0DcnkBXOHkUsal+2waBoQwiDCLnOE7ezgZMXrMuSKWZbM8z1aV9mAaBk2THs3mEd1sh5b2+4hd6KgCFeu2Ha9DHOCx3sghE3oq3DyOcbLco1H+WwGE4Pr5htk6BfOlonc582UHcD2Ngs9X-aeQPXtzs14+x6PM+tOOzojhuk6GFPODTjOrYhKtS9zxcIQrZJR9H36nXT9ZzbN13i9ANq7CITgY-EbPGHL32M-zjmXdNkvWD57gvZ98XK-Kauy-t7e69bhPG772p04oHaj89uX7HV0LUzECIqGBIxY2B9QD-2BEXdwS9bAr1vD-X+yRS6ny-tvW8w9ahdx7k3XoG9a672dsAi2h9j4hxQWg+YV9cE5HrlHNeABIXoL837EK3uLME9D4G+DAdwLhEDF7L1XnAjh5RS4kPPkLdhYgMHpywU8Rhg8mbg0gfwshndHjj21i1XQ1IJQxG4HoNeWVxJmlyLrfWhsoxPCqKYg2YRvIND0MYqeAI1SpiqE44o3kTR5GoTjDa7Atq6FzOrXIHdR5Vm0bWesG94ibVFG-cWStRbb24IuDel0lYxP8XE9WJ5rHmNSXQGWR0TotEyQEkg8TFr-mls4rWv1Ii7RiG-FwFAPBhFMLtJw7gpaPRIBQSGTcqxcNae05p3S6C9P6XFD6IyOntG4EESIRB9GDIGjDLhiypD6ONPTacCylnbKeAmQEVN9lbPcLkcypMebtG7OdTZyyczolmc0rW95NH0B6T2fpZzllQzWQwQCADfmHLRjc4+DzQVDGOUmSFFyrnnU6XcqkBynl3Qmd8hgbyIKPmlrtWw9gka7VuIlDggEyCGHaBLJuv01yGW8KJJCoAGZbmUKACeHzQDRRvMIRlFFS6svZRo+KrlMTuULMqYsLheDuC8LyoZR9gQys8MSIVwpOUzXgo8Ks9pVhMHWJsI4jM1JMT2J48QhrtjcoIiojlIrTp3FIjIwxoqdTvGdNazSgUXwXzVeIEWYrcojT5AKAxfLKRcM1OVV4nEDSCncFG7UDonQultTUdaTpHrsAIKwMgGcKA0B5lOUSMsaBB2WBnBgHg8KcD0MKmZ8yBDOvDchCgjSVidJPES3kpL2DYQEKEmoxSu2SvPMrPCI7KA9tsBwIkCbR2qhUcO-8FogIgQnUqKdJKZ19q9dFJdx0MLtBgiVBiKtu3btnV6iaB7rzhgWrMddd6L1OF7XOh1fsO7LpylJTyhILkvrfYIsQbgVVZAAHw3JcD+jykrZLKpOLeo9+YpLBuwpu4lr6d3AUeIjUNEGoN6MDah9oPJRr8hbKgjuVZchBDoLMesuAp74sJe9TDvbyWUu7Ck1Qk88V2EKDQHdnGqUpKbhmvpAISB2D8B8hg9bIKaoZVWFlqq7UfUaspgaAq1MKebDBrkpGCoUcFPKgakbQ1svU5BOl6kDE6uPb6Sqr5o06j1HGh9YFB3qvtZ651DnoJOada55NzpNNpp8x9Az0l7DwdlfZ8ziqiM6jWNeS1PAm37HS58WB5qxC6vdZ8b4vqNDprAJmgEOa8080LRWktJ0y1FsrdWx6dbIuQU7U2oQLaWxttzR2+ZuQwhCdncVqzQ7D2nl8iUJ9J5hvYa9bZigSGV2kbHUAobI3d3uH3V+ybE0z0bvm1e9wN69t3vorNzbC2BQPpW9Fv9JYLnHb7e4XDCHBCZEg52h7cHnCgcQ+d5DQ1DMdF5Ohl7OHeh4cowRn7xHhpGfI6G31NG6O9hCUuJj-GCWdC2yJ7ji58C4A3noTsyUbKw2WeZJ6LQai-Zkv9viaAAAM7gsAAFYic4M4GZWwJTQA1FJhxCnqU9Hk64qlKnegaf8k8WTzqUu4Yy4BET7lXA+fLeUEAA')">function apply_generic(op, arg) {
    return head(arg)(op);
}
</pre></div></div></td></tr></table>
    
    
    Note that the value returned by
    
      <span style="color:green"><kbd>make-from-real-imag</kbd></span>
      <span style="color:blue"><kbd>make_from_real_imag</kbd>
      </span>
    
    is a
    
      <span style="color:green">procedure—the internal</span>
      <span style="color:blue">function—the internal</span>
    
    <kbd>dispatch</kbd>
    
      <span style="color:green">procedure.</span>
      <span style="color:blue">function.</span>
    
    This is the
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    that is invoked when
    
      <span style="color:green"><kbd>apply-generic</kbd></span>
      <span style="color:blue"><kbd>apply_generic</kbd>
      </span>
    
    requests an operation to be performed.
  </p></div>
  <div class='permalink'>
<a name='p14' class='permalink'></a><p>
    This style of programming is called <EM>message passing</EM>.  The name
    comes from the image that a data object is an entity that receives the
    requested operation name as a <QUOTE>message.</QUOTE>  We have already seen
    an example of message passing in section&nbsp;<REF NAME="sec:data?"><a class="superscript" id="2.4.3-sec-link-2.1.3" href="./2.1.3.html">2.1.3</a></REF>,
    where we saw how
    
      <span style="color:green"><kbd>cons</kbd>,</span>
      <span style="color:blue"><kbd>pair</kbd>,</span>
    
    
      <span style="color:green"><kbd>car</kbd>,</span>
      <span style="color:blue"><kbd>head</kbd>,</span>
    
    and
    
      <span style="color:green"><kbd>cdr</kbd></span>
      <span style="color:blue"><kbd>tail</kbd></span>
    
    could be defined with no data objects but only
    
      <span style="color:green">procedures.</span>
      <span style="color:blue">functions.</span>
    
    Here we see that message passing is not a mathematical trick but a useful
    technique for organizing systems with generic operations.  In the remainder
    of this chapter we will continue to use data-directed programming, rather
    than message passing, to discuss generic arithmetic operations.  In
    chapter&nbsp;3 we will return to message passing, and we will see that
    it can be a powerful tool for structuring simulation programs.
  </p></div>

  
    <div class="permalink">
    <a name="ex_2.79" class="permalink"></a><EXERCISE><b><a class="exercise-number permalink" id="ex_2.79">Exercise 2.79 </a></b> 
  
    
    Implement the constructor
    
      <span style="color:green"><kbd>make-from-mag-ang</kbd></span>
      <span style="color:blue"><kbd>make_from_mag_ang</kbd>
      </span>
    
    in message-passing style. This
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    should be analogous to the
    
      <span style="color:green"><kbd>make-from-real-imag</kbd></span>
      <span style="color:blue"><kbd>make_from_real_imag</kbd>
      </span>
    
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    given above.
    
  
      <div class="Solution">
      <div class="solution_btn"><button class="btn btn-secondary solution_btn" href="#solution_44_3_div" data-toggle="collapse">Solution</button></div>
      <div class="solution_content collapse" id="solution_44_3_div"><SOLUTION>
    
      <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_44_19_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_44_19_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=3&prgrm=PTAEGUEkGEAVQFLlAJgHQBY0GYBQuAzAVwDsBjAFwEsB7E0AZwEciBDAJwFMAKADwEpQAb1ygxoLhSLt6vUACpQvANy4AvvmLlqdUAFtWAa04B9Auxp6TXVgBsTVAwHM+AGlABPQSPGgtlWnoAEyoGAAdWCjIAC24aMO9RX3FJaXp40ABebNAAIht7CPYKXKTk5IB+JTLy8QAuUAzszLzHVicTIpKa2vEqjx7e0AamnNznEiopIM5Sodqqgwpok2Zi7mY2Lj5BAGpGFg4eL35B+ZGwrLHWEidbWbP50EXIlcib7g93AUfz0E52BZ2HEwq5fk9yrkAKokQwkGgAd3SlwAtCj9EZTOZLNZOHYHM5cvxVL4NL5UjJQCFwpEYqoyeJCKQAroDMYzBYrM4TDcXOx3KxEr5-DpgqEIlFYvEhbUKciri18njChxuhCquwFBjliYyDQGNxBeCxBcFa1uV05hDnhItUsVgwqCRDadrcNGpdmnkJlMiDMrW6NcbkqavblefcA26baxg+UGgCgSCwdGntDYfCkR7QGiMezsVYCgT2kSSeIGWI5VTxbTovSakztIFQKwwmFbB4TE5OCQAVQyMmW+wnDLK5wpJTonigobh-wQcT1I2WfQi11uAAvUdV1vtzvd3vsfvcJX4y3uWyhCib-iLjQi5ttDrrrfCMo7tsdrs9vsD3JPzpVVyC8rxvO9l1FDEnEmaYeFfHwxwnehdy-A9fxPH1YOA0BLwYa8t3Ah9dAjODt3HNIW0-fcfyPP8SOw3D8NvesiOQoIgl1Sx204XhNwARncDcUFHCRyMpNksU5XF8Sfbg4zHM9VX4vZRMU9YhP4FM3QAl8+JUnSlI0wjmUghgiAAI04vRuN4jcBNADS33JMT6AkjkcSLWT5NUlV1L0nMfMA9ThK060DL8wR0XC-DhOMptWSIew9Ws+5bPsxyEMQii3ILExuV5OTo0wv04P8xRipmTcQu8kjlNAfZaqMliTObEIADcrJs-jBOEpyUhcvNJJxfLbkKt0KtKwQwAmqrNJq257jq9FGti+sQA9AFIkCEwKFYcz7ncMIiAoFsSCCUBuwoXB1oLUAYlbCgAVAbBQA2TgV2enAcFOViWwYBgaAHYwvlEvV2CCBgRKrUITBIRLbG4LgwYh115iqUgZgIJ1OCCY0E0OBHgfcKdWBnEmZyRmhwch284yqcnEfeqmUbjBpWH+wHuCJ0BdqoBHKep5il1+tzdv2ngRL1Eg8JwwH8TF+4shw0DcnkBXOHkUsal+2waBoQwiDCLnOE7ezgZMXrMuSKWZbM8z1aV9mAaBk2THs3mEd1sh5b2+4hd6KgCFeu2Ha9DHOCx3sghE3oq3DyOcbLco1H+WwGE4Pr5htk6BfOlonc582UHcD2Ngs9X-aeQPXtzs14+x6PM+tOOzojhuk6GFPODTjOrYhKtS9zxcIQrZJR9H36nXT9ZzbN13i9ANq7CITgY-EbPGHL32M-zjmXdNkvWD57gvZ98XK-Kauy-t7e69bhPG772p04oHaj89uX7HV0LUzECIqGBIxY2B9QD-2BEXdwS9bAr1vD-X+yRS6ny-tvW8w9ahdx7k3XoG9a672dsAi2h9j4hxQWg+YV9cE5HrlHNeABIXoL837EK3uLME9D4G+DAdwLhEDF7L1XnAjh5RS4kPPkLdhYgMHpywU8Rhg8mbg0gfwshndHjj21i1XQ1IJQxG4HoNeWVxJmlyLrfWhsoxPCqKYg2YRvIND0MYqeAI1SpiqE44o3kTR5GoTjDa7Atq6FzOrXIHdR5Vm0bWesG94ibVFG-cWStRbb24IuDel0lYxP8XE9WJ5rHmNSXQGWR0TotEyQEkg8TFr-mls4rWv1Ii7RiG-FwFAPBhFMLtJw7gpaPRIBQSGTcqxcNae05p3S6C9P6XFD6IyOntG4EESIRB9GDIGjDLhiypD6ONPTacCylnbKeAmQEVN9lbPcLkcypMebtG7OdTZyyczolmc0rW95NH0B6T2fpZzllQzWQwQCADfmHLRjc4+DzQVDGOUmSFFyrnnU6XcqkBynl3Qmd8hgbyIKPmlrtWw9gka7VuIlDggEyCGHaBLJuv01yGW8KJJCoAGZbmUKACeHzQDRRvMIRlFFS6svZRo+KrlMTuULMqYsLheDuC8LyoZR9gQys8MSIVwpOUzXgo8Ks9pVhMHWJsI4jM1JMT2J48QhrtjcoIiojlIrTp3FIjIwxoqdTvGdNazSgUXwXzVeIEWYrcojT5AKAxfLKRcM1OVV4nEDSCncFG7UDonQultTUdaTpHrsAIKwMgGcKA0B5lOUSMsaBB2WBnBgHg8KcD0MKmZ8yBDOvDchCgjSVidJPES3kpL2DYQEKEmoxSu2SvPMrPCI7KA9tsBwIkCbR2qhUcO-8FogIgQnUqKdJKZ19q9dFJdx0MLtBgiVBiKtu3btnV6iaB7rzhgWrMddd6L1OF7XOh1fsO7LpylJTyhILkvrfYIsQbgVVZAAHw3JcD+jykrZLKpOLeo9+YpLBuwpu4lr6d3AUeIjUNEGoN6MDah9oPJRr8hbKgjuVZchBDoLMesuAp74sJe9TDvbyWUu7Ck1Qk88V2EKDQHdnGqUpKbhmvpAISB2D8B8hg9bIKaoZVWFlqq7UfUaspgaAq1MKebDBrkpGCoUcFPKgakbQ1svU5BOl6kDE6uPb6Sqr5o06j1HGh9YFB3qvtZ651DnoJOada55NzpNNpp8x9Az0l7DwdlfZ8ziqiM6jWNeS1PAm37HS58WB5qxC6vdZ8b4vqNDprAJmgEOa8080LRWktJ0y1FsrdWx6dbIuQU7U2oQLaWxttzR2+ZuQwhCdncVqzQ7D2nl8iUJ9J5hvYa9bZigSGV2kbHUAobI3d3uH3V+ybE0z0bvm1e9wN69t3vorNzbC2BQPpW9Fv9JYLnHb7e4XDCHBCZEg52h7cHnCgcQ+d5DQ1DMdF5Ohl7OHeh4cowRn7xHhpGfI6G31NG6O9hCUuJj-GCWdC2yJ7ji58C4A3noTsyUbKw2WeZJ6LQajReDdwbAaAAAM7gWdoAAOxE5wZwMytgSmgBqKTDiFPUp6PJ1xVKVO9A0-5J4snnVpdw1lwCInS3Gb8+W8oIAA')">function make_from_mag_ang(r, a) {
    function dispatch(op) {
        return op === "real_part"
            ? r * math_cos(a)
            : op === "imag_part"
              ? r * math_sin(a)
              : op === "magnitude"
                ? r
                : op === "angle"
                  ? a
                  : error(op,
                          "Unknown op -- make_from_real_imag");
    }
    return dispatch;
}
</pre></div></div></td></tr></table>

      
    </SOLUTION></div></div>
</EXERCISE></div>


  
    <div class="permalink">
    <a name="ex_2.80" class="permalink"></a><EXERCISE><b><a class="exercise-number permalink" id="ex_2.80">Exercise 2.80 </a></b> 
  
    
    As a large system with generic operations evolves, new types of data
    objects or new operations may be needed.  For each of the three
    strategies—generic operations with explicit dispatch, data-directed
    style, and message-passing-style—describe the changes that must be
    made to a system in order to add new types or new operations.  Which
    organization would be most appropriate for a system in which new types must
    often be added?  Which would be most appropriate for a system in which new
    operations must often be added?
    
    
  
      <div class="Solution">
      <div class="solution_btn"><button class="btn btn-secondary solution_btn" href="#solution_44_4_div" data-toggle="collapse">Solution</button></div>
      <div class="solution_content collapse" id="solution_44_4_div"><SOLUTION>
    
      <UL>
	<LI>
	  <EM>Generic operations with explicit dispatch</EM>: For every new
	  type, we need to touch every generic interface function, and add a
	  new case.
	</LI>
	<LI>
	  <EM>Data-directed style</EM>: Here the implementation of the generic
	  interface functions can be neatly packaged in  <QUOTE>install</QUOTE>
	  libraries for each new type. We can also have <QUOTE>install</QUOTE>
	  libraries for new operations.
	</LI>
	<LI>
	  <EM>Message-passing-style</EM>: Like in the data-directed style, we
	  need to write a library for each new type. In this case, the library
	  consists of a dispatch function with a case for every generic
	  interface function.
	</LI>
      </UL>
      Overall, it's probably best to use a data-directed style when we need to
      frequently add new operations, and message-passing, when we frequently
      add new types.
    </SOLUTION></div></div>
</EXERCISE></div>

<hr>

    <div class='footnote'><span style="color:blue">
      <a class='footnote-number' id='footnote-1' href='#footnote-link-1' style="color:blue">[1] </a>
    <FOOTNOTE>
    
	    The name <kbd>undefined</kbd>
	    is predeclared in any JavaScript implementation and should
	    not be used other than to refer to that primitive value.
	  
    </FOOTNOTE></span></div>
    
    
    <div class='footnote'>
      <a class='footnote-number' id='footnote-2' href='#footnote-link-2' >[2] </a>
    <FOOTNOTE>
    We use the list
    
      <span style="color:green"><kbd>(rectangular)</kbd></span>
      <span style="color:blue"><kbd>list("rectangular")</kbd>
      </span>
    
    rather than the
    
      <span style="color:green">symbol <kbd>rectangular</kbd></span>
      <span style="color:blue">string <kbd>"rectangular"</kbd>
      </span>
    
    to allow for the possibility of operations with multiple arguments, not
    all of the same type.
    </FOOTNOTE></div>
    
    
    <div class='footnote'>
      <a class='footnote-number' id='footnote-3' href='#footnote-link-3' >[3] </a>
    <FOOTNOTE>
    The type the
    constructors are installed under needn't be a list because a
    constructor is always used to make an object of one particular
    type.
    </FOOTNOTE></div>
    
    
    <div class='footnote'>
      <a class='footnote-number' id='footnote-4' href='#footnote-link-4' >[4] </a>
    <FOOTNOTE>
    
    <table width="100%">
        <colgroup><col width="48%"><col width="1%"><col width="51%"></colgroup>
        <tr>
          <td class="meta" style = "color:grey; text-align: center">Original</td>
          <td></td>
          <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
        </tr>
        <tr><td><span style="color:green">
	<kbd>Apply-generic</kbd>
	uses the
	
        dotted-tail notation described in
        exercise&nbsp;<REF NAME="ex:dotted-arglist"><a class="superscript" id="2.4.3-ex-link-2.20" href="./2.2.1.html#ex_2.20">2.20</a></REF>,
	because different generic operations may take
	different numbers of arguments.
      </span>    </td>
          <td></td>
          <td></td></tr></table>
    In
    
      <span style="color:green"><kbd>apply-generic</kbd>,</span>
      <span style="color:blue">
	<kbd>apply_generic</kbd>,
      </span>
    
    <kbd>op</kbd> has as its value the first argument to
    
      <span style="color:green"><kbd>apply-generic</kbd></span>
      <span style="color:blue">
	<kbd>apply_generic</kbd>
      </span>
    
    and
    <kbd>args</kbd> has as its value a list of the remaining
    arguments.
    <br>
    
      <span style="color:green">
      <kbd>Apply-generic</kbd></span>
      <span style="color:blue">The function
      <kbd>apply_generic</kbd>
      </span>
    
    also uses the primitive
    
      <span style="color:green">
	procedure
	<kbd>apply</kbd>,
      </span>
      <span style="color:blue">
	function
	<kbd>apply</kbd>
	given in our JavaScript environment,
      </span>
    
    
    
    which takes two arguments, a
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    and a list.
    
      <span style="color:green"><kbd>Apply</kbd></span>
      <span style="color:blue">The function <kbd>apply</kbd>
      </span>
    
    applies the
    
      <span style="color:green">procedure,</span>
      <span style="color:blue">function,</span>
    
    using the elements in the list as arguments. For example,
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_44_20_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(apply + (list 1 2 3 4))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_44_20_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
apply(sum_of_squares, list(1, 3))</pre></div></div></td></tr></table>
    returns 10.
    </FOOTNOTE></div>
    
    
    <div class='footnote'>
      <a class='footnote-number' id='footnote-5' href='#footnote-link-5' >[5] </a>
    <FOOTNOTE>
    One limitation of this organization is it permits only
    generic
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    of one argument.
    </FOOTNOTE></div>
    
    
</SUBSECTION></div></div>

    <div class='nav'>
  
        <a class='btn btn-secondary btn-nav' href='./2.4.2.html'>&lt; Previous</a>
    
    <div style='flex-grow: 1;'></div>
  
        <a class='btn btn-secondary btn-nav' id='46' href='./2.5.html'>Next &gt;</a>
      </div>
    <div class='chapter_sign'>
      2.4.3  Data-Directed Programming and Additivity
    </div>
    <script> var chapter_id = 45; </script>
    <script> var chapter_path = "chapters/2.4.3.html"; </script>
    <div class='next-page'></div>
    </div>
    </div> <!-- /.container -->
    </body></html>